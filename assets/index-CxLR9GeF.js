const __vite__fileDeps=["foo2/assets/vendor-DwKZzjDj.js","foo2/assets/react-DKUg3lbS.js","foo2/assets/polyfills-DwZ9ihUv.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
var pd=Object.defineProperty;var fd=(s,e,t)=>e in s?pd(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var m=(s,e,t)=>fd(s,typeof e!="symbol"?e+"":e,t);import{j as r,r as p,a as gd,R as _d,b as Te,c as yd}from"./react-DKUg3lbS.js";import{C as Ac,c as vd,s as xd,a as wd,A as bd,I as Sd,g as Ds,i as Mr,p as jd,b as _e,d as on,e as ne,h as B,j as Tc,k as ie,l as Zr,m as ds,n as we,o as Cd,q as Pd,r as Fa,t as Ed,u as Ma,v as kd,w as Nc,x as Id,y as Ad,B as Td,Q as Nd,z as Ld,D as T,E as M,F as $d,G as Rd,H as Od,J as Dd,K as dn,N as Lc,V as Ba,L as ae,M as ue,O as dt,P as Fd,R as ft,S as de,T as un,U as Md,W as We,X as ea,Y as ta,Z as Bd,_ as Mn,$ as $c,a0 as Ud,a1 as Hd,a2 as sa,a3 as Fs,a4 as It,a5 as Wd,a6 as Rc,a7 as ze,a8 as us,a9 as Vd,aa as Oc,ab as qd,ac as Dc,ad as zd,ae as Gd,af as Kd,ag as Jd,ah as Yd,ai as Qd,aj as Xd,ak as Zd,al as eu,am as tu,an as su,ao as Ua,ap as Fc,aq as nu}from"./vendor-DwKZzjDj.js";import{I as Ks}from"./inplayer-DkihfVdk.js";import"./index-CxLR9GeF.js";import"./polyfills-DwZ9ihUv.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();var bC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function SC(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}const ru="modulepreload",au=function(s){return"/"+s},Ha={},Mc=function(e,t,n){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),i=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.all(t.map(c=>{if(c=au(c),c in Ha)return;Ha[c]=!0;const l=c.endsWith(".css"),d=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=l?"stylesheet":ru,l||(h.as="script",h.crossOrigin=""),h.href=c,i&&h.setAttribute("nonce",i),document.head.appendChild(h),l)return new Promise((u,g)=>{h.addEventListener("load",u),h.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}return a.then(()=>e()).catch(o=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o})};function ou(s={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:n,onRegistered:a,onRegisteredSW:o,onRegisterError:i}=s;let c,l;const d=async(u=!0)=>{await l};async function h(){if("serviceWorker"in navigator){if(c=await Mc(async()=>{const{Workbox:u}=await import("./vendor-DwKZzjDj.js").then(g=>g.ar);return{Workbox:u}},__vite__mapDeps([0,1,2])).then(({Workbox:u})=>new u("/sw.js",{scope:"/",type:"classic"})).catch(u=>{i==null||i(u)}),!c)return;c.addEventListener("activated",u=>{(u.isUpdate||u.isExternal)&&window.location.reload()}),c.addEventListener("installed",u=>{u.isUpdate||n==null||n()}),c.register({immediate:e}).then(u=>{o?o("/sw.js",u):a==null||a(u)}).catch(u=>{i==null||i(u)})}}return l=h(),d}const W={APP_VERSION:"",APP_API_BASE_URL:"https://cdn.jwplayer.com",APP_API_ACCESS_BRIDGE_URL:"",APP_PLAYER_ID:"M4qoGvUk",APP_FOOTER_TEXT:"",APP_DEFAULT_LANGUAGE:"en",APP_PUBLIC_URL:""},iu=s=>{W.APP_VERSION=s.APP_VERSION||W.APP_VERSION,W.APP_API_BASE_URL=s.APP_API_BASE_URL||W.APP_API_BASE_URL,W.APP_API_ACCESS_BRIDGE_URL=s.APP_API_ACCESS_BRIDGE_URL||W.APP_API_ACCESS_BRIDGE_URL,W.APP_PLAYER_ID=s.APP_PLAYER_ID||W.APP_PLAYER_ID,W.APP_FOOTER_TEXT=s.APP_FOOTER_TEXT||W.APP_FOOTER_TEXT,W.APP_DEFAULT_LANGUAGE=s.APP_DEFAULT_LANGUAGE||W.APP_DEFAULT_LANGUAGE,W.APP_PUBLIC_URL=s.APP_PUBLIC_URL||W.APP_PUBLIC_URL,W.APP_DEFAULT_CONFIG_SOURCE||(W.APP_DEFAULT_CONFIG_SOURCE=s.APP_DEFAULT_CONFIG_SOURCE),W.APP_PLAYER_LICENSE_KEY||(W.APP_PLAYER_LICENSE_KEY=s.APP_PLAYER_LICENSE_KEY),W.APP_BODY_FONT=W.APP_BODY_FONT,W.APP_BODY_ALT_FONT=W.APP_BODY_ALT_FONT};var _t=(s=>(s.ContinueWatching="continue_watching",s.Favorites="favorites",s))(_t||{});const cu=["favorites","continue_watching"],Xt={JWP:"JWP",CLEENG:"CLEENG"},Fe={AVOD:"AVOD",AUTHVOD:"AUTHVOD",SVOD:"SVOD"},Jt={Min:.05,Max:.95},lu=25,Bc="test_I4OFGUUCEVB5TI222AS3N2Y2LY6PJM3K",Uc="live_BQDOFBYTGZB3XKF62GBYSLPUJ4YW2TPL",du=15*6e4,st={series:"series",episode:"episode",liveChannel:"livechannel",liveEvent:"liveevent",page:"page",hub:"hub"},uu={live:"live"},Wa={hero:"hero",featured:"featured"},Br="M4qoGvUk",sn="app-config",xn="config-file-override",ms=60*1e3*20,ps=60*1e3*20,hu=["1:1","2:1","2:3","4:3","5:3","16:9","9:13","9:16"],na=48,mu={canUpdateEmail:!1,canSupportEmptyFullName:!1,canChangePasswordWithOldPassword:!1,canRenewSubscription:!1,canExportAccountData:!1,canDeleteAccount:!1,canUpdatePaymentMethod:!1,canShowReceipts:!1,hasSocialURLs:!1,hasNotifications:!1,watchListSizeLimit:na},ra={jwp:"jwp",viewNexa:"viewnexa"},Ft={playlist:"playlist",continue_watching:"continue_watching",favorites:"favorites",content_list:"content_list",media:"media"},te=new Ac({defaultScope:"Singleton",skipBaseClassChecks:!0});function q(s,e=!0){const t=te.getAll(s)[0];if(e&&!t)throw new Error(`Service / Controller '${String(s)}' not found`);return t}function pu(s){return te.getAll(s)}function Et(s,e,t=!0){if(!e)return;let n;try{return n=te.getAllNamed(s,e)[0],n}catch(a){if(a instanceof Error&&a.message.includes("No matching bindings found")){if(t)throw new Error(`Service not found '${String(s)}' with name '${e}'`);return}console.error("Error caught while initializing service",a)}}function Be(s,e){if(!s)throw new Error(e)}function or(s,e){if(!s)throw new Error(`${e} feature is not enabled`)}const Ms=Symbol("INTEGRATION_TYPE"),aa=Symbol("DETERMINE_INTEGRATION_TYPE"),hn=Symbol("GET_CUSTOMER_IP"),Hc=Symbol("API_ACCESS_BRIDGE_URL"),Wc=Symbol("BROADCAST_CHANNEL");function fu(s,e=200){let t;function n(...a){t&&clearTimeout(t),t=setTimeout(()=>s(...a),e)}return n.cancel=()=>clearTimeout(t),n}function gu(s,e){let t,n;function a(...o){const i=n?Date.now()-n:e;i>=e?(s.apply(this,o),n=Date.now()):t||(t=setTimeout(()=>{n&&Date.now()-n>=e&&(s.apply(this,o),n=Date.now()),t=void 0},e-i))}return a.cancel=()=>clearTimeout(t),a}const _u=s=>s.replace(/\\u[\dA-F]{4}/gi,e=>String.fromCharCode(parseInt(e.replace(/\\u/g,""),16)));function yu(s){if(s.indexOf("#")===0&&(s=s.slice(1)),s.length===3&&(s=s[0]+s[0]+s[1]+s[1]+s[2]+s[2]),s.length===6)return{r:parseInt(s.slice(0,2),16),g:parseInt(s.slice(2,4),16),b:parseInt(s.slice(4,6),16)}}function ir(s){const e=yu(s);return e?e.r*.299+e.g*.587+e.b*.114>186?"#000000":"#FFFFFF":""}const vu=!1,oa=!1,Yt=(s,e)=>{var t;return((t=s.contentType)==null?void 0:t.toLowerCase())===e.toLowerCase()},fs=s=>{var e;return["true","1","yes","on"].includes((e=String(s))==null?void 0:e.toLowerCase())},xu=s=>{var e;return["false","0","no","off"].includes((e=String(s))==null?void 0:e.toLowerCase())};const wu=s=>!!s;var Mt=(s=>(s.LIVE="LIVE",s.VOD="VOD",s.SCHEDULED="SCHEDULED",s))(Mt||{});const Vc=s=>!!s&&Yt(s,st.liveEvent),qc=s=>s.mediaStatus==="SCHEDULED"||s.mediaStatus==="LIVE",bu=s=>{const e=s["VCH.EventState"],{scheduledStart:t,scheduledEnd:n}=s,a=new Date;if((e==="LIVE_PUBLISHED"||t&&t<a)&&n&&n>a)return"LIVE";if(!e)return"VOD";switch(e){case"PRE_LIVE":case"LIVE_UNPUBLISHED":return"SCHEDULED";case"LIVE_PUBLISHED":return"LIVE";case"INSTANT_VOD":case"VOD_PUBLIC":return"VOD"}},Su=s=>s.mediaStatus==="LIVE"||s.mediaStatus==="VOD",zc="/m/:id/*",ia="/p/:id/*",Gc="/n/:id/*",ju="/s/:id/*",Cu="/q/*",Pu="/o/about",Wn="/u",Eu=`${Wn}/*`,nn="my-account",Ur="favorites",Hr="payments",ku=`${Wn}/${nn}`,Iu=`${Wn}/${Ur}`,Au=`${Wn}/${Hr}`;var tt=(s=>(s[s.DEBUG=0]="DEBUG",s[s.INFO=1]="INFO",s[s.WARN=2]="WARN",s[s.ERROR=3]="ERROR",s[s.FATAL=4]="FATAL",s[s.SILENT=5]="SILENT",s))(tt||{});class ca{}const Tu=s=>s instanceof Error?s:new Error(String(s)),mn=s=>(e,t,{error:n,...a}={})=>{pu(ca).forEach(i=>{i.log(s,e,t,a,n?Tu(n):void 0)})},Ot=mn(tt.DEBUG),Kc=mn(tt.INFO),ls=mn(tt.WARN),Ue=mn(tt.ERROR);mn(tt.FATAL);const Jc=s=>s?s.seriesPlayListId||s.seriesPlaylistId||s.seriesId:void 0,Yc=s=>typeof Jc(s)<"u",Nu=s=>Yt(s,st.series),Qc=s=>Yc(s)||Nu(s),Xc=s=>typeof(s==null?void 0:s.episodeNumber)<"u"||Yt(s,st.episode),Lu=s=>{if(!s||!Xc(s))return;const t=(s.tags?s.tags.split(","):[]).find(function(n){return/seriesid_([\w\d]+)/i.test(n)});if(t)return t.split("_")[1]},Zc=s=>Yt(s,st.liveChannel),Ie=(s,e)=>{const[t,n=""]=s.split("?"),a=new URLSearchParams(n);Object.entries(e).forEach(([i,c])=>{if(c==null)return a.delete(i);const l=Array.isArray(c)?c.join(","):c;a.set(i,String(l))});const o=a.toString();return`${t}${o?`?${o}`:""}`},Vn=(s,e,t)=>{const n=s.split("/").map(a=>{if(a==="*")return e?Object.entries(e).filter(([l])=>!s.includes(l)).map(([l,d])=>d).join("/"):a;if(!a.startsWith(":")||!e)return a;const o=a.endsWith("?"),i=a.replace(":","").replace("?",""),c=e[i];return c||(o||ls("urlFormatting","Missing param in path creation",{path:s,paramName:i}),"")}).join("/");return t?Ie(n,t):n},qn=(s,e="-")=>s.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-").replace(/^-+/,"").replace(/-+$/,"").replace(/-/g,e),Ae=({id:s,title:e,playlistId:t,play:n=!1,episodeId:a})=>Vn(zc,{id:s,title:e?qn(e):void 0},{r:t,play:n?"1":null,e:a}),$u=(s,e)=>Vn(ia,{id:s,title:e?qn(e):void 0}),Ru=(s,e)=>Vn(Gc,{id:s,title:e?qn(e):void 0}),el=({type:s,contentId:e,label:t})=>{switch(s){case Ft.content_list:return Ru(e,t);case Ft.media:return Ae({id:e,title:t});case Ft.playlist:return $u(e,t);default:return""}},Ls=(s,e,t=!1)=>Vn(ia,{id:s},{channel:e,play:t?"1":null}),is=({seriesId:s,episodeId:e,play:t,playlistId:n})=>Ie(`/s/${s}`,{r:n,e,play:t?"1":null}),tl=(s,e,t)=>{const n=Lu(s),a=Jc(s);return is({seriesId:a||n||"",play:e,playlistId:t,episodeId:n&&s.mediaid})};class sl extends Error{constructor(t="",n){super(t);m(this,"code");m(this,"message");this.name="ApiError",this.message=t,this.code=n}}const os=async s=>{const e=await s.json();if(!s.ok){const t=`Request '${s.url}' failed with ${s.status}`,n=e&&typeof e=="object"&&"message"in e&&typeof e.message=="string"?e.message:void 0;throw new sl(n||t,s.status||500)}return e},zn=(s,e,t,n)=>{const a=xu(n==null?void 0:n.requiresSubscription)||fs(n==null?void 0:n.free),o=n==null?void 0:n.mediaOffers;return!(a||s===Fe.AVOD&&!o||s===Fe.AUTHVOD&&e&&!o||s===Fe.SVOD&&t&&!(o!=null&&o.some(i=>i.premier)))},Ou=(s,e)=>e?e.replace(/\s/g,"").split(",").reduce((t,n)=>n.indexOf(`${s}:`)===0||n.indexOf(`!${s}:`)===0?[...t,{offerId:n.slice(n.indexOf(":")+1),premier:n[0]==="!"}]:t,[]):null,gs=(s,e)=>{const t=xd(e);return vd(t)},G=gs("ConfigStore",()=>({loaded:!1,config:{id:"",siteName:"",description:"",player:"",siteId:"",assets:{},content:[],menu:[],integrations:{cleeng:{useSandbox:!0},jwp:{clientId:null,assetId:null,useSandbox:!0}},styling:{}},settings:{additionalAllowedConfigSources:[],playerId:Br},supportedLanguages:[],accessModel:Fe.AVOD,integrationType:null})),Ss=(s,e)=>{const t=wd({uri:s});return new bd({link:t,cache:new Sd({addTypename:!1})})},Du=Ds`
    query KeywordSearch($keyword: String!) {
  movies(filter: {title: {includesInsensitive: $keyword}}) {
    nodes {
      id
      originalTitle
      studio
      released
      cast
      productionCountries
      tags
      title
      description
      synopsis
      genres {
        nodes {
          movieGenre {
            id
            title
          }
        }
      }
      images {
        nodes {
          id
          type
          width
          height
          path
          altText
        }
      }
      licenses {
        nodes {
          countries
          startTime
          endTime
        }
      }
      videos {
        nodes {
          id
          type
          title
          dashManifest
          hlsManifest
          audioLanguages
          subtitleLanguages
          outputFormat
          lengthInSeconds
          captionLanguages
          isProtected
          cuePoints {
            nodes {
              id
              cuePointTypeKey
              timeInSeconds
              value
            }
          }
          videoStreams {
            nodes {
              label
              format
              frameRate
              languageCode
              bitrateInKbps
              displayAspectRatio
              pixelAspectRatio
              samplingRate
              fileTemplate
              bitrateInKbps
              id
              iv
              keyId
              type
              fileTemplate
              codecs
              height
              width
              displayAspectRatio
            }
          }
        }
      }
    }
  }
  episodes(filter: {title: {includesInsensitive: $keyword}}) {
    nodes {
      id
      index
      originalTitle
      studio
      released
      cast
      productionCountries
      tags
      title
      description
      synopsis
      genres {
        nodes {
          tvshowGenre {
            id
            title
          }
        }
      }
      images {
        nodes {
          id
          type
          width
          height
          path
          altText
        }
      }
      licenses {
        nodes {
          countries
          startTime
          endTime
        }
      }
      videos {
        nodes {
          id
          type
          title
          dashManifest
          hlsManifest
          audioLanguages
          subtitleLanguages
          outputFormat
          lengthInSeconds
          captionLanguages
          isProtected
          cuePoints {
            nodes {
              id
              cuePointTypeKey
              timeInSeconds
              value
            }
          }
          videoStreams {
            nodes {
              label
              format
              frameRate
              languageCode
              bitrateInKbps
              displayAspectRatio
              pixelAspectRatio
              samplingRate
              fileTemplate
              bitrateInKbps
              id
              iv
              keyId
              type
              fileTemplate
              codecs
              height
              width
              displayAspectRatio
            }
          }
        }
      }
    }
  }
  tvshows(filter: {title: {includesInsensitive: $keyword}}) {
    nodes {
      id
      originalTitle
      studio
      released
      cast
      productionCountries
      tags
      title
      description
      synopsis
      genres {
        nodes {
          tvshowGenre {
            id
            title
          }
        }
      }
      images {
        nodes {
          id
          type
          width
          height
          path
          altText
        }
      }
      licenses {
        nodes {
          countries
          startTime
          endTime
        }
      }
      videos {
        nodes {
          id
          type
          title
          dashManifest
          hlsManifest
          audioLanguages
          subtitleLanguages
          outputFormat
          lengthInSeconds
          captionLanguages
          isProtected
          cuePoints {
            nodes {
              id
              cuePointTypeKey
              timeInSeconds
              value
            }
          }
          videoStreams {
            nodes {
              label
              format
              frameRate
              languageCode
              bitrateInKbps
              displayAspectRatio
              pixelAspectRatio
              samplingRate
              fileTemplate
              bitrateInKbps
              id
              iv
              keyId
              type
              fileTemplate
              codecs
              height
              width
              displayAspectRatio
            }
          }
        }
      }
    }
  }
}
    `;Ds`
    query GetAllMovies {
  movies {
    nodes {
      id
      title
      genres {
        nodes {
          movieGenre {
            title
          }
        }
      }
    }
  }
}
    `;Ds`
    query GetAllTvShows {
  tvshows {
    nodes {
      id
      title
      genres {
        nodes {
          tvshowGenre {
            title
          }
        }
      }
    }
  }
}
    `;Ds`
    query GetAllChannels {
  channels {
    nodes {
      id
      title
      description
      dashStreamUrl
      hlsStreamUrl
      keyId
      playlists {
        nodes {
          id
          startDateTime
          endDateTime
          programs(orderBy: SORT_INDEX_ASC) {
            nodes {
              id
              sortIndex
              title
              movie {
                title
              }
              episode {
                title
              }
              id
            }
          }
        }
      }
    }
  }
}
    `;const wn=Ds`
    query GetItem($id: String!) {
  movie(id: $id) {
    id
    originalTitle
    studio
    released
    cast
    productionCountries
    tags
    title
    description
    synopsis
    genres {
      nodes {
        movieGenre {
          id
          title
        }
      }
    }
    images {
      nodes {
        id
        type
        width
        height
        path
        altText
      }
    }
    licenses {
      nodes {
        countries
        startTime
        endTime
      }
    }
    videos {
      nodes {
        id
        type
        title
        dashManifest
        hlsManifest
        audioLanguages
        subtitleLanguages
        outputFormat
        lengthInSeconds
        captionLanguages
        isProtected
        cuePoints {
          nodes {
            id
            cuePointTypeKey
            timeInSeconds
            value
          }
        }
        videoStreams {
          nodes {
            label
            format
            frameRate
            languageCode
            bitrateInKbps
            displayAspectRatio
            pixelAspectRatio
            samplingRate
            fileTemplate
            bitrateInKbps
            id
            iv
            keyId
            type
            fileTemplate
            codecs
            height
            width
            displayAspectRatio
          }
        }
      }
    }
  }
  tvshow(id: $id) {
    id
    originalTitle
    studio
    released
    cast
    productionCountries
    tags
    title
    description
    synopsis
    genres {
      nodes {
        tvshowGenre {
          id
          title
        }
      }
    }
    images {
      nodes {
        id
        type
        width
        height
        path
        altText
      }
    }
    licenses {
      nodes {
        countries
        startTime
        endTime
      }
    }
    videos {
      nodes {
        id
        type
        title
        dashManifest
        hlsManifest
        audioLanguages
        subtitleLanguages
        outputFormat
        lengthInSeconds
        captionLanguages
        isProtected
        cuePoints {
          nodes {
            id
            cuePointTypeKey
            timeInSeconds
            value
          }
        }
        videoStreams {
          nodes {
            label
            format
            frameRate
            languageCode
            bitrateInKbps
            displayAspectRatio
            pixelAspectRatio
            samplingRate
            fileTemplate
            bitrateInKbps
            id
            iv
            keyId
            type
            fileTemplate
            codecs
            height
            width
            displayAspectRatio
          }
        }
      }
    }
    seasons {
      nodes {
        id
        index
        synopsis
        episodes {
          nodes {
            id
            index
            originalTitle
            studio
            released
            cast
            productionCountries
            tags
            title
            description
            synopsis
            season {
              tvshowId
            }
            genres {
              nodes {
                tvshowGenre {
                  id
                  title
                }
              }
            }
            images {
              nodes {
                id
                type
                width
                height
                path
                altText
              }
            }
            licenses {
              nodes {
                countries
                startTime
                endTime
              }
            }
            videos {
              nodes {
                id
                type
                title
                dashManifest
                hlsManifest
                audioLanguages
                subtitleLanguages
                outputFormat
                lengthInSeconds
                captionLanguages
                isProtected
                cuePoints {
                  nodes {
                    id
                    cuePointTypeKey
                    timeInSeconds
                    value
                  }
                }
                videoStreams {
                  nodes {
                    label
                    format
                    frameRate
                    languageCode
                    bitrateInKbps
                    displayAspectRatio
                    pixelAspectRatio
                    samplingRate
                    fileTemplate
                    bitrateInKbps
                    id
                    iv
                    keyId
                    type
                    fileTemplate
                    codecs
                    height
                    width
                    displayAspectRatio
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  season(id: $id) {
    id
    index
    studio
    released
    cast
    productionCountries
    tags
    description
    synopsis
    genres {
      nodes {
        tvshowGenre {
          id
          title
        }
      }
    }
    images {
      nodes {
        id
        type
        width
        height
        path
        altText
      }
    }
    licenses {
      nodes {
        countries
        startTime
        endTime
      }
    }
    videos {
      nodes {
        id
        type
        title
        dashManifest
        hlsManifest
        audioLanguages
        subtitleLanguages
        outputFormat
        lengthInSeconds
        captionLanguages
        isProtected
        cuePoints {
          nodes {
            id
            cuePointTypeKey
            timeInSeconds
            value
          }
        }
        videoStreams {
          nodes {
            label
            format
            frameRate
            languageCode
            bitrateInKbps
            displayAspectRatio
            pixelAspectRatio
            samplingRate
            fileTemplate
            bitrateInKbps
            id
            iv
            keyId
            type
            fileTemplate
            codecs
            height
            width
            displayAspectRatio
          }
        }
      }
    }
  }
  episode(id: $id) {
    id
    index
    originalTitle
    studio
    released
    cast
    productionCountries
    tags
    title
    description
    synopsis
    season {
      tvshowId
    }
    genres {
      nodes {
        tvshowGenre {
          id
          title
        }
      }
    }
    images {
      nodes {
        id
        type
        width
        height
        path
        altText
      }
    }
    licenses {
      nodes {
        countries
        startTime
        endTime
      }
    }
    videos {
      nodes {
        id
        type
        title
        dashManifest
        hlsManifest
        audioLanguages
        subtitleLanguages
        outputFormat
        lengthInSeconds
        captionLanguages
        isProtected
        cuePoints {
          nodes {
            id
            cuePointTypeKey
            timeInSeconds
            value
          }
        }
        videoStreams {
          nodes {
            label
            format
            frameRate
            languageCode
            bitrateInKbps
            displayAspectRatio
            pixelAspectRatio
            samplingRate
            fileTemplate
            bitrateInKbps
            id
            iv
            keyId
            type
            fileTemplate
            codecs
            height
            width
            displayAspectRatio
          }
        }
      }
    }
  }
  channel(id: $id) {
    id
    title
    hlsStreamUrl
    description
    dashStreamUrl
    images {
      nodes {
        id
        path
        type
      }
    }
  }
}
    `,Fu=Ds`
    query GetCollection($id: String!) {
  collection(id: $id) {
    id
    title
    synopsis
    description
    items {
      nodes {
        id
        relationType
        episodeId
        episode {
          id
          index
          synopsis
          genres {
            nodes {
              tvshowGenre {
                title
              }
            }
          }
          cast
          released
          tags
          images {
            nodes {
              id
              type
              path
            }
          }
          videos {
            nodes {
              id
              dashManifest
              hlsManifest
              cuePoints {
                nodes {
                  id
                  cuePointTypeKey
                  timeInSeconds
                  value
                }
              }
            }
          }
        }
        seasonId
        season {
          id
          index
          studio
          released
          cast
          productionCountries
          tags
          description
          synopsis
          genres {
            nodes {
              tvshowGenre {
                id
                title
              }
            }
          }
          images {
            nodes {
              id
              type
              width
              height
              path
              altText
            }
          }
          licenses {
            nodes {
              countries
              startTime
              endTime
            }
          }
          videos {
            nodes {
              id
              type
              title
              dashManifest
              hlsManifest
              audioLanguages
              subtitleLanguages
              outputFormat
              lengthInSeconds
              captionLanguages
              isProtected
              cuePoints {
                nodes {
                  id
                  cuePointTypeKey
                  timeInSeconds
                  value
                }
              }
              videoStreams {
                nodes {
                  label
                  format
                  frameRate
                  languageCode
                  bitrateInKbps
                  displayAspectRatio
                  pixelAspectRatio
                  samplingRate
                  fileTemplate
                  bitrateInKbps
                  id
                  iv
                  keyId
                  type
                  fileTemplate
                  codecs
                  height
                  width
                  displayAspectRatio
                }
              }
            }
          }
        }
        tvshowId
        tvshow {
          id
          originalTitle
          studio
          released
          cast
          productionCountries
          tags
          title
          description
          synopsis
          genres {
            nodes {
              tvshowGenre {
                id
                title
              }
            }
          }
          images {
            nodes {
              id
              type
              width
              height
              path
              altText
            }
          }
          licenses {
            nodes {
              countries
              startTime
              endTime
            }
          }
          videos {
            nodes {
              id
              type
              title
              dashManifest
              hlsManifest
              audioLanguages
              subtitleLanguages
              outputFormat
              lengthInSeconds
              captionLanguages
              isProtected
              cuePoints {
                nodes {
                  id
                  cuePointTypeKey
                  timeInSeconds
                  value
                }
              }
              videoStreams {
                nodes {
                  label
                  format
                  frameRate
                  languageCode
                  bitrateInKbps
                  displayAspectRatio
                  pixelAspectRatio
                  samplingRate
                  fileTemplate
                  bitrateInKbps
                  id
                  iv
                  keyId
                  type
                  fileTemplate
                  codecs
                  height
                  width
                  displayAspectRatio
                }
              }
            }
          }
          seasons {
            nodes {
              id
              index
              synopsis
              episodes {
                nodes {
                  id
                  index
                  title
                  synopsis
                }
              }
            }
          }
        }
        movieId
        movie {
          id
          originalTitle
          studio
          released
          cast
          productionCountries
          tags
          title
          description
          synopsis
          genres {
            nodes {
              movieGenre {
                id
                title
              }
            }
          }
          images {
            nodes {
              id
              type
              width
              height
              path
              altText
            }
          }
          licenses {
            nodes {
              countries
              startTime
              endTime
            }
          }
          videos {
            nodes {
              id
              type
              title
              dashManifest
              hlsManifest
              audioLanguages
              subtitleLanguages
              outputFormat
              lengthInSeconds
              captionLanguages
              isProtected
              cuePoints {
                nodes {
                  id
                  cuePointTypeKey
                  timeInSeconds
                  value
                }
              }
              videoStreams {
                nodes {
                  label
                  format
                  frameRate
                  languageCode
                  bitrateInKbps
                  displayAspectRatio
                  pixelAspectRatio
                  samplingRate
                  fileTemplate
                  bitrateInKbps
                  id
                  iv
                  keyId
                  type
                  fileTemplate
                  codecs
                  height
                  width
                  displayAspectRatio
                }
              }
            }
          }
        }
      }
    }
  }
}
    `;var Va,qa;const za=20,js="https://mosaic-ott-catalog.axprod.net/graphql";let Le=(Va=_e(),Va(qa=class{constructor(){m(this,"generateAlternateImageURL",({mediaId:e,label:t,playlistLabel:n})=>{const a=`/v2/media/${e}/images/${n||t}.webp`;return Ie(`${W.APP_API_BASE_URL}${a}`,{poster_fallback:1,fallback:n?t:null})});m(this,"parseDate",(e,t)=>{const n=e[t];if(n&&!Mr(new Date(n))){Ue("ApiService",`Invalid "${t}" date provided for the "${e.title}" media item`,{error:new Error("Invalid date")});return}return n?jd(n):void 0});m(this,"getTranslatedFields",(e,t)=>{if(!t)return e;const n=W.APP_DEFAULT_LANGUAGE,a={...e};if(t!==n)for(const[o,i]of Object.entries(a))e[`${o}-${t}`]&&(a[o]=e[`${o}-${t}`]);return a});m(this,"transformContentList",(e,t)=>{const{list:n,...a}=e,o={...a,playlist:[]};return o.playlist=n.map(i=>{const{custom_params:c,media_id:l,description:d,tags:h,...u}=i,g={feedid:e.id,mediaid:l,tags:h.join(","),description:d||"",sources:[],images:[],image:"",link:"",pubdate:0,...u,...c};return this.transformMediaItem({item:g,playlist:o,language:t})}),o});m(this,"transformPlaylist",(e,t,n)=>(e.playlist=e.playlist.map(a=>this.transformMediaItem({item:a,playlist:e,language:n})),t&&(e.playlist=e.playlist.filter(a=>a.mediaid!==t)),e));m(this,"transformMediaItem",({item:e,playlist:t,language:n})=>{const a=G.getState().config,o=Object.keys(a==null?void 0:a.integrations)[0],i=t==null?void 0:t.imageLabel,c=e.mediaid,l=this.getTranslatedFields(e,n),d={...e,...l,cardImage:this.generateAlternateImageURL({mediaId:c,label:"card",playlistLabel:i}),channelLogoImage:this.generateAlternateImageURL({mediaId:c,label:"channel_logo",playlistLabel:i}),backgroundImage:this.generateAlternateImageURL({mediaId:c,label:"background"}),mediaOffers:e.productIds?Ou(o,e.productIds):void 0,scheduledStart:this.parseDate(e,"VCH.ScheduledStart"),scheduledEnd:this.parseDate(e,"VCH.ScheduledEnd")};return d.mediaStatus=bu(d),d});m(this,"transformEpisodes",(e,t,n)=>{const{episodes:a,page:o,page_limit:i,total:c}=e;return{episodes:a.filter(l=>l.media_item).map(l=>{var d;return{...this.transformMediaItem({item:l.media_item,language:t}),seasonNumber:(n==null?void 0:n.toString())||((d=l.season_number)==null?void 0:d.toString())||"",episodeNumber:String(l.episode_number)}}),pagination:{page:o,page_limit:i,total:c}}});m(this,"tranformSeasonToPlayListItem",e=>{var t,n;return{description:e==null?void 0:e.description,feedid:"foo",image:"foo",link:"",mediaid:e==null?void 0:e.id,pubdate:0,tags:"",title:e.index,contentType:"season",cardImage:"https://image.service.eu.axinom.net"+((t=e==null?void 0:e.images.nodes.find(a=>a.type=="COVER"))==null?void 0:t.path),backgroundImage:"https://image.service.eu.axinom.net"+((n=e==null?void 0:e.images.nodes.find(a=>a.type=="TEASER"))==null?void 0:n.path),images:e==null?void 0:e.images.nodes.filter(a=>a.path&&a.width).map(a=>({src:"https://image.service.eu.axinom.net"+a.path,type:a.type,width:a.width}))}});m(this,"tranformTvShowToPlayListItem",e=>{var t,n;return{description:e==null?void 0:e.description,feedid:"foo",image:"foo",link:"",mediaid:e==null?void 0:e.id,pubdate:0,tags:e!=null&&e.tags?e.tags.join(","):"",title:e.title,contentType:"series",cardImage:"https://image.service.eu.axinom.net"+((t=e==null?void 0:e.images.nodes.find(a=>a.type=="COVER"))==null?void 0:t.path),backgroundImage:"https://image.service.eu.axinom.net"+((n=e==null?void 0:e.images.nodes.find(a=>a.type=="TEASER"))==null?void 0:n.path),images:e==null?void 0:e.images.nodes.filter(a=>a.path&&a.width).map(a=>({src:"https://image.service.eu.axinom.net"+a.path,type:a.type,width:a.width}))}});m(this,"tranformEpisodeToPlayListItem",e=>{var t,n,a,o,i,c,l,d,h;return{description:e==null?void 0:e.description,duration:((t=e==null?void 0:e.videos)==null?void 0:t.nodes)!=null&&(e==null?void 0:e.videos.nodes.length)>0?e==null?void 0:e.videos.nodes[0].lengthInSeconds:0,feedid:"foo",image:"",link:"",mediaid:e==null?void 0:e.id,pubdate:0,tags:e!=null&&e.tags?e.tags.join(","):"",title:e.title,contentType:"episode",cardImage:"https://image.service.eu.axinom.net"+(((n=e==null?void 0:e.images)==null?void 0:n.nodes)!=null?(a=e==null?void 0:e.images.nodes.find(u=>u.type=="COVER"))==null?void 0:a.path:"/404.png"),backgroundImage:"https://image.service.eu.axinom.net"+(((o=e==null?void 0:e.images)==null?void 0:o.nodes)!=null?(i=e==null?void 0:e.images.nodes.find(u=>u.type=="TEASER"))==null?void 0:i.path:"/404.png"),images:((c=e==null?void 0:e.images)==null?void 0:c.nodes)!=null?(l=e==null?void 0:e.images)==null?void 0:l.nodes.filter(u=>u.path&&u.width).map(u=>({src:"https://image.service.eu.axinom.net"+u.path,type:u.type,width:u.width})):[],sources:((d=e==null?void 0:e.videos)==null?void 0:d.nodes)!=null?(h=e==null?void 0:e.videos)==null?void 0:h.nodes.filter(u=>u.hlsManifest).map(u=>({file:u.hlsManifest,type:"application/vnd.apple.mpegurl"})):[]}});m(this,"tranformMovieToPlayListItem",(e,t)=>{var n,a,o;return{description:e==null?void 0:e.description,duration:((n=e==null?void 0:e.videos)==null?void 0:n.nodes)!=null&&(e==null?void 0:e.videos.nodes.length)>0?e==null?void 0:e.videos.nodes[0].lengthInSeconds:0,feedid:"foo",image:"",link:"",mediaid:e==null?void 0:e.id,pubdate:0,tags:e!=null&&e.tags?e.tags.join(","):"",title:e==null?void 0:e.title,trailerId:"TRAILER_"+(e==null?void 0:e.id),contentType:"movie",cardImage:"https://image.service.eu.axinom.net"+((a=e==null?void 0:e.images.nodes.find(i=>i.type=="COVER"))==null?void 0:a.path),backgroundImage:"https://image.service.eu.axinom.net"+((o=e==null?void 0:e.images.nodes.find(i=>i.type=="TEASER"))==null?void 0:o.path),images:e==null?void 0:e.images.nodes.filter(i=>i.path&&i.width).map(i=>({src:"https://image.service.eu.axinom.net"+i.path,type:i.type,width:i.width})),sources:e==null?void 0:e.videos.nodes.filter(i=>i.hlsManifest&&(t?i.type=="TRAILER":i.type=="MAIN")).map(i=>({file:i.hlsManifest,type:"application/vnd.apple.mpegurl"}))}});m(this,"transformAxinomMediaItem",(e,t)=>e.movie?this.tranformMovieToPlayListItem(e.movie,t):e.episode?this.tranformEpisodeToPlayListItem(e.episode):e.tvshow?this.tranformTvShowToPlayListItem(e.tvshow):e.season?this.tranformSeasonToPlayListItem(e.season):{title:"not found"});m(this,"getMediaByWatchlist",async({playlistId:e,mediaIds:t,token:n,language:a})=>{if(!(t!=null&&t.length))return[];const o=`/apps/watchlists/${e}`,i=Ie(`${W.APP_API_BASE_URL}${o}`,{token:n,media_ids:t}),c=await fetch(i),l=await os(c);if(!l)throw new Error(`The data was not found using the watchlist ${e}`);return(l.playlist||[]).map(d=>this.transformMediaItem({item:d,language:a}))});m(this,"getMediaById",async({id:e,token:t,drmPolicyId:n,language:a})=>{var d;const i=await Ss(js).query({context:{headers:a?{"mosaic-locale":a}:void 0},query:wn,variables:{id:e.replace("TRAILER_","")},fetchPolicy:"no-cache"});if(i.errors)throw new Error("MediaItem not found");const c=(d=i.data)==null?void 0:d.movie;console.log("result axinom:"),console.log(c);const l=this.transformAxinomMediaItem(i.data,e.startsWith("TRAILER_"));return console.log("result axinom - transformed:"),console.log(l),l});m(this,"getMediaByIdWithPassport",async({id:e,siteId:t,planId:n,passport:a,language:o})=>{const i=`/v2/sites/${t}/media/${e}/playback.json`,c=Ie(`${W.APP_API_BASE_URL}${i}`,{passport:a,plan_id:n}),l=await fetch(c),h=(await os(l)).playlist[0];if(!h)throw new Error("MediaItem not found");return this.transformMediaItem({item:h,language:o})});m(this,"getSeries",async(e,t={})=>{var c,l,d,h,u;if(!e)throw new Error("Series ID is required");const a=await Ss(js).query({query:wn,variables:{id:e},fetchPolicy:"no-cache"});console.log("Got the Serie!"),console.log((c=a==null?void 0:a.data)==null?void 0:c.tvshow);let o=0;(d=(l=a==null?void 0:a.data)==null?void 0:l.tvshow)==null||d.seasons.nodes.forEach(g=>{g.episodes.nodes.forEach(_=>{o++})});const i={series_id:((h=a.data.tvshow)==null?void 0:h.id)??"",episode_count:o,season_count:((u=a.data.tvshow)==null?void 0:u.seasons.nodes.length)??0,total_duration:o*10,seasons:[]};try{const g=`/apps/series/${e}`,_=Ie(`${W.APP_API_BASE_URL}${g}`,t),f=await fetch(_)}catch{}return i});m(this,"getSeriesByMediaIds",async e=>{var c,l;const n=`${W.APP_API_BASE_URL}/apps/series?media_ids=${e.join(",")}`;console.log(n);const a=e[0];return{mediaId:[{series_id:((l=(c=(await Ss(js).query({query:wn,variables:{id:a},fetchPolicy:"no-cache"})).data.episode)==null?void 0:c.season)==null?void 0:l.tvshowId)??"404",episode_number:1,season_number:null}]}});m(this,"getEpisodes",async({seriesId:e,pageOffset:t,pageLimit:n=za,afterId:a,language:o})=>{var _;if(!e)throw new Error("Series ID is required");const i=`/apps/series/${e}/episodes`,c=Ie(`${W.APP_API_BASE_URL}${i}`,{page_offset:t,page_limit:n,after_id:a});console.log(c);const d=await Ss(js).query({context:{headers:o?{"mosaic-locale":o}:void 0},query:wn,variables:{id:e},fetchPolicy:"no-cache"});if(d.errors)throw new Error("MediaItem not found");const h=(_=d.data)==null?void 0:_.tvshow;console.log("serie result axinom:"),console.log(h);const u=[];h==null||h.seasons.nodes.forEach(f=>{f.episodes.nodes.forEach(x=>{u.length<n&&u.push({...this.tranformEpisodeToPlayListItem(x),seasonNumber:f.index,episodeNumber:x.index})})});const g={page:t+1,page_limit:n,total:u.length??1};return console.log(g),{episodes:u,pagination:g}});m(this,"getSeasonWithEpisodes",async({seriesId:e,seasonNumber:t,pageOffset:n,pageLimit:a=za,language:o})=>{if(!e)throw new Error("Series ID is required");console.log("foo");const i=`/apps/series/${e}/seasons/${t}/episodes`,c=Ie(`${W.APP_API_BASE_URL}${i}`,{page_offset:n,page_limit:a}),l=await fetch(c),d=await os(l);return this.transformEpisodes(d,o,t)});m(this,"getAdSchedule",async e=>{if(!e)throw new Error("Ad Schedule ID is required");const t=W.APP_API_BASE_URL+`/v2/advertising/schedules/${e}.json`,n=await fetch(t,{credentials:"omit"});return await os(n)});m(this,"doKeyWordSearch",async(e={},t=W.APP_DEFAULT_LANGUAGE)=>{var i,c,l;const a=await Ss(js).query({context:{headers:t?{"mosaic-locale":t}:void 0},query:Du,variables:{keyword:e.search??""},fetchPolicy:"no-cache"}),o={description:"Search result"};return o.playlist=[],(i=a.data.movies)==null||i.nodes.forEach(d=>{console.log(d),o.playlist.push(this.tranformMovieToPlayListItem(d))}),(c=a.data.episodes)==null||c.nodes.forEach(d=>{console.log(d),o.playlist.push(this.tranformMovieToPlayListItem(d))}),(l=a.data.tvshows)==null||l.nodes.forEach(d=>{console.log(d),o.playlist.push(this.tranformMovieToPlayListItem(d))}),o});m(this,"getPlaylistById",async(e,t={},n=W.APP_DEFAULT_LANGUAGE)=>{var l,d;if(console.log("getPlaylistById "+e),!e)return;if(e=="KEYWORD-SEARCH")return this.doKeyWordSearch(t,n);const o=await Ss(js).query({context:{headers:n?{"mosaic-locale":n}:void 0},query:Fu,variables:{id:e},fetchPolicy:"no-cache"});if(o.errors)throw new Error("MediaItem not found");const i=(l=o.data)==null?void 0:l.collection;console.log("result axinom:"),console.log(i);const c={description:(i==null?void 0:i.description)??"",title:"foo title",cardImageAspectRatio:"2:3",imageLabel:"foo imageLabel"};return c.playlist=[],(d=i==null?void 0:i.items)==null||d.nodes.forEach(h=>{switch(console.log(h),h.relationType){case"MOVIE":h.movie!=null&&c.playlist.push(this.tranformMovieToPlayListItem(h.movie));break;case"EPISODE":h.episode!=null&&c.playlist.push(this.tranformEpisodeToPlayListItem(h.episode));break;case"TVSHOW":h.tvshow!=null&&c.playlist.push(this.tranformTvShowToPlayListItem(h.tvshow));break}}),console.log("transformed result axinom:"),console.log(c),c});m(this,"getContentList",async({id:e,siteId:t,language:n})=>{if(console.log("getContentList "+e),!e||!t)throw new Error("List ID and Site ID are required");const a=`/v2/sites/${t}/content_lists/${e}`,o=Ie(`${W.APP_API_BASE_URL}${a}`,{}),i=await fetch(o),c=await os(i);return this.transformContentList(c,n)});m(this,"getContentSearch",async({siteId:e,params:t})=>{const n=`/v2/sites/${e}/app_content/media/search`,a=Ie(`${W.APP_API_BASE_URL}${n}`,{search_query:t.searchTerm}),o=await fetch(a),i=await os(o);return this.transformPlaylist(i)})}})||qa);class ge{}class yt{constructor(e){m(this,"features");this.features=e}}var Ga,Ka,Ja,Ya,Qa,Xa,at;const Mu=on(ne().shape({mediaid:B(),progress:Tc()}));let Wr=(Ga=_e(),Ka=function(s,e){return ie(Ms)(s,void 0,0)},Ja=function(s,e){return ie(Le)(s,void 0,1)},Ya=function(s,e){return ie(ge)(s,void 0,2)},Qa=Reflect.metadata("design:type",Function),Xa=Reflect.metadata("design:paramtypes",[String,typeof Le>"u"?Object:Le,typeof ge>"u"?Object:ge]),Ga(at=Ka(at=Ja(at=Ya(at=Qa(at=Xa(at=class{constructor(e,t,n){m(this,"PERSIST_KEY_WATCH_HISTORY","history");m(this,"apiService");m(this,"storageService");m(this,"accountService");m(this,"getWatchHistoryItems",async(e,t,n)=>{const a=await this.apiService.getMediaByWatchlist({playlistId:e,mediaIds:t,language:n});return Object.fromEntries((a||[]).map(i=>[i.mediaid,i]))});m(this,"getWatchHistorySeriesItems",async(e,t,n)=>{const a=await this.apiService.getSeriesByMediaIds(t),o=Object.keys(a||{}).map(d=>{var h,u;return(u=(h=a==null?void 0:a[d])==null?void 0:h[0])==null?void 0:u.series_id}).filter(Boolean),i=[...new Set(o)],c=await this.apiService.getMediaByWatchlist({playlistId:e,mediaIds:i,language:n});return Object.keys(a||{}).reduce((d,h)=>{var g,_;const u=(_=(g=a==null?void 0:a[h])==null?void 0:g[0])==null?void 0:_.series_id;return u&&(d[h]=c==null?void 0:c.find(f=>f.mediaid===u)),d},{})});m(this,"getWatchHistory",async(e,t,n)=>{const a=e?await this.getWatchHistoryFromAccount(e):await this.getWatchHistoryFromStorage(),o=a.map(({mediaid:i})=>i);if(!o.length)return[];try{const i=await this.getWatchHistoryItems(t,o,n),c=await this.getWatchHistorySeriesItems(t,o,n);return a.map(l=>{const d=c==null?void 0:c[l.mediaid],h=i[l.mediaid];if(h)return this.createWatchHistoryItem(d||h,l.mediaid,d==null?void 0:d.mediaid,l.progress)}).filter(l=>!!l)}catch(i){Ue("WatchHistoryService","Failed to get watch history items",{error:i})}return[]});m(this,"serializeWatchHistory",e=>e.map(({mediaid:t,progress:n})=>({mediaid:t,progress:n})));m(this,"persistWatchHistory",async(e,t)=>{var n;t?await((n=this.accountService)==null?void 0:n.updateWatchHistory({history:this.serializeWatchHistory(e),user:t})):await this.storageService.setItem(this.PERSIST_KEY_WATCH_HISTORY,JSON.stringify(this.serializeWatchHistory(e)))});m(this,"createWatchHistoryItem",(e,t,n,a)=>({mediaid:t,seriesId:n,title:e.title,tags:e.tags,duration:e.duration,progress:a,playlistItem:e}));m(this,"getMaxWatchHistoryCount",()=>{var e,t;return((t=(e=this.accountService)==null?void 0:e.features)==null?void 0:t.watchListSizeLimit)||na});m(this,"saveItem",async(e,t,n,a)=>{if(!n)return;const o=this.createWatchHistoryItem(t||e,e.mediaid,t==null?void 0:t.mediaid,n),i=a.filter(({mediaid:c,seriesId:l})=>c!==o.mediaid&&(!l||l!==o.seriesId));return i.unshift(o),i.splice(this.getMaxWatchHistoryCount()),i});this.apiService=t,this.storageService=n,this.accountService=Et(yt,e)}validateWatchHistory(e){return e&&Mu.validateSync(e)?e:[]}async getWatchHistoryFromAccount(e){const t=await this.accountService.getWatchHistory({user:e});return this.validateWatchHistory(t)}async getWatchHistoryFromStorage(){const e=await this.storageService.getItem(this.PERSIST_KEY_WATCH_HISTORY,!0);return this.validateWatchHistory(e)}})||at)||at)||at)||at)||at)||at);var Za,eo;let nl=(Za=_e(),Za(eo=class{constructor(){m(this,"getToken",async(e,t={},n)=>await(await fetch(e,{method:"POST",headers:{Authorization:n?`Bearer ${n}`:""},body:JSON.stringify(t)})).json());m(this,"getMediaToken",async(e,t,n,a,o)=>{const i=await this.getToken(`${e}/media/${t}/sign${o?`/drm/${o}`:""}`,a,n);if(!i.entitled)throw new Error("Unauthorized");return i.token})}})||eo);var to,so,no,ro,Bt;const cr="inplayer_token",Bu="inplayer_iot",Uu={json:"application/json",form:"application/x-www-form-urlencoded"};var Fr;let Re=(to=_e(),so=function(s,e){return ie(ge)(s,void 0,0)},no=Reflect.metadata("design:type",Function),ro=Reflect.metadata("design:paramtypes",[typeof ge>"u"?Object:ge]),to(Bt=so(Bt=no(Bt=ro(Bt=(Fr=class{constructor(e){m(this,"storageService");m(this,"useSandboxEnv",!0);m(this,"setup",e=>{this.useSandboxEnv=e});m(this,"getBaseUrl",()=>this.useSandboxEnv?"https://staging-sims.jwplayer.com":"https://sims.jwplayer.com");m(this,"setToken",(e,t="",n)=>this.storageService.setItem(cr,JSON.stringify({token:e,refreshToken:t,expires:n}),!1));m(this,"getToken",async()=>{const e=await this.storageService.getItem(cr,!0,!1);return e||{token:"",refreshToken:"",expires:0}});m(this,"removeToken",async()=>{await Promise.all([this.storageService.removeItem(cr),this.storageService.removeItem(Bu)])});m(this,"isAuthenticated",async()=>{const e=await this.getToken();return!!e.token&&e.expires>Date.now()/1e3});m(this,"performRequest",async(e="/",t="GET",n,{contentType:a="form",responseType:o="json",withAuthentication:i=!1,keepalive:c,includeFullResponse:l=!1}={},d)=>{var x;const h={"Content-Type":Uu[a]};if(i){const w=await this.getToken();w.token&&(h.Authorization=`Bearer ${w.token}`)}const u=new URLSearchParams;n&&Object.entries(n).forEach(([w,v])=>{(v||v===0)&&(typeof v=="object"?Object.entries(v).forEach(([b,y])=>{u.append(`${w}[${b}]`,y.toString())}):u.append(w,v.toString()))});const g=`${e.startsWith("http")?e:`${this.getBaseUrl()}${e}`}${d?`?${new URLSearchParams(d).toString()}`:""}`,_=await fetch(g,{headers:h,keepalive:c,method:t,body:n&&u.toString()}),f=await((x=_[o])==null?void 0:x.call(_));if(!_.ok)throw{response:{data:f}};return l?{..._,data:f}:f});m(this,"get",(e,t,n)=>this.performRequest(e,"GET",void 0,t,n));m(this,"patch",(e,t,n)=>this.performRequest(e,"PATCH",t,n));m(this,"put",(e,t,n)=>this.performRequest(e,"PUT",t,n));m(this,"post",(e,t,n)=>this.performRequest(e,"POST",t,n));m(this,"remove",(e,t,n)=>this.performRequest(e,"DELETE",n,t));this.storageService=e}},m(Fr,"isCommonError",e=>{var t,n,a,o;return typeof e=="object"&&e!==null&&"response"in e&&typeof((n=(t=e.response)==null?void 0:t.data)==null?void 0:n.code)=="number"&&typeof((o=(a=e.response)==null?void 0:a.data)==null?void 0:o.message)=="string"}),Fr))||Bt)||Bt)||Bt)||Bt);var ao,oo,io,co,Ut;let la=(ao=_e(),oo=function(s,e){return ie(Re)(s,void 0,0)},io=Reflect.metadata("design:type",Function),co=Reflect.metadata("design:paramtypes",[typeof Re>"u"?Object:Re]),ao(Ut=oo(Ut=io(Ut=co(Ut=class{constructor(e){m(this,"apiService");m(this,"getJWPMediaToken",async(e="",t)=>{try{return(await this.apiService.get("/v2/items/jw-media/token",{withAuthentication:!0},{app_config_id:e,media_id:t})).token}catch{throw new Error("Unauthorized")}});m(this,"getEntitledPlans",async({siteId:e})=>{try{return await this.apiService.get(`/v3/sites/${e}/entitlements`,{withAuthentication:await this.apiService.isAuthenticated()})}catch{throw new Error("Failed to fetch entitled plans")}});this.apiService=e}})||Ut)||Ut)||Ut)||Ut);var lo,uo,ho,mo,po,fo,ot;const Hu=on(ne().shape({mediaid:B()}));let Vr=(lo=_e(),uo=function(s,e){return ie(Ms)(s,void 0,0)},ho=function(s,e){return ie(Le)(s,void 0,1)},mo=function(s,e){return ie(ge)(s,void 0,2)},po=Reflect.metadata("design:type",Function),fo=Reflect.metadata("design:paramtypes",[String,typeof Le>"u"?Object:Le,typeof ge>"u"?Object:ge]),lo(ot=uo(ot=ho(ot=mo(ot=po(ot=fo(ot=class{constructor(e,t,n){m(this,"PERSIST_KEY_FAVORITES","favorites");m(this,"apiService");m(this,"storageService");m(this,"accountService");m(this,"getFavorites",async(e,t,n)=>{const o=(e?await this.getFavoritesFromAccount(e):await this.getFavoritesFromStorage()).map(({mediaid:i})=>i);if(!o)return[];try{return(await this.apiService.getMediaByWatchlist({playlistId:t,mediaIds:o,language:n})||[]).map(c=>this.createFavorite(c))}catch(i){Ue("FavoriteService","Failed to get favorites",{error:i})}return[]});m(this,"serializeFavorites",e=>e.map(({mediaid:t})=>({mediaid:t})));m(this,"persistFavorites",async(e,t)=>{var n;if(t)return(n=this.accountService)==null?void 0:n.updateFavorites({favorites:this.serializeFavorites(e),user:t});await this.storageService.setItem(this.PERSIST_KEY_FAVORITES,JSON.stringify(this.serializeFavorites(e)))});m(this,"getMaxFavoritesCount",()=>{var e,t;return((t=(e=this.accountService)==null?void 0:e.features)==null?void 0:t.watchListSizeLimit)||na});m(this,"createFavorite",e=>({mediaid:e.mediaid,title:e.title,tags:e.tags,duration:e.duration,playlistItem:e}));this.apiService=t,this.storageService=n,this.accountService=Et(yt,e,!1)}validateFavorites(e){return e&&Hu.validateSync(e)?e:[]}async getFavoritesFromAccount(e){var n;const t=await((n=this.accountService)==null?void 0:n.getFavorites({user:e}));return this.validateFavorites(t)}async getFavoritesFromStorage(){const e=await this.storageService.getItem(this.PERSIST_KEY_FAVORITES,!0);return this.validateFavorites(e)}})||ot)||ot)||ot)||ot)||ot)||ot);const Wu=ne({contentId:B().notRequired(),title:B().notRequired(),featured:Zr().notRequired(),backgroundColor:B().nullable().notRequired(),type:ds().oneOf(["playlist","continue_watching","favorites","content_list"]),custom:ne().notRequired()}).defined(),Vu=ne().shape({label:B().defined(),contentId:B().defined(),filterTags:B().notRequired(),type:ds().oneOf(["playlist","content_list","media"]).notRequired(),custom:ne().notRequired()}),qu=ne({recommendationsPlaylist:B().nullable(),searchPlaylist:B().nullable(),continueWatchingList:B().nullable(),favoritesList:B().nullable()}),zu=ne({id:B().nullable(),monthlyOffer:B().nullable(),yearlyOffer:B().nullable(),useSandbox:Zr().default(!0)}),Gu=ne({clientId:B().nullable(),assetId:Tc().nullable(),useSandbox:Zr().default(!0)}),Ku=ne({backgroundColor:B().nullable(),highlightColor:B().nullable(),headerBackground:B().nullable(),footerText:B().nullable()}),Ju=ne({id:B().notRequired(),siteName:B().notRequired(),description:B().defined(),analyticsToken:B().nullable(),adSchedule:B().nullable(),adDeliveryMethod:ds().oneOf(["csai","ssai"]).notRequired(),adConfig:B().nullable(),siteId:B().defined(),assets:ne({banner:B().notRequired().nullable()}).notRequired(),content:on().of(Wu),menu:on().of(Vu),styling:Ku.notRequired(),features:qu.notRequired(),integrations:ne({cleeng:zu.notRequired(),jwp:Gu.notRequired()}).notRequired(),adScheduleUrls:ne({json:B().notRequired().nullable(),xml:B().notRequired().nullable()}).notRequired(),custom:ne().notRequired(),contentSigningService:ne().shape({host:B().required(),drmPolicyId:B().notRequired()}),contentProtection:ne().shape({accessModel:B().oneOf(["free","freeauth","authvod","svod"]).notRequired(),drm:ne({defaultPolicyId:B()}).notRequired()}).notRequired()}).defined();class qr extends Error{constructor(t,n){super(t);m(this,"payload");this.name="AppError",this.payload=n}}const Yu=null,Qu="csai",Xu=null,Zu="xx",eh={banner:"https://axcontent.azureedge.net/assets/img/axinom_email_blasts/ax_logo.png"},th=[{contentId:"collection-8",featured:!0,filterTags:"",title:"",type:"playlist"},{contentId:"collection-9",featured:!1,filterTags:"",title:"Featured Films",type:"playlist"},{contentId:"collection-11",enableText:!1,featured:!1,filterTags:"",title:"Featured Series",type:"playlist"}],sh={accessModel:"free",drm:{defaultPolicyId:""}},nh={enableSharing:"true"},rh="Axinom Mosaic Web App demo",ah={continueWatchingList:"collection-continueWatchingList",enableCasting:!0,enableSharing:!0,favoritesList:"collection-favoritesList",recommendationsPlaylist:"collection-9",searchPlaylist:"KEYWORD-SEARCH"},oh={},ih=[{contentId:"collection-10",filterTags:"Action,Comedy,Fantasy,Drama",label:"All Movies",type:"playlist"},{contentId:"collection-11",custom:{},filterTags:"Beginner,Advanced",label:"All Series",type:"playlist"}],ch="ou7L8htR",lh="4D7KGvZg",dh="Axinom Mosaic Web App",uh={backgroundColor:null,dynamicBlur:!0,footerText:"© Axinom Mosaic | [portal.axinom.com](https://portal.axinom.com/)",headerBackground:null,highlightColor:"#cccccc",posterFading:!0,shelfTitles:!0},hh="2",mh={adConfig:Yu,adDeliveryMethod:Qu,adSchedule:Xu,analyticsToken:Zu,assets:eh,content:th,contentProtection:sh,custom:nh,description:rh,features:ah,integrations:oh,menu:ih,player:ch,siteId:lh,siteName:dh,styling:uh,version:hh};var go,_o;let $n=(go=_e(),go(_o=class{constructor(){m(this,"CONFIG_HOST",W.APP_API_BASE_URL);m(this,"DEFAULT_CONFIG",{id:"",siteName:"",description:"",siteId:"",assets:{banner:"/images/logo.png"},content:[],menu:[],integrations:{},styling:{footerText:""},features:{}});m(this,"enrichConfig",e=>{const{content:t,siteName:n}=e,a=t.map(o=>Object.assign({featured:!1},o));return{...e,siteName:n||we.t("common:default_site_name"),content:a}});m(this,"getDefaultConfig",()=>this.DEFAULT_CONFIG);m(this,"validateConfig",e=>Ju.validate(e,{strict:!0}));m(this,"formatSourceLocation",e=>{if(e)return e.match(/^[a-z,\d]{8}$/)?`${this.CONFIG_HOST}/apps/configs/${e}.json`:e});m(this,"loadConfig",async e=>(console.log("loadConfig "+e),this.enrichConfig(mh)))}})||_o);var yo,vo,xo,wo,Ht;let Rn=(yo=_e(),vo=function(s,e){return ie(ge)(s,void 0,0)},xo=Reflect.metadata("design:type",Function),wo=Reflect.metadata("design:paramtypes",[typeof ge>"u"?Object:ge]),yo(Ht=vo(Ht=xo(Ht=wo(Ht=class{constructor(e){m(this,"storageService");m(this,"isValidConfigSource",(e,t)=>t!=null&&t.UNSAFE_allowAnyConfigSource?!!e:(t==null?void 0:t.defaultConfigSource)===e||(t==null?void 0:t.additionalAllowedConfigSources)&&(t==null?void 0:t.additionalAllowedConfigSources.indexOf(e))>=0);m(this,"initialize",async()=>{var a;const e=await fetch("/.webapp.ini").then(o=>o.text()).then(o=>Cd.parse(o)).catch(o=>(Ot("SettingsService","Failed to fetch or parse the ini settings",{error:o}),{})),t=Pd(),n={title:t.t("error:settings_invalid"),description:t.t("error:check_your_settings"),helpLink:"https://github.com/jwplayer/ott-web-app/blob/develop/docs/initialization-file.md"};if(!e)throw new qr("Unable to load .webapp.ini",n);if(e.defaultConfigSource||(e.defaultConfigSource=W.APP_DEFAULT_CONFIG_SOURCE),e.playerId||(e.playerId=W.APP_PLAYER_ID||Br),e.playerLicenseKey||(e.playerLicenseKey=W.APP_PLAYER_LICENSE_KEY),e.apiAccessBridgeUrl||(e.apiAccessBridgeUrl=W.APP_API_ACCESS_BRIDGE_URL),e.playerId===Br&&!e.playerLicenseKey&&ls("SettingsService","Using Global OTT Player without setting player key. Some features, such as analytics, may not work correctly."),!e.defaultConfigSource&&(!e.additionalAllowedConfigSources||((a=e.additionalAllowedConfigSources)==null?void 0:a.length)===0)&&!e.UNSAFE_allowAnyConfigSource)throw new qr("No usable config sources",n);return e});this.storageService=e}async getConfigSource(e,t){var i;if(!e)return"";const a=new URLSearchParams(t.split("?")[1]).get(sn);if(!e.UNSAFE_allowAnyConfigSource&&(((i=e.additionalAllowedConfigSources)==null?void 0:i.length)||0)<=0)return e.defaultConfigSource;if(a!==null){if(!a)return await this.storageService.removeItem(xn),e.defaultConfigSource;if(this.isValidConfigSource(a,e))return await this.storageService.setItem(xn,a),a;ls("SettingsService",`Invalid app-config query param: ${a}`)}const o=await this.storageService.getItem(xn,!1);if(o&&typeof o=="string"){if(this.isValidConfigSource(o,e))return o;ls("SettingsService","Invalid stored config: "+o),await this.storageService.removeItem(xn)}return e.defaultConfigSource}})||Ht)||Ht)||Ht)||Ht);const U=gs("AccountStore",(s,e)=>({loading:!1,user:null,subscription:null,transactions:null,entitledPlan:null,activePayment:null,customerConsents:null,publisherConsents:null,publisherConsentsLoading:!1,pendingOffer:null,setLoading:t=>s({loading:t}),getAccountInfo:()=>{const t=e().user,n=e().customerConsents;if(!(t!=null&&t.id))throw new Error("user not logged in");return{customerId:t==null?void 0:t.id,customer:t,customerConsents:n}}})),gt=gs("WatchHistoryStore",(s,e)=>({watchHistory:[],playlistItemsLoaded:!1,continueWatchingPlaylistId:_t.ContinueWatching,getItem:t=>e().watchHistory.find(({mediaid:n,progress:a})=>n===t.mediaid&&a>Jt.Min&&a<Jt.Max),getPlaylist:()=>({feedid:e().continueWatchingPlaylistId||_t.ContinueWatching,title:"Continue watching",playlist:e().watchHistory.filter(({playlistItem:t,progress:n})=>!!t&&n>Jt.Min&&n<Jt.Max).map(({playlistItem:t})=>t)}),getDictionaryWithEpisodes:()=>e().watchHistory.reduce((t,n)=>{const a=n.mediaid;return t[a]=n.progress,t},{}),getDictionaryWithSeries:()=>e().watchHistory.reduce((t,n)=>{const a=n.seriesId||n.mediaid;return t[a]=n.progress,t},{})}));var bo,So,jo,Cs;let Rs=(bo=_e(),So=Reflect.metadata("design:type",Function),jo=Reflect.metadata("design:paramtypes",[typeof Wr>"u"?Object:Wr]),bo(Cs=So(Cs=jo(Cs=class{constructor(e){m(this,"watchHistoryService");m(this,"initialize",async e=>{await this.restoreWatchHistory(e)});m(this,"restoreWatchHistory",async e=>{var o;const{user:t}=U.getState(),n=(o=G.getState().config.features)==null?void 0:o.continueWatchingList;if(!n)return;const a=await this.watchHistoryService.getWatchHistory(t,n,e);gt.setState({watchHistory:a.filter(i=>!!(i!=null&&i.mediaid)),playlistItemsLoaded:!0,continueWatchingPlaylistId:n})});m(this,"persistWatchHistory",async()=>{const{watchHistory:e}=gt.getState(),{user:t}=U.getState();await this.watchHistoryService.persistWatchHistory(e,t)});m(this,"saveItem",async(e,t,n)=>{const{watchHistory:a}=gt.getState();if(!n)return;const o=await this.watchHistoryService.saveItem(e,t,n,a);o&&(gt.setState({watchHistory:o}),await this.persistWatchHistory())});this.watchHistoryService=e}})||Cs)||Cs)||Cs);class Bs{}class Us{}const be=gs("CheckoutStore",s=>({requestedMediaOffers:[],mediaOffers:[],subscriptionOffers:[],switchSubscriptionOffers:[],selectedOffer:null,defaultOfferId:null,order:null,paymentMethods:null,setRequestedMediaOffers:e=>s({requestedMediaOffers:e}),setOrder:e=>s({order:e}),setPaymentMethods:e=>s({paymentMethods:e})}));class Ze extends Error{constructor(t){super(Object.values(t).flat().join(";"));m(this,"errors");this.errors=t}}const ph=s=>{const e=s==null?void 0:s.period;return e==="month"?"upgrade":e==="year"?"downgrade":"upgrade"},zr=s=>{var e,t;return((t=(e=s==null?void 0:s.find(n=>n.methodName==="card"))==null?void 0:e.id)==null?void 0:t.toString())||""};var Co,Po,Eo,ko,Io,vt;let At=(Co=_e(),Po=function(s,e){return ie(Ms)(s,void 0,0)},Eo=function(s,e){return ie(hn)(s,void 0,1)},ko=Reflect.metadata("design:type",Function),Io=Reflect.metadata("design:paramtypes",[typeof IntegrationType>"u"?Object:IntegrationType,typeof GetCustomerIP>"u"?Object:GetCustomerIP]),Co(vt=Po(vt=Eo(vt=ko(vt=Io(vt=class{constructor(e,t){m(this,"accountService");m(this,"checkoutService");m(this,"subscriptionService");m(this,"getCustomerIP");m(this,"initialiseOffers",async()=>{const e=be.getState().requestedMediaOffers,t=e?await this.getOffers({offerIds:e.map(({offerId:n})=>n)}):[];if(be.setState({mediaOffers:t}),!be.getState().subscriptionOffers.length&&this.accountService.svodOfferIds){const n=await this.getOffers({offerIds:this.accountService.svodOfferIds});be.setState({subscriptionOffers:n})}if(!be.getState().switchSubscriptionOffers.length){const n=await this.getSubscriptionSwitches(),a=n?await this.getOffers({offerIds:n}):[];be.setState({switchSubscriptionOffers:a})}});m(this,"getSubscriptionOfferIds",()=>this.accountService.svodOfferIds);m(this,"chooseOffer",async e=>{be.setState({selectedOffer:e})});m(this,"initialiseOrder",async e=>{var l,d;const{getAccountInfo:t}=U.getState(),{customer:n}=t(),a=await this.getPaymentMethods(),o=parseInt(zr(a)),i={offer:e,customerId:n.id,country:(n==null?void 0:n.country)||"",paymentMethodId:o},c=await this.checkoutService.createOrder(i);if(((l=c==null?void 0:c.errors)==null?void 0:l.length)>0)throw be.getState().setOrder(null),new Error(c==null?void 0:c.errors[0]);be.getState().setOrder((d=c.responseData)==null?void 0:d.order)});m(this,"updateOrder",async(e,t,n)=>{var a;try{const o=await this.checkoutService.updateOrder({order:e,paymentMethodId:t,couponCode:n});o.responseData.order&&be.getState().setOrder((a=o.responseData)==null?void 0:a.order)}catch(o){if(o instanceof Error)if(o.message==="Order not found")be.getState().setOrder(null);else{if(o.message==="Invalid coupon code")throw new Ze({couponCode:[we.t("account:checkout.coupon_not_valid")]});if(o.message==="Invalid coupon code for this offer")throw new Ze({couponCode:[we.t("account:checkout.coupon_not_valid_for_offer")]})}throw new Ze({form:[we.t("error:unknown_error")]})}});m(this,"getPaymentMethods",async()=>{var n,a;const{paymentMethods:e}=be.getState();if(e)return e;const t=await this.checkoutService.getPaymentMethods();if(t.errors.length>0)throw new Error(t.errors[0]);return be.getState().setPaymentMethods((n=t.responseData)==null?void 0:n.paymentMethods),(a=t.responseData)==null?void 0:a.paymentMethods});m(this,"paymentWithoutDetails",async({captchaValue:e}={})=>{const{order:t}=be.getState();if(!t)throw new Error("No order created");const n=await this.checkoutService.paymentWithoutDetails({orderId:t.id,captchaValue:e});if(n.errors.length>0)throw new Error(n.errors[0]);if(n.responseData.rejectedReason)throw new Error(n.responseData.rejectedReason);return n.responseData});m(this,"directPostCardPayment",async({cardPaymentPayload:e,referrer:t,returnUrl:n})=>{const{order:a}=be.getState();if(!a)throw new Error("No order created");return await this.checkoutService.directPostCardPayment(e,a,t,n)});m(this,"createAdyenPaymentSession",async(e,t=!0)=>{const{order:n}=be.getState(),a=n==null?void 0:n.id;if(t&&!a)throw new Error("There is no order to pay for");Be(this.checkoutService.createAdyenPaymentSession,"createAdyenPaymentSession is not available in checkout service");const o=await this.checkoutService.createAdyenPaymentSession({orderId:a,returnUrl:e});if(o.errors.length>0)throw new Error(o.errors[0]);return o.responseData});m(this,"initialAdyenPayment",async(e,t,n)=>{const{order:a}=be.getState();if(!a)throw new Error("No order created");Be(this.checkoutService.initialAdyenPayment,"initialAdyenPayment is not available in checkout service");const o=await this.checkoutService.initialAdyenPayment({orderId:a.id,returnUrl:t,paymentMethod:e,customerIP:await this.getCustomerIP(),captchaValue:n});if(o.errors.length>0)throw new Error(o.errors[0]);return o.responseData});m(this,"finalizeAdyenPayment",async(e,t,n)=>{if(!t)throw new Error("No order created");Be(this.checkoutService.finalizeAdyenPayment,"finalizeAdyenPayment is not available in checkout service");const a=await this.checkoutService.finalizeAdyenPayment({orderId:t,details:e,paymentData:n});if(a.errors.length>0)throw new Error(a.errors[0]);return a.responseData});m(this,"paypalPayment",async({successUrl:e,waitingUrl:t,cancelUrl:n,errorUrl:a,couponCode:o="",captchaValue:i})=>{const{order:c}=be.getState();if(!c)throw new Error("No order created");const l=await this.checkoutService.paymentWithPayPal({order:c,successUrl:e,waitingUrl:t,cancelUrl:n,errorUrl:a,couponCode:o,captchaValue:i});if(l.errors.length>0)throw new Error(l.errors[0]);return{redirectUrl:l.responseData.redirectUrl}});m(this,"getSubscriptionSwitches",async()=>{const{getAccountInfo:e}=U.getState(),{customerId:t}=e(),{subscription:n}=U.getState();if(!n||!this.checkoutService.getSubscriptionSwitches)return null;Be(this.checkoutService.getOffer,"getOffer is not available in checkout service");const a=await this.checkoutService.getSubscriptionSwitches({customerId:t,offerId:n.offerId});return a.responseData.available.length?a.responseData.available.map(({toOfferId:o})=>o):null});m(this,"switchSubscription",async()=>{const e=be.getState().selectedOffer,t=U.getState().subscription,{getAccountInfo:n}=U.getState(),{customerId:a}=n();if(!e||!t)throw new Error("No offer selected");Be(this.checkoutService.switchSubscription,"switchSubscription is not available in checkout service");const o=ph(t),i={toOfferId:e.offerId,customerId:a,offerId:t.offerId,switchDirection:o};await this.checkoutService.switchSubscription(i)});m(this,"changeSubscription",async({accessFeeId:e,subscriptionId:t})=>{Be(this.subscriptionService.changeSubscription,"changeSubscription is not available in subscription service");const{responseData:n}=await this.subscriptionService.changeSubscription({accessFeeId:e,subscriptionId:t});return n});m(this,"updatePayPalPaymentMethod",async(e,t,n,a,o,i)=>{Be(this.checkoutService.updatePaymentMethodWithPayPal,"updatePaymentMethodWithPayPal is not available in checkout service"),Be(this.checkoutService.deletePaymentMethod,"deletePaymentMethod is not available in checkout service");const c=await this.checkoutService.updatePaymentMethodWithPayPal({paymentMethodId:o,successUrl:e,waitingUrl:t,cancelUrl:n,errorUrl:a});if(c.errors.length>0)throw new Error(c.errors[0]);return i&&await this.checkoutService.deletePaymentMethod({paymentDetailsId:i}),c.responseData});m(this,"addAdyenPaymentDetails",async(e,t,n)=>{Be(this.checkoutService.addAdyenPaymentDetails,"addAdyenPaymentDetails is not available in checkout service");const a=await this.checkoutService.addAdyenPaymentDetails({paymentMethodId:t,returnUrl:n,paymentMethod:e,customerIP:await this.getCustomerIP()});if(a.errors.length>0)throw new Error(a.errors[0]);return a.responseData});m(this,"finalizeAdyenPaymentDetails",async(e,t,n)=>{Be(this.checkoutService.finalizeAdyenPaymentDetails,"finalizeAdyenPaymentDetails is not available in checkout service");const a=await this.checkoutService.finalizeAdyenPaymentDetails({paymentMethodId:t,details:e,paymentData:n});if(a.errors.length>0)throw new Error(a.errors[0]);return a.responseData});m(this,"getOffers",e=>this.checkoutService.getOffers(e));m(this,"getEntitlements",e=>this.checkoutService.getEntitlements(e));this.getCustomerIP=t,this.accountService=Et(yt,e),this.checkoutService=Et(Bs,e),this.subscriptionService=Et(Us,e)}})||vt)||vt)||vt)||vt)||vt);const pt=gs("FavoritesState",(s,e)=>({favorites:[],warning:null,favoritesPlaylistId:_t.Favorites,setWarning:t=>s({warning:t}),clearWarning:()=>s({warning:null}),hasItem:t=>e().favorites.some(n=>n.mediaid===t.mediaid),getPlaylist:()=>({feedid:e().favoritesPlaylistId||_t.Favorites,title:"Favorites",playlist:e().favorites.map(({playlistItem:t})=>t)})}));var Ao,To,No,Ps;let hs=(Ao=_e(),To=Reflect.metadata("design:type",Function),No=Reflect.metadata("design:paramtypes",[typeof Vr>"u"?Object:Vr]),Ao(Ps=To(Ps=No(Ps=class{constructor(e){m(this,"favoritesService");m(this,"initialize",async e=>{await this.restoreFavorites(e)});m(this,"restoreFavorites",async e=>{var o;const{user:t}=U.getState(),n=(o=G.getState().config.features)==null?void 0:o.favoritesList;if(!n)return;const a=await this.favoritesService.getFavorites(t,n,e);pt.setState({favorites:a,favoritesPlaylistId:n})});m(this,"persistFavorites",async()=>{const{favorites:e}=pt.getState(),{user:t}=U.getState();await this.favoritesService.persistFavorites(e,t)});m(this,"saveItem",async e=>{const{favorites:t}=pt.getState();if(!t.some(({mediaid:n})=>n===e.mediaid)){const n=[this.favoritesService.createFavorite(e)].concat(t);pt.setState({favorites:n}),await this.persistFavorites()}});m(this,"removeItem",async e=>{const{favorites:t}=pt.getState(),n=t.filter(({mediaid:a})=>a!==e.mediaid);pt.setState({favorites:n}),await this.persistFavorites()});m(this,"toggleFavorite",async e=>{const{favorites:t,hasItem:n,setWarning:a}=pt.getState();if(!e)return;if(n(e)){await this.removeItem(e);return}if(t.length>this.favoritesService.getMaxFavoritesCount()){a(we.t("video:favorites_warning",{maxCount:this.favoritesService.getMaxFavoritesCount()}));return}await this.saveItem(e)});m(this,"clear",async()=>{pt.setState({favorites:[]}),await this.persistFavorites()});this.favoritesService=e}})||Ps)||Ps)||Ps);var Lo,$o,Ro,Oo,Wt;let On=(Lo=_e(),$o=function(s,e){return ie(Hc)(s,void 0,0)},Ro=Reflect.metadata("design:type",Function),Oo=Reflect.metadata("design:paramtypes",[String]),Lo(Wt=$o(Wt=Ro(Wt=Oo(Wt=class{constructor(e){m(this,"apiAccessBridgeUrl");m(this,"generateAccessTokens",async(e,t)=>{const n=`${this.apiAccessBridgeUrl}/v2/sites/${e}/access/generate`,a=await fetch(n,{method:"PUT",headers:{Authorization:t?`Bearer ${t}`:""}});return a.ok?await a.json():(Ue("AccessService","Failed to generateAccessTokens",{status:a.status,error:a.json()}),null)});m(this,"refreshAccessTokens",async(e,t)=>{const n=`${this.apiAccessBridgeUrl}/v2/sites/${e}/access/refresh`,a=await fetch(n,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:t})});return a.ok?await a.json():(Ue("AccessService","Failed to refreshAccessTokens",{status:a.status,error:a.json()}),null)});this.apiAccessBridgeUrl=e}})||Wt)||Wt)||Wt)||Wt);const Dn=gs("AccessStore",()=>({passport:null}));var Do,Fo,Mo,Bo,Uo,Ho,Wo,Ye;const lr="access_tokens";let cn=(Do=_e(),Fo=function(s,e){return ie(Ms)(s,void 0,0)},Mo=function(s,e){return ie(Le)(s,void 0,1)},Bo=function(s,e){return ie(ge)(s,void 0,2)},Uo=function(s,e){return ie(On)(s,void 0,3)},Ho=Reflect.metadata("design:type",Function),Wo=Reflect.metadata("design:paramtypes",[typeof IntegrationType>"u"?Object:IntegrationType,typeof Le>"u"?Object:Le,typeof ge>"u"?Object:ge,typeof On>"u"?Object:On]),Do(Ye=Fo(Ye=Mo(Ye=Bo(Ye=Uo(Ye=Ho(Ye=Wo(Ye=class{constructor(e,t,n,a){m(this,"apiService");m(this,"accessService");m(this,"accountService");m(this,"storageService");m(this,"siteId","");m(this,"initialize",async()=>{const{config:e,accessModel:t}=G.getState();this.siteId=e.siteId,t!=="AVOD"&&this.generateOrRefreshAccessTokens()});m(this,"getMediaById",async e=>{const{entitledPlan:t}=U.getState();if(!(!this.siteId||!t))try{const n=await this.generateOrRefreshAccessTokens();if(!(n!=null&&n.passport))throw new Error("Failed to get / generate access tokens and retrieve media.");return await this.apiService.getMediaByIdWithPassport({id:e,siteId:this.siteId,planId:t.id,passport:n.passport})}catch(n){if(n instanceof sl&&n.code===403){const a=await this.refreshAccessTokens();if(a!=null&&a.passport)return await this.apiService.getMediaByIdWithPassport({id:e,siteId:this.siteId,planId:t.id,passport:a.passport});throw new Error("Failed to refresh access tokens and retrieve media.")}throw n}});m(this,"generateOrRefreshAccessTokens",async()=>{const e=await this.getAccessTokens(),t=e&&Date.now()>e.expires;return e||await this.generateAccessTokens(),t?await this.refreshAccessTokens():e});m(this,"generateAccessTokens",async()=>{if(!this.siteId)return null;const e=await this.accountService.getAuthData(),t=await this.accessService.generateAccessTokens(this.siteId,e==null?void 0:e.jwt);return t?(await this.setAccessTokens(t),t):null});m(this,"refreshAccessTokens",async()=>{const e=await this.getAccessTokens();if(!e)return null;const t=await this.accessService.refreshAccessTokens(this.siteId,e.refresh_token);return t?(await this.setAccessTokens(t),t):null});m(this,"setAccessTokens",async e=>{Dn.setState({passport:e.passport});const t=new Date(Date.now()+3600*1e3).getTime();return await this.storageService.setItem(lr,JSON.stringify({...e,expires:t}),!0)});m(this,"getAccessTokens",async()=>{const e=await this.storageService.getItem(lr,!0,!0);return e&&Dn.setState({passport:e.passport}),e});m(this,"removeAccessTokens",async()=>(Dn.setState({passport:null}),await this.storageService.removeItem(lr)));this.apiService=t,this.accessService=a,this.storageService=n,this.accountService=Et(yt,e)}})||Ye)||Ye)||Ye)||Ye)||Ye)||Ye)||Ye);var Vo,qo,zo,Go,Vt;let ye=(Vo=_e(),qo=function(s,e){return ie(Ms)(s,void 0,0)},zo=Reflect.metadata("design:type",Function),Go=Reflect.metadata("design:paramtypes",[typeof IntegrationType>"u"?Object:IntegrationType,typeof cn>"u"?Object:cn,typeof hs>"u"?Object:hs,typeof Rs>"u"?Object:Rs]),Vo(Vt=qo(Vt=zo(Vt=Go(Vt=class{constructor(e,t,n,a){m(this,"checkoutService");m(this,"accountService");m(this,"subscriptionService");m(this,"entitlementService");m(this,"accessController");m(this,"favoritesController");m(this,"watchHistoryController");m(this,"features");m(this,"refreshEntitlements");m(this,"loadUserData",async()=>{try{await this.accountService.getAuthData()&&await this.getAccount()}catch(e){Ue("AccountController","Failed to get user",{error:e}),e instanceof Error&&e.message.includes("Invalid JWT token")&&await this.logout()}});m(this,"initialize",async(e,t)=>{this.refreshEntitlements=t,U.setState({loading:!0});const n=G.getState().config;await this.accountService.initialize(n,e,this.logout),G.setState({accessModel:this.accountService.accessModel}),await this.loadUserData(),await this.getEntitledPlans(),U.setState({loading:!1})});m(this,"updateUser",async e=>{U.setState({loading:!0});const{user:t}=U.getState(),{canUpdateEmail:n,canSupportEmptyFullName:a}=this.getFeatures();if(Object.prototype.hasOwnProperty.call(e,"email")&&!n)throw new Error("Email update not supported");if(!t)throw new Error("User not logged in");const o=this.validateInputLength(e);if(o.length)return{errors:o,responseData:{}};let i=e;a||(i={...e,email:t.email});const c=await this.accountService.updateCustomer({...i,id:t.id.toString()});if(!c)throw new Error("Unknown error");return U.setState({user:c}),{errors:[],responseData:c}});m(this,"getAccount",async()=>{const{config:e}=G.getState();try{const t=await this.accountService.getUser({config:e});t&&await this.afterLogin(t.user,t.customerConsents),U.setState({loading:!1})}catch{U.setState({user:null,subscription:null,transactions:null,activePayment:null,customerConsents:null,publisherConsents:null,loading:!1})}});m(this,"login",async(e,t,n)=>{var a;U.setState({loading:!0});try{const o=await this.accountService.login({email:e,password:t,referrer:n});if(o){await((a=this.accessController)==null?void 0:a.generateAccessTokens()),await this.afterLogin(o.user,o.customerConsents);return}}catch(o){if(o instanceof Error&&o.message.toLowerCase().includes("invalid param email"))throw new Ze({email:[we.t("account:login.wrong_email")]})}finally{U.setState({loading:!1})}throw new Ze({form:[we.t("account:login.wrong_combination")]})});m(this,"logout",async()=>{var e,t,n;await((e=this.accountService)==null?void 0:e.logout()),await((t=this.accessController)==null?void 0:t.removeAccessTokens()),await this.clearLoginState(),await((n=this.refreshEntitlements)==null?void 0:n.call(this))});m(this,"register",async(e,t,n,a,o)=>{try{const i=await this.accountService.register({email:e,password:t,consents:a,referrer:n,captchaValue:o});if(i){const{user:c,customerConsents:l}=i;await this.afterLogin(c,l,!0);return}}catch(i){if(i instanceof Error){const c=i.message.toLowerCase();if(c.includes("customer already exists")||c.includes("account already exists"))throw new Ze({form:[we.t("account:registration.user_exists")]});if(c.includes("please enter a valid e-mail address"))throw new Ze({email:[we.t("account:registration.field_is_not_valid_email")]});if(c.includes("invalid param password"))throw new Ze({password:[we.t("account:registration.invalid_password")]})}}throw new Ze({form:[we.t("account:registration.failed_to_create")]})});m(this,"updateConsents",async e=>{var a;const{getAccountInfo:t}=U.getState(),{customer:n}=t();U.setState({loading:!0});try{const o=await((a=this.accountService)==null?void 0:a.updateCustomerConsents({customer:n,consents:e}));return o?(U.setState({customerConsents:o}),{responseData:o,errors:[]}):{responseData:[],errors:[]}}finally{U.setState({loading:!1})}});m(this,"getCustomerConsents",async()=>{const{getAccountInfo:e}=U.getState(),{customer:t}=e(),n=await this.accountService.getCustomerConsents({customer:t});return n&&U.setState({customerConsents:n}),n});m(this,"getPublisherConsents",async()=>{const{config:e}=G.getState();U.setState({publisherConsentsLoading:!0});const t=await this.accountService.getPublisherConsents(e);U.setState({publisherConsents:t,publisherConsentsLoading:!1})});m(this,"getCaptureStatus",async()=>{const{getAccountInfo:e}=U.getState(),{customer:t}=e();return this.accountService.getCaptureStatus({customer:t})});m(this,"updateCaptureAnswers",async e=>{const{getAccountInfo:t}=U.getState(),{customer:n,customerConsents:a}=t(),o=await this.accountService.updateCaptureAnswers({customer:n,...e});return U.setState({user:o,customerConsents:a}),o});m(this,"resetPassword",async(e,t)=>{await this.accountService.resetPassword({customerEmail:e,resetUrl:t})});m(this,"changePasswordWithOldPassword",async(e,t,n)=>{await this.accountService.changePasswordWithOldPassword({oldPassword:e,newPassword:t,newPasswordConfirmation:n})});m(this,"changePasswordWithToken",async(e,t,n,a)=>{await this.accountService.changePasswordWithResetToken({customerEmail:e,newPassword:t,resetPasswordToken:n,newPasswordConfirmation:a})});m(this,"updateSubscription",async e=>{var i;const{getAccountInfo:t}=U.getState(),{customerId:n}=t(),{subscription:a}=U.getState();if(!a)throw new Error("user has no active subscription");const o=await((i=this.subscriptionService)==null?void 0:i.updateSubscription({customerId:n,offerId:a.offerId,status:e,unsubscribeUrl:a.unsubscribeUrl}));if(o.errors.length>0)throw new Error(o.errors[0]);return await this.reloadSubscriptions({retry:10}),o==null?void 0:o.responseData});m(this,"updateCardDetails",async({cardName:e,cardNumber:t,cvc:n,expMonth:a,expYear:o,currency:i})=>{const{getAccountInfo:c}=U.getState(),{customerId:l}=c();Be(this.subscriptionService.updateCardDetails,"updateCardDetails is not available in subscription service");const d=await this.subscriptionService.updateCardDetails({cardName:e,cardNumber:t,cvc:n,expMonth:a,expYear:o,currency:i}),h=await this.subscriptionService.getActivePayment({customerId:l})||null;return U.setState({loading:!1,activePayment:h}),d});m(this,"checkEntitlements",async e=>{if(!e)return!1;const{responseData:t}=await this.checkoutService.getEntitlements({offerId:e});return!!(t!=null&&t.accessGranted)});m(this,"getEntitledPlans",async()=>{var i;const{config:e,settings:t}=G.getState(),n=e.siteId;if(!!!(t!=null&&t.apiAccessBridgeUrl))return null;const o=await this.entitlementService.getEntitledPlans({siteId:n});if((i=o==null?void 0:o.plans)!=null&&i.length){const c=o.plans.find(l=>l.metadata.access_model==="svod")||o.plans[0];return U.setState({entitledPlan:c}),c}return null});m(this,"reloadSubscriptions",async({delay:e,retry:t}={delay:0,retry:0})=>{var h,u;U.setState({loading:!0});const{getAccountInfo:n}=U.getState(),{customerId:a}=n(),{accessModel:o}=G.getState();if(e&&e>0)return new Promise(g=>{setTimeout(()=>{this.reloadSubscriptions({retry:t}).finally(g)},e)});if(o!=="SVOD")return await((h=this.refreshEntitlements)==null?void 0:h.call(this)),U.setState({loading:!1});const[i,c,l]=await Promise.all([this.subscriptionService.getActiveSubscription({customerId:a}),this.subscriptionService.getAllTransactions({customerId:a}),this.subscriptionService.getActivePayment({customerId:a})]);let d=null;if(!i&&t&&t>0)return await this.reloadSubscriptions({delay:1500,retry:t-1});try{if(i!=null&&i.pendingSwitchId){Be(this.checkoutService.getOffer,"getOffer is not available in checkout service"),Be(this.checkoutService.getSubscriptionSwitch,"getSubscriptionSwitch is not available in checkout service");const g=await this.checkoutService.getSubscriptionSwitch({switchId:i.pendingSwitchId});d=(await this.checkoutService.getOffer({offerId:g.responseData.toOfferId})).responseData}}catch(g){Ue("AccountController","Failed to fetch the pending offer",{error:g})}await((u=this.refreshEntitlements)==null?void 0:u.call(this)),U.setState({subscription:i,loading:!1,pendingOffer:d,transactions:c,activePayment:l})});m(this,"exportAccountData",async()=>{var t;const{canExportAccountData:e}=this.getFeatures();return Be(this.accountService.exportAccountData,"exportAccountData is not available in account service"),or(e,"Export account"),(t=this.accountService)==null?void 0:t.exportAccountData(void 0)});m(this,"getSocialLoginUrls",e=>{const{hasSocialURLs:t}=this.getFeatures();return Be(this.accountService.getSocialUrls,"getSocialUrls is not available in account service"),or(t,"Social logins"),this.accountService.getSocialUrls({redirectUrl:e})});m(this,"deleteAccountData",async e=>{const{canDeleteAccount:t}=this.getFeatures();Be(this.accountService.deleteAccount,"deleteAccount is not available in account service"),or(t,"Delete account");try{await this.accountService.deleteAccount({password:e})}catch(n){throw(n instanceof Error?n.message.toLowerCase():"").includes("invalid credentials")?new Ze({form:[we.t("user:account.delete_account.invalid_credentials")]}):new Ze({form:[we.t("user:account.delete_account.error")]})}});m(this,"getReceipt",async e=>{Be(this.subscriptionService.fetchReceipt,"fetchReceipt is not available in subscription service");const{responseData:t}=await this.subscriptionService.fetchReceipt({transactionId:e});return t});m(this,"getAuthData",async()=>this.accountService.getAuthData());m(this,"subscribeToNotifications",async({uuid:e,onMessage:t})=>this.accountService.subscribeToNotifications({uuid:e,onMessage:t}));m(this,"validateInputLength",e=>{var n,a;const t=[];return Number((n=e==null?void 0:e.firstName)==null?void 0:n.length)>50&&t.push(we.t("account:validation.first_name")),Number((a=e==null?void 0:e.lastName)==null?void 0:a.length)>50&&t.push(we.t("account:validation.last_name")),t});m(this,"clearLoginState",async()=>{U.setState({user:null,subscription:null,transactions:null,activePayment:null,customerConsents:null,publisherConsents:null,loading:!1}),await this.favoritesController.restoreFavorites(),await this.watchHistoryController.restoreWatchHistory()});this.checkoutService=Et(Bs,e),this.accountService=Et(yt,e),this.subscriptionService=Et(Us,e),this.entitlementService=q(la),this.accessController=t,this.favoritesController=n,this.watchHistoryController=a,this.features=e?this.accountService.features:mu}getSandbox(){return this.accountService.sandbox}getFeatures(){return this.features}async afterLogin(e,t,n=!1){U.setState({user:e,customerConsents:t}),await Promise.allSettled([this.reloadSubscriptions(),this.getPublisherConsents(),n?this.favoritesController.persistFavorites():this.favoritesController.restoreFavorites(),n?this.watchHistoryController.persistWatchHistory():this.watchHistoryController.restoreWatchHistory()]),U.setState({loading:!1})}})||Vt)||Vt)||Vt)||Vt);var Ko,Jo,Yo,Qo,Xo,Zo,it;let Gn=(Ko=_e(),Jo=function(s,e){return ie($n)(s,void 0,0)},Yo=function(s,e){return ie(Rn)(s,void 0,1)},Qo=function(s,e){return ie(ge)(s,void 0,2)},Xo=Reflect.metadata("design:type",Function),Zo=Reflect.metadata("design:paramtypes",[typeof $n>"u"?Object:$n,typeof Rn>"u"?Object:Rn,typeof ge>"u"?Object:ge]),Ko(it=Jo(it=Yo(it=Qo(it=Xo(it=Zo(it=class{constructor(e,t,n){m(this,"configService");m(this,"settingsService");m(this,"storageService");m(this,"loadAndValidateConfig",async e=>{const t=this.configService.formatSourceLocation(e),n=this.configService.getDefaultConfig();t||G.setState({config:n});let a=await this.configService.loadConfig(t);return a.id=e,a.assets=a.assets||{},a.assets.banner||(a.assets.banner=n.assets.banner),G.setState(o=>Fa({},o,{config:{assets:{banner:a.assets.banner}}})),a=await this.configService.validateConfig(a),a=Fa({},n,a),a});m(this,"initializeApp",async(e,t,n)=>{var l,d;Ot("AppController","Initializing app",{url:e});const a=await this.settingsService.initialize(),o=await this.settingsService.getConfigSource(a,e),i=await this.loadAndValidateConfig(o),c=this.calculateIntegrationType(i);return G.setState({config:i,loaded:!0,integrationType:c}),this.storageService.initialize("jwapp"),G.setState({settings:a}),c&&await q(ye).initialize(e,n),a!=null&&a.apiAccessBridgeUrl&&await q(cn).initialize(),(l=i.features)!=null&&l.continueWatchingList&&i.content.some(h=>h.type===_t.ContinueWatching)&&await q(Rs).initialize(t),(d=i.features)!=null&&d.favoritesList&&i.content.some(h=>h.type===_t.Favorites)&&await q(hs).initialize(t),{config:i,settings:a,configSource:o}});m(this,"calculateIntegrationType",e=>{const n=te.getAll(aa).reduce((a,o)=>{const i=o(e);return i?[...a,i]:a},[]);if(n.length>1)throw new Error(`Failed to initialize app, more than 1 integrations are enabled: ${n.join(", ")}`);return n[0]||null});m(this,"getIntegrationType",()=>{const e=G.getState();if(!e.loaded)throw new Error("A call to `AppController#getIntegrationType()` was made before loading the config");return e.integrationType});m(this,"getApiAccessBridgeUrl",()=>{var t;const e=G.getState();if(!e.loaded)throw new Error("A call to `AppController#getApiAccessBridgeUrl()` was made before loading the config");return((t=e.settings)==null?void 0:t.apiAccessBridgeUrl)||void 0});this.configService=e,this.settingsService=t,this.storageService=n}})||it)||it)||it)||it)||it)||it);class pn{}var ei,ti;const fh=s=>s.status==="fulfilled"?!0:(Ue("EpgController","An error occurred resolving a promise: ",{error:s.reason}),!1);let rl=(ei=_e(),ei(ti=class{constructor(){m(this,"parseSchedule",async(e,t)=>{const n=!!t.scheduleDemo||!1,a=this.getEpgService(t);if(!Array.isArray(e))return[];const i=(await Promise.allSettled(e.map(c=>a==null?void 0:a.transformProgram(c).catch(l=>{Ot("EpgController","Failed to transform a program",{error:l,program:c})})))).filter(fh).map(c=>c.value).filter(c=>!!c);return n?this.generateDemoPrograms(i):i});m(this,"getSchedule",async e=>{const t=this.getEpgService(e),n=await(t==null?void 0:t.fetchSchedule(e)),a=await this.parseSchedule(n,e),o=e.catchupHours&&parseInt(e.catchupHours);return{id:e.mediaid,title:e.title,description:e.description,catchupHours:o||8,channelLogoImage:e.channelLogoImage,backgroundImage:e.backgroundImage,programs:a}});m(this,"getEpgService",e=>{var a;const t=((a=e==null?void 0:e.scheduleType)==null?void 0:a.toLocaleLowerCase())||ra.jwp,n=Et(pn,t,!1);return n||ls("EpgController",`No epg service was added for the ${t} schedule type`),n});m(this,"getSchedules",async e=>Promise.all(e.map(t=>this.getSchedule(t))))}generateDemoPrograms(e){var i;const t=new Date,n=new Date((i=e[0])==null?void 0:i.startTime),a=new Date(Date.UTC(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate())),o=Ed(t,a);return e.map((c,l)=>({...c,id:`${c.id}_${l}`,startTime:Ma(new Date(c.startTime),o).toJSON(),endTime:Ma(new Date(c.endTime),o).toJSON()}))}})||ti);var si,ni;const gh=ne().shape({"episode-num":ne().shape({"#text":B().required()}),title:ne().shape({"#text":B().required()}),desc:ne().shape({"#text":B()}),icon:ne().shape({src:B()}),start:B().required(),stop:B().required()}),ri=s=>kd(s,"yyyyMdHms xxxx",new Date).toISOString();let _h=(si=_e(),si(ni=class extends pn{constructor(){super(...arguments);m(this,"transformProgram",async t=>{var a,o,i;const n=await gh.validate(t);return{id:n["episode-num"]["#text"],title:n.title["#text"],startTime:ri(n.start),endTime:ri(n.stop),description:(a=n==null?void 0:n.desc)==null?void 0:a["#text"],cardImage:(o=n==null?void 0:n.icon)==null?void 0:o.src,backgroundImage:(i=n==null?void 0:n.icon)==null?void 0:i.src}});m(this,"fetchSchedule",async t=>{var i;const{XMLParser:n}=await Mc(async()=>{const{XMLParser:c}=await import("./vendor-DwKZzjDj.js").then(l=>l.f);return{XMLParser:c}},__vite__mapDeps([0,1,2])),a=t.scheduleUrl;if(!a){ls("ViewNexaEpgService","Tried requesting a schedule for an item with missing `scheduleUrl`",{item:t});return}const o={ignoreAttributes:!1,attributeNamePrefix:""};try{const c=await fetch(a).then(h=>h.text()),d=new n(o).parse(c);return((i=d==null?void 0:d.tv)==null?void 0:i.programme)||[]}catch(c){c instanceof Error&&Ue("ViewNexaEpgService",`Fetch failed for View Nexa EPG schedule: '${a}'`,{error:c})}})}})||ni);var ai,oi;const yh="API-KEY",vh=ne().shape({id:B().required(),title:B().required(),startTime:B().required().test(s=>s?Mr(new Date(s)):!1),endTime:B().required().test(s=>s?Mr(new Date(s)):!1),chapterPointCustomProperties:on().of(ne().shape({key:B().required(),value:B().test("required-but-empty","value is required",s=>typeof s=="string")}))});let xh=(ai=_e(),ai(oi=class extends pn{constructor(){super(...arguments);m(this,"transformProgram",async t=>{var o,i,c,l;const n=await vh.validate(t),a=((i=(o=n.chapterPointCustomProperties)==null?void 0:o.find(d=>d.key==="image"))==null?void 0:i.value)||void 0;return{id:n.id,title:n.title,startTime:n.startTime,endTime:n.endTime,cardImage:a,backgroundImage:a,description:((l=(c=n.chapterPointCustomProperties)==null?void 0:c.find(d=>d.key==="description"))==null?void 0:l.value)||void 0}});m(this,"fetchSchedule",async t=>{if(!t.scheduleUrl){ls("JWEpgService","Tried requesting a schedule for an item with missing `scheduleUrl`",{item:t});return}const n=new Headers;t.scheduleToken&&n.set(yh,t.scheduleToken);try{const a=await fetch(t.scheduleUrl,{headers:n});return await os(a)}catch(a){a instanceof Error&&Ue("JWEpgService",`Fetch failed for EPG schedule: '${t.scheduleUrl}'`,{error:a})}})}})||oi);const wh=s=>s.container.get(Gn).getApiAccessBridgeUrl();class bh{constructor(){m(this,"queue",[])}getLength(){return this.queue.length}async enqueue(){return new Promise((e,t)=>{this.queue.push({resolve:e,reject:t})})}async resolve(e){const t=this.queue.map(({resolve:n})=>n(e));this.queue=[],await Promise.allSettled(t)}async reject(e){const t=this.queue.map(({reject:n})=>n(e));this.queue=[],await Promise.allSettled(t)}}var ii,ci,li,di,ui,hi,mi,Qe;const dr="auth",Sh=ne().shape({accessToken:B().required(),refreshToken:B().required()}),jh=s=>Sh.isValidSync(s),pi=s=>{try{const e=Nc(s);if(typeof e.exp=="number")return e.exp*1e3}catch{}return-1};let kt=(ii=_e(),ci=function(s,e){return ie(ge)(s,void 0,0)},li=function(s,e){return ie(hn)(s,void 0,1)},di=function(s,e){return ie(Wc)(s,void 0,2)},ui=function(s,e){return Id()(s,void 0,2)},hi=Reflect.metadata("design:type",Function),mi=Reflect.metadata("design:paramtypes",[typeof ge>"u"?Object:ge,typeof GetCustomerIP>"u"?Object:GetCustomerIP,typeof BroadcastChannel>"u"?Object:BroadcastChannel]),ii(Qe=ci(Qe=li(Qe=di(Qe=ui(Qe=hi(Qe=mi(Qe=class{constructor(e,t,n){m(this,"storageService");m(this,"getCustomerIP");m(this,"channel");m(this,"queue",new bh);m(this,"isRefreshing",!1);m(this,"expiration",-1);m(this,"sandbox",!1);m(this,"tokens",null);m(this,"logoutCallback");m(this,"getNewTokens",async({refreshToken:e})=>{var t;try{const{responseData:n}=await this.post("/auths/refresh_token",JSON.stringify({refreshToken:e}));return{accessToken:n.jwt,refreshToken:n.refreshToken}}catch(n){throw n instanceof Error&&(Ot("CleengService","Failed to refresh accessToken",{error:n}),(n.message.includes("Refresh token is expired or does not exist")||n.message.includes("Missing or invalid parameter"))&&(this.logoutCallback||Ot("CleengService","logoutCallback is not set"),await((t=this.logoutCallback)==null?void 0:t.call(this)))),n}});m(this,"handleBroadcastMessage",async e=>{this.isRefreshing=e.action==="refreshing",e.tokens&&await this.setTokens(e.tokens),e.action==="resolved"?await this.queue.resolve():e.action==="rejected"&&await this.queue.reject()});m(this,"sendBroadcastMessage",(e,t)=>{if(!this.channel)return;const n={action:e,tokens:t};this.channel.postMessage(n)});m(this,"getBaseUrl",()=>this.sandbox?"https://mediastore-sandbox.cleeng.com":"https://mediastore.cleeng.com");m(this,"performRequest",async(e="/",t="GET",n,a={})=>{try{const o=a.authenticate?await this.getAccessTokenOrThrow():void 0;return await(await fetch(`${this.getBaseUrl()}${e}`,{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:o?`Bearer ${o}`:""},keepalive:a.keepalive,method:t,body:n})).json()}catch(o){return{errors:Array.of(o instanceof Error?o.message:String(o))}}});m(this,"initialize",async(e,t)=>{this.sandbox=e,this.logoutCallback=t,await this.restoreTokensFromStorage(),await this.maybeRefreshAccessToken()});m(this,"setTokens",async e=>{this.tokens=e,this.expiration=pi(e.accessToken),await this.persistInStorage(this.tokens)});m(this,"clearTokens",async()=>{this.tokens=null,await this.persistInStorage(null)});m(this,"restoreTokensFromStorage",async()=>{const e=await this.storageService.getItem(dr,!1);let t;if(typeof e!="string")return;try{if(t=JSON.parse(e),!jh(t))return}catch{return}const n=pi(t.accessToken);n>this.expiration&&(this.tokens=t,this.expiration=n)});m(this,"accessTokenIsExpired",()=>this.tokens?this.expiration>-1&&Date.now()-this.expiration>0:!1);m(this,"hasTokens",()=>!!this.tokens);m(this,"refreshTokens",async e=>{this.sendBroadcastMessage("refreshing"),this.isRefreshing=!0;try{const t=await this.getNewTokens(e);if(t){await this.setTokens(t),this.isRefreshing=!1,this.sendBroadcastMessage("resolved",t),await this.queue.resolve();return}}catch(t){Ot("CleengService","Failed to refresh tokens",{error:t})}await this.clearTokens(),this.isRefreshing=!1,this.sendBroadcastMessage("rejected"),await this.queue.reject()});m(this,"maybeRefreshAccessToken",async()=>{try{if(this.isRefreshing)return Ot("CleengService","Token is already refreshing, waiting in queue..."),await this.queue.enqueue();if(!this.accessTokenIsExpired()||!this.tokens)return;await this.refreshTokens(this.tokens)}catch(e){Ue("CleengService","Error caught while refreshing the access token",{error:e})}});m(this,"getAccessToken",async()=>{var e;return await this.maybeRefreshAccessToken(),await this.restoreTokensFromStorage(),(e=this.tokens)==null?void 0:e.accessToken});m(this,"getAccessTokenOrThrow",async()=>{const e=await this.getAccessToken();if(!e)throw new Error("Access token is missing");return e});m(this,"getLocales",async()=>{const e=await this.getCustomerIP();return this.get(`/locales${e?"?customerIP="+e:""}`)});m(this,"get",(e,t)=>this.performRequest(e,"GET",void 0,t));m(this,"patch",(e,t,n)=>this.performRequest(e,"PATCH",t,n));m(this,"put",(e,t,n)=>this.performRequest(e,"PUT",t,n));m(this,"post",(e,t,n)=>this.performRequest(e,"POST",t,n));m(this,"remove",(e,t)=>this.performRequest(e,"DELETE",void 0,t));var a;this.storageService=e,this.getCustomerIP=t,this.channel=n,(a=this.channel)==null||a.addEventListener("message",this.handleBroadcastMessage)}async persistInStorage(e){e?await this.storageService.setItem(dr,JSON.stringify(e)):await this.storageService.removeItem(dr)}})||Qe)||Qe)||Qe)||Qe)||Qe)||Qe)||Qe);const fi=s=>({id:s.id,email:s.email,country:s.country,firstName:s.firstName,lastName:s.lastName,fullName:`${s.firstName} ${s.lastName}`,metadata:s.externalData||{}}),Ch=s=>({type:"checkbox",name:s.name,label:s.label,defaultValue:"",required:s.required,placeholder:s.placeholder,options:{},enabledByDefault:!1,version:s.version});var gi,_i,yi,vi,xi,xt;let Ph=(gi=_e(),_i=function(s,e){return ie(kt)(s,void 0,0)},yi=function(s,e){return ie(hn)(s,void 0,1)},vi=Reflect.metadata("design:type",Function),xi=Reflect.metadata("design:paramtypes",[typeof kt>"u"?Object:kt,typeof GetCustomerIP>"u"?Object:GetCustomerIP]),gi(xt=_i(xt=yi(xt=vi(xt=xi(xt=class extends yt{constructor(t,n){super({canUpdateEmail:!0,canSupportEmptyFullName:!0,canChangePasswordWithOldPassword:!1,canRenewSubscription:!0,canExportAccountData:!1,canDeleteAccount:!1,canUpdatePaymentMethod:!0,canShowReceipts:!1,hasSocialURLs:!1,hasNotifications:!1,watchListSizeLimit:48});m(this,"cleengService");m(this,"getCustomerIP");m(this,"publisherId","");m(this,"externalData",{});m(this,"accessModel",Fe.AUTHVOD);m(this,"svodOfferIds",[]);m(this,"sandbox",!1);m(this,"handleErrors",t=>{if(t.length>0)throw new Error(t[0])});m(this,"getCustomerIdFromAuthData",t=>Nc(t.jwt).customerId);m(this,"getCustomer",async({customerId:t})=>{const{responseData:n,errors:a}=await this.cleengService.get(`/customers/${t}`,{authenticate:!0});return this.handleErrors(a),this.externalData=n.externalData||{},fi(n)});m(this,"getLocales",async()=>this.cleengService.getLocales());m(this,"initialize",async(t,n,a)=>{var i;const o=(i=t==null?void 0:t.integrations)==null?void 0:i.cleeng;if(!(o!=null&&o.id))throw new Error("Failed to initialize Cleeng integration. The publisherId is missing.");this.publisherId=o.id,this.accessModel=o.monthlyOffer||o.yearlyOffer?Fe.SVOD:Fe.AUTHVOD,this.svodOfferIds=[o==null?void 0:o.monthlyOffer,o==null?void 0:o.yearlyOffer].filter(Boolean).map(String),this.sandbox=!!o.useSandbox,await this.cleengService.initialize(this.sandbox,a)});m(this,"getAuthData",async()=>this.cleengService.tokens?{jwt:this.cleengService.tokens.accessToken,refreshToken:this.cleengService.tokens.refreshToken}:null);m(this,"getCustomerConsents",async t=>{var o;const{customer:n}=t,a=await this.cleengService.get(`/customers/${n==null?void 0:n.id}/consents`,{authenticate:!0});return this.handleErrors(a.errors),((o=a==null?void 0:a.responseData)==null?void 0:o.consents)||[]});m(this,"updateCustomerConsents",async t=>{const{customer:n}=t,a={id:n.id,consents:t.consents},o=await this.cleengService.put(`/customers/${n==null?void 0:n.id}/consents`,JSON.stringify(a),{authenticate:!0});return this.handleErrors(o.errors),await this.getCustomerConsents(t)});m(this,"login",async({email:t,password:n})=>{const a={email:t,password:n,publisherId:this.publisherId,customerIP:await this.getCustomerIP()},{responseData:o,errors:i}=await this.cleengService.post("/auths",JSON.stringify(a));this.handleErrors(i),await this.cleengService.setTokens({accessToken:o.jwt,refreshToken:o.refreshToken});const{user:c,customerConsents:l}=await this.getUser();return{user:c,auth:o,customerConsents:l}});m(this,"register",async({email:t,password:n,consents:a,captchaValue:o})=>{const i=await this.getLocales();this.handleErrors(i.errors);const c={email:t,password:n,locale:i.responseData.locale,country:i.responseData.country,currency:i.responseData.currency,publisherId:this.publisherId,customerIP:await this.getCustomerIP(),captchaValue:o},{responseData:l,errors:d}=await this.cleengService.post("/customers",JSON.stringify(c));this.handleErrors(d),await this.cleengService.setTokens({accessToken:l.jwt,refreshToken:l.refreshToken});const{user:h}=await this.getUser(),u=await this.updateCustomerConsents({consents:a,customer:h}).catch(()=>[]);return{user:h,auth:l,customerConsents:u}});m(this,"logout",async()=>{await this.cleengService.clearTokens()});m(this,"getUser",async()=>{const t=await this.getAuthData();if(!t)throw new Error("Not logged in");const n=this.getCustomerIdFromAuthData(t),a=await this.getCustomer({customerId:n}),o=await this.getCustomerConsents({customer:a});return{user:a,customerConsents:o}});m(this,"getPublisherConsents",async()=>{var n;const t=await this.cleengService.get(`/publishers/${this.publisherId}/consents`);return this.handleErrors(t.errors),(((n=t.responseData)==null?void 0:n.consents)||[]).map(Ch)});m(this,"getCaptureStatus",async({customer:t})=>{const n=await this.cleengService.get(`/customers/${t==null?void 0:t.id}/capture/status`,{authenticate:!0});return this.handleErrors(n.errors),n.responseData});m(this,"updateCaptureAnswers",async({customer:t,...n})=>{const a={customerId:t.id,...n},o=await this.cleengService.put(`/customers/${t.id}/capture`,JSON.stringify(a),{authenticate:!0});return this.handleErrors(o.errors),this.getCustomer({customerId:t.id})});m(this,"resetPassword",async t=>{const n=await this.cleengService.put("/customers/passwords",JSON.stringify({...t,publisherId:this.publisherId}));this.handleErrors(n.errors)});m(this,"changePasswordWithResetToken",async t=>{const n=await this.cleengService.patch("/customers/passwords",JSON.stringify({...t,publisherId:this.publisherId}));this.handleErrors(n.errors)});m(this,"changePasswordWithOldPassword",async()=>{});m(this,"updateCustomer",async t=>{const{id:n,metadata:a,fullName:o,...i}=t,c={id:n,...i},{responseData:l,errors:d}=await this.cleengService.patch(`/customers/${n}`,JSON.stringify(c),{authenticate:!0,keepalive:!0});return this.handleErrors(d),this.externalData=l.externalData||{},fi(l)});m(this,"updateWatchHistory",async({user:t,history:n})=>{const a={id:t.id,externalData:{...this.externalData,history:n}},{errors:o,responseData:i}=await this.cleengService.patch(`/customers/${t.id}`,JSON.stringify(a),{authenticate:!0,keepalive:!0});this.handleErrors(o),this.externalData=i.externalData||{}});m(this,"updateFavorites",async({user:t,favorites:n})=>{const a={id:t.id,externalData:{...this.externalData,favorites:n}},{errors:o,responseData:i}=await this.cleengService.patch(`/customers/${t.id}`,JSON.stringify(a),{authenticate:!0,keepalive:!0});this.handleErrors(o),this.externalData=i.externalData||{}});m(this,"getWatchHistory",async()=>this.externalData.history||[]);m(this,"getFavorites",async()=>this.externalData.favorites||[]);m(this,"subscribeToNotifications",async()=>!1);m(this,"getSocialUrls");m(this,"exportAccountData");m(this,"deleteAccount");this.cleengService=t,this.getCustomerIP=n}})||xt)||xt)||xt)||xt)||xt);var wi,bi,Si,ji,Ci,wt;let Eh=(wi=_e(),bi=function(s,e){return ie(kt)(s,void 0,0)},Si=function(s,e){return ie(hn)(s,void 0,1)},ji=Reflect.metadata("design:type",Function),Ci=Reflect.metadata("design:paramtypes",[typeof kt>"u"?Object:kt,typeof GetCustomerIP>"u"?Object:GetCustomerIP]),wi(wt=bi(wt=Si(wt=ji(wt=Ci(wt=class extends Bs{constructor(t,n){super();m(this,"cleengService");m(this,"getCustomerIP");m(this,"getOffers",async t=>await Promise.all(t.offerIds.map(async n=>{const a=await this.getOffer({offerId:String(n)});if(a.errors.length>0)throw new Error(a.errors[0]);return a.responseData})));m(this,"getOffer",async t=>{const n=await this.getCustomerIP();return this.cleengService.get(`/offers/${t.offerId}${n?"?customerIP="+n:""}`)});m(this,"createOrder",async t=>{var i;const n=await this.cleengService.getLocales();if(n.errors.length>0)throw new Error(n.errors[0]);const a=n.responseData.ipAddress,o={offerId:t.offer.offerId,customerId:t.customerId,country:t.country,currency:((i=n==null?void 0:n.responseData)==null?void 0:i.currency)||"EUR",customerIP:a,paymentMethodId:t.paymentMethodId};return this.cleengService.post("/orders",JSON.stringify(o),{authenticate:!0})});m(this,"getOrder",async({orderId:t})=>this.cleengService.get(`/orders/${t}`,{authenticate:!0}));m(this,"updateOrder",async({order:t,...n})=>{const a=await this.cleengService.patch(`/orders/${t.id}`,JSON.stringify(n),{authenticate:!0});if(a.errors.length){if(a.errors[0].includes(`Order with ${t.id} not found`))throw new Error("Order not found");if(a.errors[0].includes(`Coupon ${n.couponCode} not found`))throw new Error("Invalid coupon code");if(a.errors[0].includes(`Coupon ${n.couponCode} cannot be applied on this offer`))throw new Error("Invalid coupon code for this offer")}return a});m(this,"getPaymentMethods",async()=>this.cleengService.get("/payment-methods",{authenticate:!0}));m(this,"paymentWithoutDetails",async t=>this.cleengService.post("/payments",JSON.stringify(t),{authenticate:!0}));m(this,"paymentWithPayPal",async t=>{const{order:n,successUrl:a,cancelUrl:o,errorUrl:i,captchaValue:c}=t,l={orderId:n.id,successUrl:a,cancelUrl:o,errorUrl:i,captchaValue:c};return this.cleengService.post("/connectors/paypal/v1/tokens",JSON.stringify(l),{authenticate:!0})});m(this,"getSubscriptionSwitches",async t=>this.cleengService.get(`/customers/${t.customerId}/subscription_switches/${t.offerId}/availability`,{authenticate:!0}));m(this,"getSubscriptionSwitch",async t=>this.cleengService.get(`/subscription_switches/${t.switchId}`,{authenticate:!0}));m(this,"switchSubscription",async t=>this.cleengService.post(`/customers/${t.customerId}/subscription_switches/${t.offerId}`,JSON.stringify({toOfferId:t.toOfferId,switchDirection:t.switchDirection}),{authenticate:!0}));m(this,"getEntitlements",async t=>this.cleengService.get(`/entitlements/${t.offerId}`,{authenticate:!0}));m(this,"createAdyenPaymentSession",async t=>await this.cleengService.post("/connectors/adyen/sessions",JSON.stringify(t),{authenticate:!0}));m(this,"initialAdyenPayment",async t=>this.cleengService.post("/connectors/adyen/initial-payment",JSON.stringify({...t,attemptAuthentication:this.cleengService.sandbox?"always":void 0}),{authenticate:!0}));m(this,"finalizeAdyenPayment",async t=>this.cleengService.post("/connectors/adyen/initial-payment/finalize",JSON.stringify(t),{authenticate:!0}));m(this,"updatePaymentMethodWithPayPal",async t=>this.cleengService.post("/connectors/paypal/v1/payment_details/tokens",JSON.stringify(t),{authenticate:!0}));m(this,"deletePaymentMethod",async t=>this.cleengService.remove(`/payment_details/${t.paymentDetailsId}`,{authenticate:!0}));m(this,"addAdyenPaymentDetails",async t=>this.cleengService.post("/connectors/adyen/payment-details",JSON.stringify({...t,attemptAuthentication:this.cleengService.sandbox?"always":void 0}),{authenticate:!0}));m(this,"finalizeAdyenPaymentDetails",async t=>this.cleengService.post("/connectors/adyen/payment-details/finalize",JSON.stringify(t),{authenticate:!0}));m(this,"directPostCardPayment",async()=>!1);this.cleengService=t,this.getCustomerIP=n}})||wt)||wt)||wt)||wt)||wt);var Pi,Ei,ki,Ii,qt;let kh=(Pi=_e(),Ei=function(s,e){return ie(kt)(s,void 0,0)},ki=Reflect.metadata("design:type",Function),Ii=Reflect.metadata("design:paramtypes",[typeof kt>"u"?Object:kt]),Pi(qt=Ei(qt=ki(qt=Ii(qt=class extends Us{constructor(t){super();m(this,"cleengService");m(this,"getActiveSubscription",async({customerId:t})=>{const n=await this.getSubscriptions({customerId:t});return n.errors.length>0?null:n.responseData.items.find(a=>a.status==="active"||a.status==="cancelled")||null});m(this,"getAllTransactions",async({customerId:t})=>{const n=await this.getTransactions({customerId:t});return n.errors.length>0?null:n.responseData.items});m(this,"getActivePayment",async({customerId:t})=>{const n=await this.getPaymentDetails({customerId:t});return n.errors.length>0?null:n.responseData.paymentDetails.find(a=>a.active)||null});m(this,"getSubscriptions",async t=>this.cleengService.get(`/customers/${t.customerId}/subscriptions`,{authenticate:!0}));m(this,"updateSubscription",async t=>this.cleengService.patch(`/customers/${t.customerId}/subscriptions`,JSON.stringify(t),{authenticate:!0}));m(this,"getPaymentDetails",async t=>this.cleengService.get(`/customers/${t.customerId}/payment_details`,{authenticate:!0}));m(this,"getTransactions",async({customerId:t,limit:n,offset:a})=>this.cleengService.get(Ie(`/customers/${t}/transactions`,{limit:n,offset:a}),{authenticate:!0}));m(this,"fetchReceipt",async({transactionId:t})=>this.cleengService.get(`/receipt/${t}`,{authenticate:!0}));m(this,"updateCardDetails");m(this,"changeSubscription");this.cleengService=t}})||qt)||qt)||qt)||qt);const Ih=(s,e)=>{var a;const t=s.menu.find(o=>o.contentId===e);return((a=t==null?void 0:t.filterTags)==null?void 0:a.split(",").filter(Boolean))||[]},Ah=(s,e)=>e===""?s:{...s,playlist:s.playlist.filter(({tags:t})=>t?t.split(",").includes(e):!1)},al=(s=15)=>({title:"",playlist:new Array(s).fill({}).map((e,t)=>({description:"",duration:0,feedid:"",image:"",images:[],cardImage:"",backgroundImage:"",channelLogoImage:"",link:"",genre:"",mediaid:`placeholder_${t}`,pubdate:0,rating:"",sources:[],tags:"",title:"",tracks:[]}))}),Th=(s=[],e=[])=>!s||!e?{}:s==null?void 0:s.reduce((n,a)=>{const o=e==null?void 0:e.find(i=>i.name===a.name);if(o){const i=a.isCustomRegisterField?o.value??"":o.state==="accepted";n[a.name]=i}return n},{}),Nh=(s=[],e=[])=>{if(!s||!e)return{};const t={};return s==null||s.forEach(n=>{e!=null&&e.find(a=>a.name===n.name&&a.state==="accepted")&&(t[n.name]=!0)}),t},Lh=s=>{const e={};return s&&(s==null||s.forEach(t=>{e[t.name]=t.type==="checkbox"?t.enabledByDefault===!0:t.defaultValue??""})),e},Fn=(s,e)=>{const t=[];return!s||!e||s.forEach(n=>{t.push({name:n.name,version:n.version,state:e[n.name]?"accepted":"declined",value:e[n.name]??""})}),t},$h=(s,e)=>{const t=[],n=[];return!s||!e?{customerConsents:t,consentsErrors:n}:(s.forEach(a=>{a.required&&!e[a.name]&&n.push(a.name),t.push({name:a.name,version:a.version,state:e[a.name]?"accepted":"declined",value:e[a.name]??""})}),{customerConsents:t,consentsErrors:n})},Rh=s=>s.value!=="",Oh=({name:s,value:e=""},t,n)=>{const a=s==="us_state"?n.find(({name:i,value:c})=>i==="country"&&c==="us")?e==="n/a"?"":e:"n/a":(e===!0||e===!1)&&s!=="terms"?e?"on":"off":e;return[s,a]},Gr=s=>Object.fromEntries(s.filter(Rh).map(Oh)),Ai=s=>Array.isArray(s)||typeof s=="object"&&s!==null?JSON.parse(JSON.stringify(s)):s,ol=s=>{if(typeof s=="string"&&hu.includes(s))return s},il=s=>{if(!s)return 0;const e=s.split(":");return e.length===2?Math.floor(parseInt(e[1])/parseInt(e[0])):0};var Ti,Ni,Li,$i,Ri,bt;const Dh="https://inplayer.com/legal/terms";let Fh=(Ti=_e(),Ni=function(s,e){return ie(ge)(s,void 0,0)},Li=function(s,e){return ie(Re)(s,void 0,1)},$i=Reflect.metadata("design:type",Function),Ri=Reflect.metadata("design:paramtypes",[typeof ge>"u"?Object:ge,typeof Re>"u"?Object:Re]),Ti(bt=Ni(bt=Li(bt=$i(bt=Ri(bt=class extends yt{constructor(t,n){super({canUpdateEmail:!1,canSupportEmptyFullName:!1,canChangePasswordWithOldPassword:!0,canRenewSubscription:!1,canExportAccountData:!0,canUpdatePaymentMethod:!1,canShowReceipts:!0,canDeleteAccount:!0,hasNotifications:!0,hasSocialURLs:!0,watchListSizeLimit:48});m(this,"storageService");m(this,"apiService");m(this,"clientId","");m(this,"accessModel",Fe.AUTHVOD);m(this,"assetId",null);m(this,"svodOfferIds",[]);m(this,"sandbox",!1);m(this,"parseJson",(t,n={})=>{try{return JSON.parse(t)}catch{return n}});m(this,"formatFavorite",t=>({mediaid:t.media_id}));m(this,"formatHistoryItem",t=>({mediaid:t.media_id,progress:t.progress}));m(this,"formatAccount",t=>{const{id:n,uuid:a,email:o,full_name:i,metadata:c,created_at:l}=t,d=new Date(l*1e3).toLocaleString(),h=c==null?void 0:c.first_name,u=c==null?void 0:c.surname;return{id:n.toString(),uuid:a,email:o,fullName:i,firstName:h,lastName:u,metadata:c,regDate:d,country:"",lastUserIp:""}});m(this,"initialize",async(t,n,a)=>{var u;const o=(u=t.integrations)==null?void 0:u.jwp;if(!(o!=null&&o.clientId))throw new Error("Failed to initialize JWP integration. The clientId is missing.");this.sandbox=!!o.useSandbox;const i=this.sandbox?"development":"production";Ks.setConfig(i),this.apiService.setup(this.sandbox),o.clientId&&(this.clientId=o.clientId),o.assetId&&(this.accessModel=Fe.SVOD,this.assetId=o.assetId,this.svodOfferIds=o.assetId?[String(o.assetId)]:[]);const c=new URLSearchParams(n.split("#")[1]),l=c.get("token"),d=c.get("refresh_token"),h=c.get("expires");!l||!d||!h||this.apiService.setToken(l,d,parseInt(h))});m(this,"getAuthData",async()=>{if(await this.apiService.isAuthenticated()){const t=await this.apiService.getToken();return{jwt:t.token,refreshToken:t.refreshToken}}return null});m(this,"getPublisherConsents",async()=>{try{const t=await this.apiService.get(`/accounts/register-fields/${this.clientId}`),n=t==null?void 0:t.collection.find(({name:o})=>o==="terms"),a=t==null?void 0:t.collection.filter(o=>!["email_confirmation","first_name","surname"].includes(o.name)&&![n].includes(o)).map(o=>({type:o.type,isCustomRegisterField:!0,name:o.name,label:o.label,placeholder:o.placeholder,required:o.required,options:o.options,defaultValue:"",version:"1",...o.type==="checkbox"?{enabledByDefault:o.default_value==="true"}:{defaultValue:o.default_value}}));return n?[this.getTermsConsent(n),...a]:a}catch{throw new Error("Failed to fetch publisher consents.")}});m(this,"getCustomerConsents",async t=>{var n;try{if(!(t!=null&&t.customer))return{consents:[]};const{customer:a}=t;return this.parseJson((n=a.metadata)==null?void 0:n.consents,[])}catch{throw new Error("Unable to fetch Customer consents.")}});m(this,"updateCustomerConsents",async t=>{var n;try{const{customer:a,consents:o}=t,i=this.formatUpdateAccount(a),c={...i,metadata:{...i.metadata,...Gr(o),consents:JSON.stringify(o)}},l=await this.apiService.put("/accounts",c,{withAuthentication:!0});return this.parseJson((n=l==null?void 0:l.metadata)==null?void 0:n.consents,[])}catch{throw new Error("Unable to update Customer consents")}});m(this,"updateCaptureAnswers",async({customer:t,...n})=>this.updateCustomer({...t,...n}));m(this,"changePasswordWithOldPassword",async t=>{const{oldPassword:n,newPassword:a,newPasswordConfirmation:o}=t;try{await this.apiService.post("/accounts/change-password",{old_password:n,password:a,password_confirmation:o},{withAuthentication:!0})}catch(i){throw Re.isCommonError(i)?new Error(i.response.data.message):new Error("Failed to change password")}});m(this,"resetPassword",async({customerEmail:t})=>{try{await this.apiService.post("/accounts/forgot-password",{email:t,merchant_uuid:this.clientId,branding_id:0})}catch{throw new Error("Failed to reset password.")}});m(this,"login",async({email:t,password:n,referrer:a})=>{var o;try{const i=await this.apiService.post("/v2/accounts/authenticate",{client_id:this.clientId||"",grant_type:"password",referrer:a,username:t,password:n});this.apiService.setToken(i.access_token,"",i.expires);const c=this.formatAccount(i.account);return{auth:this.formatAuth(i),user:c,customerConsents:this.parseJson((o=c==null?void 0:c.metadata)==null?void 0:o.consents,[])}}catch{throw new Error("Failed to authenticate user.")}});m(this,"register",async({email:t,password:n,referrer:a,consents:o})=>{var i;try{const c=await this.apiService.post("/accounts",{full_name:t,username:t,password:n,password_confirmation:n,client_id:this.clientId||"",type:"consumer",referrer:a,grant_type:"password",metadata:{first_name:" ",surname:" ",...Gr(o),consents:JSON.stringify(o)}});this.apiService.setToken(c.access_token,"",c.expires);const l=this.formatAccount(c.account);return{auth:this.formatAuth(c),user:l,customerConsents:this.parseJson((i=l==null?void 0:l.metadata)==null?void 0:i.consents,[])}}catch(c){throw Re.isCommonError(c)?new Error(c.response.data.message):new Error("Failed to create account.")}});m(this,"logout",async()=>{try{Ks.Notifications.isSubscribed()&&Ks.Notifications.unsubscribe(),await this.apiService.isAuthenticated()&&(await this.apiService.get("/accounts/logout",{withAuthentication:!0}),await this.apiService.removeToken())}catch{throw new Error("Failed to sign out.")}});m(this,"getUser",async()=>{var t;try{const n=await this.apiService.get("/accounts",{withAuthentication:!0}),a=this.formatAccount(n);return{user:a,customerConsents:this.parseJson((t=a==null?void 0:a.metadata)==null?void 0:t.consents,[])}}catch{throw new Error("Failed to fetch user data.")}});m(this,"updateCustomer",async t=>{try{const n=await this.apiService.put("/accounts",this.formatUpdateAccount(t),{withAuthentication:!0});return this.formatAccount(n)}catch{throw new Error("Failed to update user data.")}});m(this,"formatUpdateAccount",t=>{var l,d;const n=((l=t.firstName)==null?void 0:l.trim())||"",a=((d=t.lastName)==null?void 0:d.trim())||"",o=`${n} ${a}`.trim()||t.email,i={...t.metadata,first_name:n,surname:a};return{full_name:o,metadata:i}});m(this,"getCaptureStatus",async({customer:{firstName:t,lastName:n}})=>{const a=(t==null?void 0:t.trim())||"",o=(n==null?void 0:n.trim())||"";return{isCaptureEnabled:!0,shouldCaptureBeDisplayed:!a||!o,settings:[{answer:{firstName:a||null,lastName:o||null},enabled:!0,key:"firstNameLastName",required:!0}]}});m(this,"changePasswordWithResetToken",async t=>{const{resetPasswordToken:n="",newPassword:a,newPasswordConfirmation:o=""}=t;try{await this.apiService.put(`/accounts/forgot-password/${n}`,{password:a,password_confirmation:o,branding_id:0})}catch(i){throw Re.isCommonError(i)?new Error(i.response.data.message):new Error("Failed to change password.")}});m(this,"getTermsConsent",({label:t})=>{const n=`<a href="${t||Dh}" target="_blank">${we.t("account:registration.terms_and_conditions")}</a>`;return{type:"checkbox",isCustomRegisterField:!0,required:!0,name:"terms",defaultValue:"",label:t?we.t("account:registration.terms_consent",{termsLink:n}):we.t("account:registration.terms_consent_jwplayer",{termsLink:n}),enabledByDefault:!1,placeholder:"",options:{},version:"1"}});m(this,"updateWatchHistory",async({history:t})=>{const n=await this.getWatchHistory(),a=n.map(o=>o.mediaid)||[];await Promise.allSettled(t.map(({mediaid:o,progress:i})=>{if(!a.includes(o)||n.some(c=>c.mediaid==o&&c.progress!=i))return this.apiService.patch("/v2/accounts/media/watch-history",{media_id:o,progress:i},{withAuthentication:!0})}))});m(this,"updateFavorites",async({favorites:t})=>{const a=(await this.getFavorites()).map(i=>i.mediaid)||[],o=t.map(i=>i.mediaid);await Promise.allSettled(o.map(i=>a.includes(i)?Promise.resolve():this.apiService.post("/v2/accounts/media/favorites",{media_id:i},{withAuthentication:!0}))),await Promise.allSettled(a.map(i=>o.includes(i)?Promise.resolve():this.apiService.remove(`/v2/accounts/media/favorites/${i}`,{withAuthentication:!0})))});m(this,"getFavorites",async()=>{var n;const t=await this.apiService.get("/v2/accounts/media/favorites",{withAuthentication:!0});return((n=t==null?void 0:t.collection)==null?void 0:n.map(this.formatFavorite))||[]});m(this,"getWatchHistory",async()=>{var n;const t=await this.apiService.get("/v2/accounts/media/watch-history",{withAuthentication:!0},{filter:"currently_watching"});return((n=t==null?void 0:t.collection)==null?void 0:n.map(this.formatHistoryItem))||[]});m(this,"subscribeToNotifications",async({uuid:t,onMessage:n})=>{try{return Ks.Notifications.isSubscribed()||Ks.subscribe(t,{onMessage:n,onOpen:()=>!0}),!0}catch{return!1}});m(this,"exportAccountData",async()=>{try{return await this.apiService.post("/accounts/export",{password:void 0,branding_id:0},{withAuthentication:!0})}catch{throw new Error("Failed to export account data")}});m(this,"deleteAccount",async({password:t})=>{try{return await this.apiService.remove("/accounts/erase",{withAuthentication:!0},{password:t,branding_id:0})}catch(n){throw Re.isCommonError(n)?new Error(n.response.data.message||"Failed to delete account"):new Error("Failed to delete account")}});m(this,"getSocialUrls",async({redirectUrl:t})=>{const n=this.storageService.base64Encode(JSON.stringify({client_id:this.clientId||"",redirect:t})),a=await this.apiService.get("/accounts/social",{includeFullResponse:!0},{state:n});if(a.status!==200)throw new Error("Failed to fetch social urls");return a.data.social_urls});this.storageService=t,this.apiService=n}formatAuth(t){const{access_token:n}=t;return{jwt:n,refreshToken:""}}})||bt)||bt)||bt)||bt)||bt);const da=(s,{minutesAbbreviation:e})=>s?`${Math.ceil(s/60)} ${e}`:"",cl=(s,{hoursAbbreviation:e,minutesAbbreviation:t})=>{if(!s)return"";const n=Math.floor(s/3600),a=Math.round((s-n*3600)/60),o=n?`${n}${e}`:"",i=a?`${a}${t}`:"";return[o,i].filter(Boolean).join(" ")},lt=(s,e,t)=>new Intl.NumberFormat(t||"en-US",{style:"currency",currency:e}).format(s),Kn=(s,e)=>!s&&!e?"":s&&s!=="0"?`S${s}:E${e}`:`E${e}`,Mh=(s,e,t)=>e?t?`${Bn(e,s," • ")} - ${ll(t,s)}`:Bn(e,s," • "):"",Pt=(s,e)=>new Intl.DateTimeFormat(e,{day:"numeric",month:"long",year:"numeric"}).format(s),ll=(s,e)=>new Intl.DateTimeFormat(e,{hour:"numeric",minute:"numeric"}).format(s),Bn=(s,e,t=" ")=>`${Pt(s,e)}${t}${ll(s,e)}`,Bh=s=>lt(s.customerPriceInclTax,s.customerCurrency,s.customerCountry),ua=s=>{var e;return((e=s.offerId)==null?void 0:e[0])==="S"};var Oi,Di,Fi,Mi,zt;let Uh=(Oi=_e(),Di=function(s,e){return ie(Re)(s,void 0,0)},Fi=Reflect.metadata("design:type",Function),Mi=Reflect.metadata("design:paramtypes",[typeof Re>"u"?Object:Re]),Oi(zt=Di(zt=Fi(zt=Mi(zt=class extends Bs{constructor(t){super();m(this,"cardPaymentProvider","stripe");m(this,"apiService");m(this,"formatPaymentMethod",(t,n)=>({id:t.id,methodName:t.method_name.toLocaleLowerCase(),provider:n,logoUrl:""}));m(this,"formatEntitlements",(t=0,n=!1)=>({errors:[],responseData:{accessGranted:n,expiresAt:t}}));m(this,"formatOffer",t=>({id:t.id,offerId:this.formatOfferId(t),offerCurrency:t.currency,customerPriceInclTax:t.amount,customerCurrency:t.currency,offerTitle:t.description,active:!0,period:t.access_type.period==="month"&&t.access_type.quantity===12?"year":t.access_type.period,freePeriods:t.trial_period?1:0,planSwitchEnabled:t.item.plan_switch_enabled??!1}));m(this,"formatOrder",t=>({id:t.offer.id,customerId:t.customerId,offerId:t.offer.offerId,totalPrice:t.offer.customerPriceInclTax,priceBreakdown:{offerPrice:t.offer.customerPriceInclTax,discountAmount:t.offer.customerPriceInclTax,discountedPrice:t.offer.customerPriceInclTax,paymentMethodFee:0,taxValue:0},taxRate:0,currency:t.offer.offerCurrency||"EUR",requiredPaymentDetails:!0}));m(this,"createOrder",async t=>({errors:[],responseData:{message:"",order:this.formatOrder(t),success:!0}}));m(this,"getOffers",async t=>(await Promise.all(t.offerIds.map(async a=>{try{const o=await this.apiService.get(`/v2/items/${this.parseOfferId(a)}/access-fees`);return o==null?void 0:o.map(i=>this.formatOffer(i))}catch{throw new Error("Failed to get offers")}}))).flat());m(this,"getPaymentMethods",async()=>{try{const t=await this.apiService.get("/payments/methods",{withAuthentication:!0}),n=[];return t.forEach(a=>{["card","paypal"].includes(a.method_name.toLowerCase())&&n.push(this.formatPaymentMethod(a,this.cardPaymentProvider))}),{errors:[],responseData:{message:"",paymentMethods:n,status:1}}}catch{throw new Error("Failed to get payment methods")}});m(this,"paymentWithPayPal",async t=>{try{const n=await this.apiService.post("/external-payments",{origin:t.waitingUrl,access_fee:t.order.id,payment_method:2,voucher_code:t.couponCode},{withAuthentication:!0});return n!=null&&n.id?{errors:["Already have an active access"],responseData:{redirectUrl:t.errorUrl}}:{errors:[],responseData:{redirectUrl:n.endpoint}}}catch{throw new Error("Failed to generate PayPal payment url")}});m(this,"iFrameCardPayment",async()=>({errors:[],responseData:{}}));m(this,"paymentWithoutDetails",async()=>({errors:[],responseData:{}}));m(this,"updateOrder",async({order:t,couponCode:n})=>{try{const a=await this.apiService.post("/vouchers/discount",{voucher_code:`${n}`,access_fee_id:t.id},{withAuthentication:!0}),o=t.totalPrice-a.amount,i={...t,totalPrice:a.amount,priceBreakdown:{...t.priceBreakdown,discountAmount:o,discountedPrice:o},discount:{applied:!0,type:"coupon",periods:a.discount_duration}};return{errors:[],responseData:{message:"successfully updated",order:i,success:!0}}}catch(a){throw Re.isCommonError(a)&&a.response.data.message==="Voucher not found"?new Error("Invalid coupon code"):new Error("An unknown error occurred")}});m(this,"getEntitlements",async({offerId:t})=>{try{const n=await this.apiService.get(`/items/${this.parseOfferId(t)}/access`,{withAuthentication:!0});return this.formatEntitlements(n.expires_at,!0)}catch{return this.formatEntitlements()}});m(this,"directPostCardPayment",async(t,n,a,o)=>{const i={number:t.cardNumber.replace(/\s/g,""),card_name:t.cardholderName,exp_month:t.cardExpMonth||"",exp_year:t.cardExpYear||"",cvv:t.cardCVC,access_fee:n.id,payment_method:1,voucher_code:t.couponCode,referrer:a,return_url:o};try{return ua(n)?await this.apiService.post("/subscriptions",i,{withAuthentication:!0}):await this.apiService.post("/payments",i,{withAuthentication:!0}),!0}catch{throw new Error("Failed to make payment")}});m(this,"getSubscriptionSwitches");m(this,"getOrder");m(this,"switchSubscription");m(this,"getSubscriptionSwitch");m(this,"createAdyenPaymentSession");m(this,"initialAdyenPayment");m(this,"finalizeAdyenPayment");m(this,"updatePaymentMethodWithPayPal");m(this,"deletePaymentMethod");m(this,"addAdyenPaymentDetails");m(this,"finalizeAdyenPaymentDetails");m(this,"getOffer");this.apiService=t}formatOfferId(t){return["ppv","ppv_custom"].includes(t.access_type.name)?`C${t.item_id}_${t.id}`:`S${t.item_id}_${t.id}`}parseOfferId(t){return typeof t=="string"?t.startsWith("C")||t.startsWith("S")?parseInt(t.slice(1).split("_")[0]):parseInt(t):t}})||zt)||zt)||zt)||zt);var Bi,Ui,Hi,Wi,Vi,St;let Hh=(Bi=_e(),Ui=function(s,e){return Ad("JWP")(s,void 0,0)},Hi=function(s,e){return ie(Re)(s,void 0,1)},Wi=Reflect.metadata("design:type",Function),Vi=Reflect.metadata("design:paramtypes",[typeof yt>"u"?Object:yt,typeof Re>"u"?Object:Re]),Bi(St=Ui(St=Hi(St=Wi(St=Vi(St=class extends Us{constructor(t,n){super();m(this,"accountService");m(this,"apiService");m(this,"formatCardDetails",t=>{const{number:n,exp_month:a,exp_year:o,card_name:i,card_type:c,account_id:l,currency:d}=t,h=`0${a}`.slice(-2);return{id:0,paymentMethodId:0,paymentGateway:"card",paymentMethod:"card",customerId:l.toString(),paymentMethodSpecificParams:{holderName:i,variant:c,lastCardFourDigits:String(n),cardExpirationDate:`${h}/${o}`},active:!0,currency:d}});m(this,"formatTransaction",t=>{var a,o,i;const n=((a=t==null?void 0:t.charged_amount)==null?void 0:a.toString())||"0";return{transactionId:t.transaction_token||we.t("user:payment.access_granted"),transactionDate:t.created_at,trxToken:t.trx_token,offerId:((o=t.item_id)==null?void 0:o.toString())||we.t("user:payment.no_transaction"),offerType:t.item_type||"",offerTitle:(t==null?void 0:t.item_title)||"",offerPeriod:"",transactionPriceExclTax:n,transactionCurrency:t.currency_iso||"EUR",discountedOfferPrice:n,offerCurrency:t.currency_iso||"EUR",offerPriceExclTax:n,applicableTax:"0",transactionPriceInclTax:n,customerId:(i=t.consumer_id)==null?void 0:i.toString(),customerEmail:"",customerLocale:"",customerCountry:"en",customerIpCountry:"",customerCurrency:"",paymentMethod:t.payment_method_name||we.t("user:payment.access_granted")}});m(this,"formatActiveSubscription",(t,n)=>{var o,i;let a="";switch(t.action_type){case"free-trial":a="active_trial";break;case"recurrent":a="active";break;case"canceled":a="cancelled";break;case"incomplete_expired":a="expired";break;default:a="terminated"}return{subscriptionId:t.subscription_id,offerId:(o=t.item_id)==null?void 0:o.toString(),accessFeeId:`S${t.access_fee_id}`,status:a,expiresAt:n,nextPaymentAt:t.next_rebill_date,nextPaymentPrice:t.subscription_price,nextPaymentCurrency:t.currency,paymentGateway:"stripe",paymentMethod:t.payment_method_name,offerTitle:t.item_title,period:(i=t.access_type)==null?void 0:i.period,totalPrice:t.charged_amount,unsubscribeUrl:t.unsubscribe_url,pendingSwitchId:null}});m(this,"formatGrantedSubscription",t=>({subscriptionId:"",offerId:t.item.id.toString(),status:"active",expiresAt:t.expires_at,nextPaymentAt:t.expires_at,nextPaymentPrice:0,nextPaymentCurrency:"EUR",paymentGateway:"none",paymentMethod:we.t("user:payment.access_granted"),offerTitle:t.item.title,period:"granted",totalPrice:0,unsubscribeUrl:"",pendingSwitchId:null}));m(this,"getActiveSubscription",async()=>{const t=this.accountService.assetId;if(t===null)throw new Error("Couldn't fetch active subscription, there is no assetId configured");try{const n=await this.apiService.get(`/items/${t}/access`,{withAuthentication:!0});if(n){const o=(await this.apiService.get("/subscriptions",{withAuthentication:!0,contentType:"json"},{limit:15,page:0})).collection.find(i=>i.item_id===t);return o?this.formatActiveSubscription(o,n==null?void 0:n.expires_at):this.formatGrantedSubscription(n)}return null}catch(n){if(Re.isCommonError(n)&&n.response.data.code===402)return null;throw new Error("Unable to fetch customer subscriptions.")}});m(this,"getAllTransactions",async()=>{var t;try{const n=await this.apiService.get("/v2/accounting/payment-history",{withAuthentication:!0,contentType:"json"});return(t=n==null?void 0:n.collection)==null?void 0:t.map(a=>this.formatTransaction(a))}catch{throw new Error("Failed to get transactions")}});m(this,"getActivePayment",async()=>{var t;try{const n=await this.apiService.get("/v2/payments/cards/default",{withAuthentication:!0,contentType:"json"}),a=[];for(const o in n==null?void 0:n.cards)a.push(this.formatCardDetails({...(t=n.cards)==null?void 0:t[o],currency:o}));return a.find(o=>o.active)||null}catch{return null}});m(this,"getSubscriptions",async()=>({errors:[],responseData:{items:[]}}));m(this,"updateSubscription",async({offerId:t,unsubscribeUrl:n})=>{if(!n)throw new Error("Missing unsubscribe url");try{return await this.apiService.get(n,{withAuthentication:!0,contentType:"json"}),{errors:[],responseData:{offerId:t,status:"cancelled",expiresAt:0}}}catch{throw new Error("Failed to update subscription")}});m(this,"changeSubscription",async({accessFeeId:t,subscriptionId:n})=>{try{const a=await this.apiService.post("/v2/subscriptions/stripe:switch",{inplayer_token:n,access_fee_id:t},{withAuthentication:!0});return{errors:[],responseData:{message:a.message}}}catch{throw new Error("Failed to change subscription")}});m(this,"updateCardDetails",async({cardName:t,cardNumber:n,cvc:a,expMonth:o,expYear:i,currency:c})=>{try{const l=await this.apiService.put("/v2/payments/cards/default",{number:n,card_name:t,cvv:a,exp_month:o,exp_year:i,currency_iso:c},{withAuthentication:!0});return{errors:[],responseData:l}}catch{throw new Error("Failed to update card details")}});m(this,"fetchReceipt",async({transactionId:t})=>{try{const n=await this.apiService.get(`/v2/accounting/transactions/${t}/receipt`,{withAuthentication:!0,contentType:"json",responseType:"blob"});return{errors:[],responseData:n}}catch{throw new Error("Failed to get billing receipt")}});m(this,"getPaymentDetails");m(this,"getTransactions");this.accountService=t,this.apiService=n}})||St)||St)||St)||St)||St);const Wh=s=>s.container.get(Gn).getIntegrationType(),Vh=s=>{var e,t;return(t=(e=s.integrations)==null?void 0:e.cleeng)!=null&&t.id?Xt.CLEENG:null},qh=s=>{var e,t;return(t=(e=s.integrations)==null?void 0:e.jwp)!=null&&t.clientId?Xt.JWP:null};te.bind($n).toSelf();te.bind(Wr).toSelf();te.bind(Vr).toSelf();te.bind(nl).toSelf();te.bind(Le).toSelf();te.bind(Rn).toSelf();te.bind(On).toSelf();te.bind(Gn).toSelf();te.bind(Rs).toSelf();te.bind(hs).toSelf();te.bind(rl).toSelf();te.bind(ye).toSelf();te.bind(At).toSelf();te.bind(cn).toSelf();te.bind(pn).to(xh).whenTargetNamed(ra.jwp);te.bind(pn).to(_h).whenTargetNamed(ra.viewNexa);te.bind(Ms).toDynamicValue(Wh);te.bind(Hc).toDynamicValue(wh);te.bind(aa).toConstantValue(Vh);te.bind(kt).toSelf();te.bind(yt).to(Ph).whenTargetNamed(Xt.CLEENG);te.bind(Bs).to(Eh).whenTargetNamed(Xt.CLEENG);te.bind(Us).to(kh).whenTargetNamed(Xt.CLEENG);te.bind(aa).toConstantValue(qh);te.bind(Re).toSelf();te.bind(la).toSelf();te.bind(yt).to(Fh).whenTargetNamed(Xt.JWP);te.bind(Bs).to(Uh).whenTargetNamed(Xt.JWP);te.bind(Us).to(Hh).whenTargetNamed(Xt.JWP);class zh extends ca{constructor(e){super(),this.logLevel=e}log(e,t,n,a,o){if(!(e<this.logLevel)){switch(e){case tt.ERROR:case tt.FATAL:console.error(`${tt[e]} [${t}] ${n}`);break;case tt.WARN:console.warn(`${tt[e]} [${t}] ${n}`);break;default:console.log(`${tt[e]} [${t}] ${n}`)}o&&console.error(o),a&&Object.keys(a).length>0&&console.log(a)}}}var qi,zi;let Gh=(qi=_e(),qi(zi=class extends ge{constructor(){super(...arguments);m(this,"prefix","jwapp")}initialize(t){this.prefix=t}getStorageKey(t){return`${this.prefix}.${t}`}async getItem(t,n,a=!0){try{const o=window.localStorage.getItem(a?this.getStorageKey(t):t);return o&&n?JSON.parse(o):o}catch(o){Ue("LocalStorageService","Failed to parse localStorage entry",{error:o})}}async setItem(t,n,a=!0){try{window.localStorage.setItem(a?this.getStorageKey(t):t,n)}catch(o){Ue("LocalStorageService","Failed to store localStorage entry",{error:o})}}async removeItem(t){try{window.localStorage.removeItem(this.getStorageKey(t))}catch(n){Ue("LocalStorageService","Failed to remove localStorage entry",{error:n})}}base64Encode(t){return window.btoa(t)}base64Decode(t){return window.atob(t)}})||zi);te.bind(ge).to(Gh);te.bind(Wc).toConstantValue(new Td("jwp-refresh-token-channel"));te.bind(hn).toConstantValue(async()=>void 0);te.bind(ca).toDynamicValue(()=>new zh(tt.ERROR));const dl=new Nd({defaultOptions:{queries:{staleTime:60*60*1e3,refetchOnWindowFocus:!1,retryOnMount:!1}}});function Kh({children:s}){return r.jsx(Ld,{client:dl,children:s})}const Jh="_errorPage_rlhdo_1",Yh="_box_rlhdo_17",Qh="_title_rlhdo_22",Xh="_message_rlhdo_29",Zh="_main_rlhdo_33",em="_logo_rlhdo_45",tm="_links_rlhdo_49",sm="_stack_rlhdo_53",nm="_image_rlhdo_58",Es={errorPage:Jh,box:Yh,title:Qh,message:Xh,main:Zh,logo:em,links:tm,stack:sm,image:nm},nt=({title:s,message:e,learnMoreLabel:t,...n})=>{const{t:a}=T("error");return r.jsx(ul,{title:s||a("generic_error_heading"),message:e||a("generic_error_description"),learnMoreLabel:t||a("learn_more"),...n})},ul=({title:s,children:e,message:t,learnMoreLabel:n,error:a,helpLink:o})=>{const i=G(l=>{var d,h;return(h=(d=l.config)==null?void 0:d.assets)==null?void 0:h.banner});return r.jsx("div",{className:Es.errorPage,children:r.jsxs("div",{className:Es.box,children:[r.jsx("img",{className:Es.image,src:i||"/images/logo.png",alt:""}),r.jsx("h1",{className:Es.title,"aria-live":"polite",children:s||"An error occurred"}),r.jsxs("div",{className:Es.main,children:[r.jsx("p",{className:Es.message,children:t||"Try refreshing this page or come back later."}),e,oa]})]})})},rm="_buffer_rrxgr_1",am="_small_rrxgr_20",om="_large_rrxgr_30",ur={buffer:rm,small:am,large:om},_s=({size:s="medium",className:e=""})=>r.jsxs("div",{className:M(ur.buffer,e,{[ur.small]:s==="small",[ur.large]:s==="large"}),children:[r.jsx("div",{}),r.jsx("div",{}),r.jsx("div",{}),r.jsx("div",{})]}),im="_loadingOverlay_96qzh_1",cm="_fixed_96qzh_7",lm="_transparent_96qzh_17",dm="_inline_96qzh_21",bn={loadingOverlay:im,fixed:cm,transparent:lm,inline:dm},Se=({transparentBackground:s=!1,inline:e=!1})=>{const t=M(bn.loadingOverlay,{[bn.transparent]:s,[bn.fixed]:!e,[bn.inline]:e});return r.jsx("div",{className:t,children:r.jsx(_s,{size:"medium"})})},um="_formFeedback_1hyv5_1",hm="_info_1hyv5_11",mm="_error_1hyv5_16",pm="_warning_1hyv5_21",fm="_success_1hyv5_26",Js={formFeedback:um,info:hm,error:mm,warning:pm,success:fm},gm={info:"polite",success:"assertive",warning:"polite",error:"assertive"},Oe=({children:s,variant:e="error",visible:t=!0})=>{const n=M(Js.formFeedback,{[Js.error]:e==="error",[Js.warning]:e==="warning",[Js.success]:e==="success",[Js.info]:e==="info",hidden:!t}),a=gm[e];return r.jsx("div",{"aria-live":a,className:n,children:s})},hl=p.createContext(void 0),Ke=()=>{const s=p.useContext(hl);if(!s)throw new Error("Announcer context is not defined");return s.announce},_m=({children:s})=>{const[e,t]=p.useState(null),n=p.useCallback((a,o,i=$d(10))=>{t({message:a,variant:o}),setTimeout(()=>{t(null)},i)},[]);return r.jsxs(hl.Provider,{value:{announce:n},children:[e&&gd.createPortal(r.jsx(Oe,{variant:e.variant,visible:!1,children:e.message}),document.body),s]})};function YC(s){throw new Error('Could not dynamically require "'+s+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}const ym=(s,e)=>e.reduce((t,n)=>{const a=s.find(({code:o})=>o===n);if(a)return[...t,a];throw new Error(`Missing defined language for code: ${n}`)},[]),vm=["account","common","country","demo","epg","error","menu","search","us_state","user","video"],xm=[{code:"en",displayName:"English"},{code:"es",displayName:"Español"}],wm=async()=>{const s="en,es".split(",")||[],e="en",t=ym(xm,s);if(G.setState({supportedLanguages:t}),!t.some(({code:n})=>n===e))throw new Error(`The default language is not enabled: ${e}`);await we.use(Rd).use(Od).use(Dd).init({supportedLngs:t.map(({code:n})=>n),fallbackLng:e,returnEmptyString:!1,ns:vm,defaultNS:"common",fallbackNS:"common",interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator"],caches:["localStorage"],lookupLocalStorage:"jwapp.language"},react:{useSuspense:!1}})},ml=(s,e={})=>Ie(`${s.pathname}${s.search||""}`,e),J=(s,e,t)=>Ie(`${s.pathname}${s.search||""}`,{u:e,...t}),Dt=(s,e)=>Ie(window.location.href,{u:s,...e}),he=s=>{const e=p.useRef(()=>{throw new Error("Callback called in render")});return p.useLayoutEffect(()=>{e.current=s},[s]),p.useCallback((...t)=>{if(typeof e.current=="function")return e.current(...t)},[])};function He(s){const[e]=dn();return e.get(s)}const bm=(s,e=1,t)=>{const n=p.useRef(),[a,o]=p.useState(s);return p.useEffect(()=>{if(window.clearTimeout(n.current),a===0){t&&t();return}return n.current=window.setTimeout(()=>{o(i=>i-e)},e*1e3),()=>{window.clearTimeout(n.current)}},[t,a,e]),a},Gi=new Ac({defaultScope:"Singleton",skipBaseClassChecks:!0}),ys=(s,e)=>t=>{if(Gi.isBound(s)){const a=Gi.get(s);return r.jsx(a,{...t})}return r.jsx(e,{...t})},Sm="_button_15pe7_1",jm="_disabled_15pe7_21",Cm="_small_15pe7_33",Pm="_large_15pe7_36",Em="_primary_15pe7_46",km="_outlined_15pe7_53",Im="_active_15pe7_56",Am="_text_15pe7_62",Tm="_danger_15pe7_77",Nm="_fullWidth_15pe7_87",Lm="_startIcon_15pe7_101",$m="_hidden_15pe7_119",Rm="_centerAbsolute_15pe7_123",mt={button:Sm,disabled:jm,small:Cm,large:Pm,default:"_default_15pe7_39",primary:Em,outlined:km,active:Im,text:Am,danger:Tm,delete:"_delete_15pe7_82",fullWidth:Nm,startIcon:Lm,hidden:$m,centerAbsolute:Rm},Om=Symbol("BUTTON"),Dm=({label:s,children:e,color:t="default",startIcon:n,fullWidth:a=!1,active:o=!1,variant:i="outlined",size:c="medium",disabled:l,busy:d,type:h="button",to:u,onClick:g,className:_,activeClassname:f="",...x})=>{const w=b=>M(mt.button,_,mt[t],mt[i],{[mt.active]:b,[f]:b,[mt.fullWidth]:a,[mt.large]:c==="large",[mt.small]:c==="small",[mt.disabled]:l}),v=r.jsxs(r.Fragment,{children:[n&&r.jsx("div",{className:mt.startIcon,children:n}),r.jsx("span",{className:M({[mt.hidden]:d})||void 0,children:s}),e,d&&r.jsx(_s,{className:mt.centerAbsolute,size:"small"})]});return u?r.jsx(Lc,{className:({isActive:b})=>w(b),to:u,...x,end:!0,children:v}):r.jsx("button",{className:w(o),onClick:l?void 0:g,type:h,"aria-disabled":l,...x,children:v})},F=ys(Om,Dm),Fm="_welcome_v7d1f_1",Mm={welcome:Fm},Bm=({onCloseButtonClick:s,onCountdownCompleted:e,siteName:t})=>{const{t:n}=T("account"),a=bm(10,1,e);return r.jsxs("div",{className:Mm.welcome,children:[r.jsx("h2",{children:n("checkout.welcome_title",{siteName:t})}),r.jsx("p",{children:n("checkout.welcome_description",{siteName:t})}),r.jsx(F,{variant:"contained",color:"primary",label:n("checkout.start_watching",{countdown:a}),onClick:s,size:"large",fullWidth:!0})]})},Um="_title_82pz9_1",Hm="_message_82pz9_6",Ki={title:Um,message:Hm},Ji=({type:s,message:e,onCloseButtonClick:t})=>{const{t:n}=T("account");return r.jsxs("div",{children:[r.jsx("h2",{className:Ki.title,children:n(s==="cancelled"?"checkout.payment_cancelled":"checkout.payment_error")}),r.jsx("p",{className:Ki.message,children:s==="cancelled"?n("checkout.payment_cancelled_message"):e}),r.jsx("div",{children:r.jsx(F,{label:n("checkout.close"),onClick:t,color:"primary",variant:"contained",size:"large",fullWidth:!0})})]})},Wm=s=>s==null?void 0:s.scrollTop,ha=({className:s,createStyle:e,open:t=!0,duration:n=250,delay:a=0,onOpenAnimationEnd:o,onCloseAnimationEnd:i,keepMounted:c=!1,children:l})=>{const d=p.useRef(null),[h,u]=p.useState("closed"),[g,_]=p.useState(!1),f=p.useRef(),x=p.useRef(),w=he(()=>{_(!0),Wm(d.current),f.current=window.setTimeout(()=>u("opening"),a),x.current=window.setTimeout(()=>{u("open"),o&&o()},n+a)}),v=he(()=>{g&&(f.current=window.setTimeout(()=>u("closing"),a),x.current=window.setTimeout(()=>{u("closed"),i&&i()},n+a))});return p.useEffect(()=>(t?w():v(),()=>{clearTimeout(f.current),clearTimeout(x.current)}),[t,w,v]),!t&&h==="closed"&&!c?null:r.jsx("div",{style:e(h),className:s,ref:d,children:l})},Vm=({open:s=!0,duration:e=250,delay:t=0,onOpenAnimationEnd:n,onCloseAnimationEnd:a,children:o,className:i})=>{const l=`transform ${e/1e3}s ease-out`,d=h=>({transition:l,transform:h==="opening"||h==="open"?"scale(1)":"scale(0.7)"});return r.jsx(ha,{createStyle:h=>d(h),open:s,duration:e,delay:t,onOpenAnimationEnd:n,onCloseAnimationEnd:a,className:i,children:o})},qm=!!(typeof window<"u"&&window.document&&window.document.createElement);let Sn;function zm(s){if((!Sn&&Sn!==0||s)&&qm){const e=document.createElement("div");e.style.position="absolute",e.style.top="-9999px",e.style.width="50px",e.style.height="50px",e.style.overflow="scroll",document.body.appendChild(e),Sn=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return Sn}const Gm=s=>new Promise(e=>{const t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=s,t.onload=()=>e(),t.onerror=n=>{throw console.info("Error loading external script",n),new Error("Error loading external script")},document.body.appendChild(t)}),Km=()=>{document.body.style.marginRight=`${zm(!0)}px`,document.body.style.overflowY="hidden"},Yi=()=>{Array.from(document.querySelectorAll("dialog")).filter(t=>t.open).length||(document.body.style.removeProperty("margin-right"),document.body.style.removeProperty("overflow-y"))};let Ys;const Jm=()=>{const s=p.useCallback(()=>{if(!Ys||document.activeElement!==document.body)return;Array.from(document.querySelectorAll("dialog")).filter(o=>o.open).length===0&&(Ys.focus(),Ys=void 0)},[]);p.useEffect(()=>()=>{Yi(),s()},[s]);const e=p.useCallback(()=>{Ys||(Ys=document.activeElement),Km()},[]),t=p.useCallback(()=>{s(),Yi()},[s]);return{handleOpen:e,handleClose:t}},Ym="_centered_evruy_15",Qm="_close_evruy_21",jn={centered:Ym,close:Qm,"fade-out":"_fade-out_evruy_1","fade-in":"_fade-in_evruy_1"},Jn=({open:s,onClose:e,children:t,className:n,centered:a,role:o,AnimationComponent:i=Vm,animationContainerClassName:c,...l})=>{const d=p.useRef(),h=p.useRef({downTarget:null,upTarget:null}),{handleOpen:u,handleClose:g}=Jm(),_=he(()=>{var C;const y=()=>{var j,S;(j=d.current)==null||j.classList.remove(jn.close),(S=d.current)==null||S.removeEventListener("animationend",y)};(C=d.current)!=null&&C.open&&(d.current.addEventListener("animationend",y),d.current.classList.add(jn.close))}),f=he(()=>{var y,C;u(),(y=d.current)==null||y.showModal(),(C=d.current)==null||C.classList.remove(jn.close)}),x=y=>{y.key==="Escape"&&d.current.contains(y.target)&&(y.preventDefault(),e==null||e())},w=y=>{d.current.contains(y.target)&&(e==null||e(),g())},v=()=>{var y;(y=d.current)==null||y.close()};p.useEffect(()=>{s?f():_()},[f,_,s]);const b=y=>{const{current:{downTarget:C,upTarget:j}}=h;C===j&&y.target===d.current&&(e==null||e(),g())};return _d.createPortal(r.jsx("dialog",{className:M(n,{[jn.centered]:a}),onKeyDown:x,onClose:w,onClick:b,onMouseDown:y=>{h.current.downTarget=y.target},onMouseUp:y=>{h.current.upTarget=y.target},ref:d,role:o,...l,children:r.jsx(i,{open:s,duration:300,className:c,onCloseAnimationEnd:v,children:t})}),document.querySelector("body"))},ma=({open:s=!0,duration:e=250,delay:t=0,onOpenAnimationEnd:n,onCloseAnimationEnd:a,children:o,direction:i="top",style:c={}})=>{const l=e/1e3,d=`transform ${l}s ease, opacity ${l}s ease`,h={left:"translate(-15px, 0)",top:"translate(0, -15px)",right:"translate(15px, 0)",bottom:"translate(0, 15px)"},u=g=>({transition:d,transform:g==="opening"||g==="open"?"translate(0, 0)":h[i],opacity:g==="opening"||g==="open"?1:0,zIndex:15,...c});return r.jsx(ha,{createStyle:g=>u(g),open:s,duration:e,delay:t,onOpenAnimationEnd:n,onCloseAnimationEnd:a,children:o})},Yn=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),p.createElement("path",{d:"M0 0h24v24H0z",fill:"none"})),Xm="_iconButton_12yfl_1",Zm={iconButton:Xm},Ge=({children:s,onClick:e,className:t,...n})=>r.jsx("button",{className:M(Zm.iconButton,t),type:"button",onClick:e,...n,children:s}),ep="_icon_1me4h_1",tp={icon:ep},K=({icon:s,className:e})=>r.jsx(s,{className:M(tp.icon,e),"aria-hidden":"true"}),sp="_modalCloseButton_1qofm_1",np="_hidden_1qofm_15",Qi={modalCloseButton:sp,hidden:np},pl=({onClick:s,visible:e=!0})=>{const{t}=T("common");return r.jsx(Ge,{onClick:s,"aria-label":t("close_modal"),className:M(Qi.modalCloseButton,{[Qi.hidden]:!e}),children:r.jsx(K,{icon:Yn})})},rp="_dialog_1ha9n_1",ap="_small_1ha9n_16",op="_large_1ha9n_20",Xi={dialog:rp,small:ap,large:op},pa=({open:s,onClose:e,children:t,size:n="small",role:a,...o})=>r.jsx(Jn,{open:s,onClose:e,AnimationComponent:ma,role:a,centered:!0,children:r.jsxs("div",{className:M(Xi.dialog,Xi[n]),"data-testid":void 0,...o,children:[t,r.jsx(pl,{onClick:e})]})});function Tt({initialValues:s,validationSchema:e,validateOnBlur:t=!1,onSubmit:n,onSubmitSuccess:a,onSubmitError:o}){const{t:i}=T("error"),[c,l]=p.useState(Object.fromEntries(Object.keys(s).map(P=>[P,!1]))),[d,h]=p.useState(s),[u,g]=p.useState(!1),[_,f]=p.useState({}),[x,w]=p.useState(!1),v=p.useCallback(()=>{h(s),f({}),w(!1),g(!1),l(Object.fromEntries(Object.keys(s).map(P=>[P,!1])))},[s]),b=(P,k)=>{if(e)try{e.validateSyncAt(P,k),f(A=>({...A,[P]:null}))}catch(A){if(A instanceof Ba){const $=A.errors[0];f(L=>({...L,[P]:$})),w(!0)}}},y=p.useCallback((P,k)=>{h(A=>({...A,[P]:k}))},[]),C=P=>{const k=P.target.name,A=P.target instanceof HTMLInputElement&&P.target.type==="checkbox"?P.target.checked:P.target.value,$={...d,[k]:A};h($),l(L=>({...L,[k]:A})),_[k]&&b(k,$)},j=P=>{!t||!c[P.target.name]||b(P.target.name,d)},S=P=>{try{return P.validateSync(d,{abortEarly:!1}),!0}catch(k){if(k instanceof Ba){const A={};for(let $=0;$<k.inner.length;$++){const L=k.inner[$].path,D=k.inner[$].errors[0];L&&D&&!A[L]&&(A[L]=D)}k.inner.every($=>$.type==="required")?A.form=i("validation_form_error.required"):A.form=i("validation_form_error.other"),f(A)}}return!1};return{values:d,errors:_,validationSchemaError:x,handleChange:C,handleBlur:j,handleSubmit:async P=>{if(P.preventDefault(),!(!n||u)){if(f({}),w(!1),e&&!S(e)){w(!0);return}g(!0);try{await n(d,{setValue:y,setErrors:f,setSubmitting:g,setValidationSchemaError:w,validate:S}),a==null||a(d)}catch(k){const A={};k instanceof Ze?Object.entries(k.errors).forEach(([$,L])=>{$&&L&&!A[$]&&(A[$]=L.join(","))}):k instanceof Error?A.form=k.message:A.form=i("unknown_error"),f(A),o==null||o({error:k,resetValue:$=>y($,"")})}g(!1)}},submitting:u,setValue:y,setErrors:f,setSubmitting:g,setValidationSchemaError:w,reset:v}}const fa=(s=!1)=>{const[e,t]=p.useState(s);return[e,a=>t(o=>typeof a<"u"?a:!o)]},ga=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"})),_a=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M11.83,9L15,12.16C15,12.11 15,12.05 15,12A3,3 0 0,0 12,9C11.94,9 11.89,9 11.83,9M7.53,9.8L9.08,11.35C9.03,11.56 9,11.77 9,12A3,3 0 0,0 12,15C12.22,15 12.44,14.97 12.65,14.92L14.2,16.47C13.53,16.8 12.79,17 12,17A5,5 0 0,1 7,12C7,11.21 7.2,10.47 7.53,9.8M2,4.27L4.28,6.55L4.73,7C3.08,8.3 1.78,10 1,12C2.73,16.39 7,19.5 12,19.5C13.55,19.5 15.03,19.2 16.38,18.66L16.81,19.08L19.73,22L21,20.73L3.27,3M12,7A5,5 0 0,1 17,12C17,12.64 16.87,13.26 16.64,13.82L19.57,16.75C21.07,15.5 22.27,13.86 23,12C21.27,7.61 17,4.5 12,4.5C10.6,4.5 9.26,4.75 8,5.2L10.17,7.35C10.74,7.13 11.35,7 12,7Z"})),Zi=(s,e)=>{const t=Math.random()*1e4;return[s,Math.round(t),e].filter(Boolean).join("_").replace(/[\s.]+/g,"_").toLowerCase()},ht=(s,e,t)=>{const[n,a]=p.useState(t||Zi(s,e));return p.useEffect(()=>{a(t||Zi(s,e))},[t,s,e]),n},ip="_helperText_1u6a3_1",cp="_error_1u6a3_6",ec={helperText:ip,error:cp},lp=({children:s,className:e,error:t,id:n})=>{const a=ht("helper_text",void 0,n);return s?r.jsx("div",{id:a,className:M(ec.helperText,{[ec.error]:t},e),children:s}):null},dp="_formField_130lt_1",up="_label_130lt_6",tc={formField:dp,label:up},fn=({className:s,renderInput:e,required:t,label:n,error:a,helperText:o,testId:i,editing:c=!0,name:l})=>{const d=M(tc.formField,s),h=ht("text-field",l),u=ht("helper_text",l);return r.jsxs("div",{className:d,"data-testid":i,children:[!!n&&r.jsxs("label",{htmlFor:h,className:tc.label,children:[n,t&&c?r.jsx("span",{"aria-hidden":"true",children:"*"}):null]}),e({helperTextId:u,id:h}),c&&r.jsx(lp,{id:u,error:a,children:o})]})},hp="_container_bm5y7_1",mp="_error_bm5y7_10",pp="_disabled_bm5y7_13",fp="_leftControl_bm5y7_16",gp="_input_bm5y7_16",_p="_rightControl_bm5y7_19",yp="_control_bm5y7_31",Gt={container:hp,error:mp,disabled:pp,leftControl:fp,input:gp,rightControl:_p,control:yp},vp=(s,e)=>!!e,xp=({required:s,className:e,disabled:t,editing:n=!0,value:a,id:o,name:i,multiline:c,error:l,helperTextId:d,type:h,textAreaRef:u,inputRef:g,leftControl:_,rightControl:f,...x})=>{const w=h||"text",v=M(Gt.container,{[Gt.error]:l,[Gt.disabled]:t,[Gt.leftControl]:!!_,[Gt.rightControl]:!!f},e),b={"aria-required":!!s,"aria-invalid":!!(s&&l&&a!==""),"aria-describedby":d},y={id:o,name:i,value:a,disabled:t,rows:c?3:void 0,className:Gt.input,readOnly:!n,required:s,...b,...x},C=vp(y,c)?r.jsx("textarea",{...y,ref:u}):r.jsx("input",{...y,type:w,ref:g});return n?r.jsxs("div",{className:v,children:[_?r.jsx("div",{className:Gt.control,children:_}):null,C,f?r.jsx("div",{className:Gt.control,children:f}):null]}):C},wp="_textField_cksfq_1",bp={textField:wp},pe=({className:s,helperText:e,label:t,error:n,required:a,editing:o=!0,testId:i,name:c,...l})=>r.jsx(fn,{className:M(bp.textField,s),error:n,helperText:e,label:t,required:a,editing:o,testId:i,name:c,renderInput:d=>r.jsx(xp,{editing:o,error:n,name:c,required:a,...d,...l})}),Sp="_passwordStrength_1od1i_1",jp="_passwordStrengthFill_1od1i_9",Cp="_label_1od1i_13",Pp="_passwordStrengthBar_1od1i_38",Cn={passwordStrength:Sp,passwordStrengthFill:jp,label:Cp,passwordStrengthBar:Pp},Ep=/^(?=.*[a-z])(?=.*[0-9]).{8,}$/,kp=({password:s})=>{const{t:e}=T("account"),n=(o=>{let i=0;return o.match(Ep)&&(o.match(/[A-Z]+/)&&(i+=1),o.match(/(\d.*\d)/)&&(i+=1),o.match(/[!,@#$%^&*?_~]/)&&(i+=1),o.match(/([!,@#$%^&*?_~].*[!,@#$%^&*?_~])/)&&(i+=1)),i})(s),a=[e("registration.password_strength.invalid"),e("registration.password_strength.weak"),e("registration.password_strength.fair"),e("registration.password_strength.strong"),e("registration.password_strength.very_strong")];return n?r.jsxs("div",{className:Cn.passwordStrength,"data-strength":n,children:[r.jsx("div",{className:Cn.passwordStrengthBar,children:r.jsx("div",{className:Cn.passwordStrengthFill})}),r.jsx("span",{className:"hidden",children:e("registration.password_strength_prefix")})," ",r.jsx("span",{className:Cn.label,children:a[n]})]}):null},an=({value:s,showToggleView:e=!0,helperText:t,showHelperText:n=!0,...a})=>{const{t:o}=T("account"),[i,c]=fa();return r.jsx(pe,{...a,helperText:t??(n?r.jsxs(Te.Fragment,{children:[r.jsx(kp,{password:s||""}),o("reset.password_helper_text")]}):null),type:i?"text":"password",rightControl:e?r.jsx(Ge,{"aria-label":o("reset.view_password"),onClick:()=>c(),"aria-pressed":i,children:r.jsx(K,{icon:i?ga:_a})}):null,required:!0})},Ip="_heading_1ungm_1",Ap="_paragraph_1ungm_7",Tp="_disclaimer_1ungm_11",Np="_buttons_1ungm_25",Lp="_stacked_1ungm_34",$p="_warningBox_1ungm_40",Kt={heading:Ip,paragraph:Ap,disclaimer:Tp,buttons:Np,stacked:Lp,warningBox:$p},Rp=()=>{const s=q(ye),{t:e}=T("user"),t=Ke(),n=He("u"),[a,o]=p.useState(""),i=ae(),c=ue(),{handleSubmit:l,handleChange:d,values:h,errors:u,setErrors:g,reset:_}=Tt({initialValues:{password:""},validationSchema:ne().shape({password:B().required(e("login.field_required"))}),onSubmit:w=>{o(w.password),i(J(c,"delete-account-confirmation"),{replace:!0})}}),f=dt(s.deleteAccountData,{onSuccess:async()=>{i("/"),await s.logout(),t(e("account.delete_account.success"),"success")},onError:w=>{w instanceof Ze&&(g(w.errors),i(J(c,"delete-account"),{replace:!0})),o("")}});p.useEffect(()=>{n==="delete-account-confirmation"&&!a&&i(J(c,"delete-account"),{replace:!0})},[c,n,i,a,f,_]);const x=p.useCallback(()=>{i(J(c,null),{replace:!0})},[c,i]);return a?r.jsxs("div",{children:[r.jsx("h2",{className:Kt.heading,children:e("account.delete_account.title")}),r.jsxs("div",{className:Kt.disclaimer,children:[r.jsx("p",{children:e("account.delete_account.modal.text_data_erasure")}),r.jsx("p",{children:e("account.delete_account.modal.text_revoked_access")}),r.jsx("div",{className:Kt.warningBox,children:r.jsx("p",{children:e("account.delete_account.modal.warning")})}),r.jsxs("p",{children:[e("account.delete_account.modal.text_cant_be_undone")," ",r.jsx("br",{}),e("account.delete_account.modal.text_contacts")]})]}),r.jsxs("div",{className:Kt.buttons,children:[r.jsx(F,{disabled:f.isLoading,variant:"text",label:e("account.cancel"),onClick:x}),r.jsx(F,{disabled:f.isLoading,variant:"delete",label:e("account.delete_account.title"),onClick:()=>{f.mutate(a)}})]})]}):r.jsxs("form",{onSubmit:l,children:[r.jsx("h2",{className:Kt.heading,children:e("account.delete_account.title")}),r.jsx("p",{className:Kt.paragraph,children:e("account.delete_account.modal.description")}),u.form&&r.jsx(Oe,{variant:"error",children:u.form}),r.jsx(an,{value:h.password,onChange:d,label:e("account.password"),placeholder:e("account.delete_account.modal.placeholder"),error:!!u.password||!!u.form,helperText:u.password,name:"password",showHelperText:!1}),r.jsxs("div",{className:M(Kt.buttons,Kt.stacked),children:[r.jsx(F,{type:"submit",color:"primary",label:e("account.continue"),fullWidth:!0}),r.jsx(F,{type:"button",onClick:x,variant:"text",label:e("account.cancel"),fullWidth:!0})]})]})},Op="_container_lkpac_1",Dp="_title_lkpac_7",sc={container:Op,title:Dp},Fp=()=>{const s=q(ye),e=q(At),{t}=T("account"),n=Ke(),a=ae(),o=ue(),{accessModel:i}=G(({accessModel:f})=>({accessModel:f})),[c]=dn(),l=c.get("redirectResult"),d=c.get("orderId"),[h,u]=p.useState(),g=p.useMemo(()=>J(o,i===Fe.SVOD?"welcome":null),[i,o]),_=he(async f=>{const x=d?parseInt(d,10):void 0;try{await e.finalizeAdyenPayment({redirectResult:decodeURI(f)},x),await s.reloadSubscriptions({retry:10}),n(t("checkout.payment_success"),"success"),a(g)}catch(w){w instanceof Error&&u(w.message)}});return p.useEffect(()=>{l&&_(l)},[_,l]),r.jsx("div",{className:sc.container,children:h?r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:sc.title,children:h}),r.jsx(F,{label:t("checkout.go_back_to_checkout"),variant:"contained",color:"primary",size:"large",onClick:()=>a(J(o,"checkout")),fullWidth:!0})]}):r.jsx("div",{children:r.jsx(_s,{})})})},Mp=()=>{const s=q(ye),e=q(At),t=p.useRef(),[n,a]=p.useState(null),{t:o}=T("user"),i=e.getSubscriptionOfferIds(),c=p.useCallback(({interval:l=3e3,iterations:d=5,offerId:h=i==null?void 0:i[0],callback:u})=>{if(!h){u==null||u({hasAccess:!1,offerId:""});return}t.current=window.setInterval(async()=>{await s.checkEntitlements(h)?(window.clearInterval(t.current),await s.reloadSubscriptions(),u==null||u({hasAccess:!0,offerId:h||""})):--d===0&&(window.clearInterval(t.current),a(o("payment.longer_than_usual")),u==null||u({hasAccess:!1,offerId:h||""}))},l)},[i,o,s]);return p.useEffect(()=>()=>{window.clearInterval(t.current)},[]),{intervalCheckAccess:c,errorMessage:n}},Bp="_center_153q1_1",Up={center:Bp},Hp=()=>{const{t:s}=T("account"),e=He("offerId")||void 0,t=ue(),n=ae(),a=Ke(),{intervalCheckAccess:o,errorMessage:i}=Mp();return p.useEffect(()=>{o({interval:3e3,iterations:5,offerId:e,callback:({hasAccess:c,offerId:l})=>{c&&(a(s("checkout.payment_success"),"success"),l.startsWith("C")||l.startsWith("P")?n(J(t,null)):n(J(t,"welcome")))}})},[]),r.jsx("div",{className:Up.center,children:i?r.jsx("h2",{children:i}):r.jsxs(r.Fragment,{children:[r.jsx(_s,{}),r.jsx("h2",{children:s("checkout.waiting_for_payment")})]})})},Wp="_title_1edbn_1",Vp="_message_1edbn_8",nc={title:Wp,message:Vp},hr=({type:s,onCloseButtonClick:e})=>{const{t}=T("account"),n=Ke(),a=t(`checkout.upgrade_${s}`),o=t(`checkout.upgrade_${s}_message`);return p.useEffect(()=>{const i={error:"error",success:"succes",pending:"info"}[s];n(o,i)},[n,o,s]),r.jsxs("div",{children:[r.jsx("h2",{className:nc.title,children:a}),r.jsx("p",{className:nc.message,children:o}),r.jsx("div",{children:r.jsx(F,{label:t("checkout.close"),onClick:e,color:"primary",variant:"contained",size:"large",fullWidth:!0})})]})},qp="_formFeedback_173nk_1",zp="_formContainer_173nk_5",Gp="_passwordButtonsContainer_173nk_13",Kp="_buttonsContainer_173nk_21",Jp="_heading_173nk_30",Yp="_paragraph_173nk_40",Qp="_button_173nk_21",ss={formFeedback:qp,formContainer:zp,passwordButtonsContainer:Gp,buttonsContainer:Kp,heading:Jp,paragraph:Yp,button:Qp},Xp=()=>{const s=q(ye),{t:e}=T("user"),t=U(d=>{var h;return(h=d.user)==null?void 0:h.email}),[n,a]=p.useState(),o=ae(),i=ue(),c=p.useCallback(()=>{o(J(i,null),{replace:!0})},[i,o]),l=async()=>{try{t&&(await s.resetPassword(t,""),o(J(i,"add-password")))}catch{a(e("account.add_password_error"))}};return r.jsxs("div",{className:ss.formContainer,children:[n&&r.jsx("div",{className:ss.formFeedback,children:r.jsx(Oe,{variant:"error",children:n})}),r.jsx("h2",{className:ss.heading,children:e("account.delete_account_password_warning.title")}),r.jsx("p",{className:ss.paragraph,children:e("account.delete_account_password_warning.text")}),r.jsxs("div",{className:ss.passwordButtonsContainer,children:[r.jsx(F,{type:"submit",onClick:l,className:ss.button,color:"primary",fullWidth:!0,label:e("account.proceed_to_adding_a_password")}),r.jsx(F,{type:"button",onClick:c,className:ss.button,variant:"text",fullWidth:!0,label:e("account.cancel")})]})]})},fl=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{fill:"currentColor",d:"M20,8H4V6H20M20,18H4V12H20M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z"})),ya=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M7.37083 12.6026c-.70164 0-1.28549-.0571-1.72496-.1142l-1.34375 6.9595H.179688L3.83225.516163C5.08988.201006 7.07827 0 8.97801 0c1.75279 0 3.79949.286619 5.23309 1.28917 1.3172.88839 2.1354 2.23464 2.1354 4.0958 0 2.4344-1.1386 4.26703-2.6901 5.44083-1.6084 1.2333-3.8881 1.7768-6.28557 1.7768zm1.72496-9.30834c-.78902 0-1.34375.05832-1.69457.14393L6.28924 9.13832c.43821.08561.90681.14269 1.60845.14269 2.54311 0 4.20851-1.60433 4.20851-3.52257 0-1.8624-1.3741-2.46418-3.01041-2.46418zm7.22271.21844c.523.18487 1.0195.4169 1.4552.72213 1.3158.88715 2.1353 2.23339 2.1365 4.09456 0 2.43441-1.1398 4.26701-2.69 5.44201-1.6084 1.2321-3.8869 1.7756-6.2856 1.7756-.7016 0-1.28676-.0571-1.72497-.1154l-1.34501 6.9595H3.74219l.31915-1.6577h1.30702l1.34502-6.9582c.4382.057 1.02206.1141 1.72496.1141 2.39746 0 4.67586-.5447 6.28556-1.7755 1.549-1.1738 2.6888-3.00769 2.6888-5.44209 0-1.29909-.4053-2.34258-1.0942-3.15901z"})),Zp="_title_1tanv_1",ef="_success_1tanv_8",tf="_paymentMethodsInputs_1tanv_12",sf="_paymentMethod_1tanv_12",nf="_paymentMethodLabel_1tanv_22",rf="_radio_1tanv_30",Lt={title:Zp,success:ef,paymentMethodsInputs:tf,paymentMethod:sf,paymentMethodLabel:nf,radio:rf},af=({paymentMethodId:s,paymentMethods:e,onCloseButtonClick:t,onPaymentMethodChange:n,renderPaymentMethod:a,submitting:o,updateSuccess:i})=>{const{t:c}=T("account"),l=Ke(),d=e==null?void 0:e.find(u=>u.methodName==="card"),h=e==null?void 0:e.find(u=>u.methodName==="paypal");return p.useEffect(()=>{i&&l(c("checkout.payment_success"),"success")},[i,l,c]),r.jsxs(r.Fragment,{children:[r.jsx("h1",{className:Lt.title,children:c("payment.update_payment_details")}),i?r.jsxs(r.Fragment,{children:[r.jsx("p",{className:Lt.success,children:c("payment.update_payment_success")}),r.jsx(F,{label:c("payment.back_to_profile"),onClick:t,color:"primary",fullWidth:!0})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:Lt.paymentMethodsInputs,children:[d?r.jsxs("div",{className:Lt.paymentMethod,children:[r.jsx("input",{className:Lt.radio,type:"radio",name:"paymentMethod",value:d.id,id:"card",checked:s===d.id,onChange:n}),r.jsxs("label",{className:Lt.paymentMethodLabel,htmlFor:"card",children:[r.jsx(K,{icon:fl}),c("payment.credit_card")]})]}):null,h?r.jsxs("div",{className:Lt.paymentMethod,children:[r.jsx("input",{className:Lt.radio,type:"radio",name:"paymentMethod",value:h.id,id:"paypal",checked:s===h.id,onChange:n}),r.jsxs("label",{className:Lt.paymentMethodLabel,htmlFor:"paypal",children:[r.jsx(K,{icon:ya})," ",c("payment.paypal")]})]}):null]}),r.jsx("div",{children:a?a():null}),o&&r.jsx(Se,{transparentBackground:!0,inline:!0})]})]})},of="_payPal_17v1t_1",cf={payPal:of},gl=({onSubmit:s,error:e})=>{const{t}=T("account");return r.jsxs("div",{className:cf.payPal,children:[e?r.jsx(Oe,{variant:"error",children:e}):null,r.jsx("p",{children:t("checkout.paypal_instructions")}),r.jsx(F,{label:t("checkout.continue"),variant:"contained",color:"primary",size:"large",onClick:s,fullWidth:!0})]})},lf="_adyen_1wab6_1",df="_container_1wab6_5",rc={adyen:lf,container:df},_l=({configuration:s,error:e,type:t})=>{const{t:n}=T("account"),a=p.useRef(null),o=p.useRef();return p.useEffect(()=>!a.current||!s.session?void 0:((async()=>{var l;const c=await Fd(s);a.current&&(o.current=c.create(t),(l=o.current)==null||l.mount(a.current))})(),()=>{var c;(c=o.current)==null||c.unmount()}),[s,t]),r.jsxs("div",{className:rc.adyen,children:[e?r.jsx(Oe,{variant:"error",children:e}):null,r.jsx("div",{className:rc.container,ref:a}),r.jsx(F,{label:n("checkout.continue"),variant:"contained",color:"primary",size:"large",onClick:()=>{o.current&&o.current.submit()},fullWidth:!0})]})};function uf({setProcessing:s,type:e,setPaymentError:t,error:n,paymentMethodId:a}){const o=q(ye),i=q(At),c=o.getSandbox(),{t:l}=T("account"),d=Ke(),h=ae(),u=ue(),[g,_]=p.useState(),f=He("redirectResult"),x=!!f,w=J(u,"payment-method-success"),v=he(async C=>{try{s(!0),await i.finalizeAdyenPaymentDetails({redirectResult:decodeURI(C)},a),await o.reloadSubscriptions({retry:10}),s(!1),d(l("checkout.payment_success"),"success"),h(w)}catch(j){s(!1),j instanceof Error&&(t(j.message),h(J(u,"payment-method"),{replace:!0}))}});p.useEffect(()=>{f&&v(f)},[v,f]),p.useEffect(()=>{if(x)return;(async()=>{s(!0);try{const j=await i.createAdyenPaymentSession(window.origin,!1);_(j)}catch(j){j instanceof Error&&t(j.message)}s(!1)})()},[s,t,x,h,u,i]);const b=p.useCallback(async(C,j)=>{if(C.isValid){try{s(!0),t(void 0);const S=Dt("payment-method",{paymentMethodId:`${a}`}),E=await i.addAdyenPaymentDetails(C.data.paymentMethod,a,S);"action"in E&&j(E.action),await o.reloadSubscriptions({retry:5}),h(w,{replace:!0})}catch(S){S instanceof Error&&t(S.message)}s(!1)}},[h,a,w,t,s,o,i]),y=p.useMemo(()=>({session:g,showPayButton:!1,environment:c?"test":"live",clientKey:c?Bc:Uc,paymentMethodsConfiguration:{card:{hasHolderName:!0,holderNameRequired:!0}},onAdditionalDetails:async C=>{try{s(!0),await i.finalizeAdyenPayment(C.data.details,a),h(w,{replace:!0})}catch(j){j instanceof Error&&(t(j.message),s(!1))}},onSubmit:(C,j)=>b(C,j.handleAction),onError:C=>t(C.message)}),[g,c,s,a,h,w,t,b,i]);return r.jsx(_l,{configuration:y,type:e,error:n})}const hf=({onCloseButtonClick:s})=>{const e=q(At),t=He("u")==="payment-method-success",n=He("paymentMethodId"),a=n?parseInt(n):void 0,o=U(v=>v.activePayment),i=o==null?void 0:o.id,[c,l]=p.useState(void 0),[d,h]=p.useState(a),u=be(v=>v.paymentMethods),[g,_]=p.useState(!1);p.useEffect(()=>{e.getPaymentMethods()},[e]);const f=v=>{const b=parseInt(v.target.value);h(b),l(void 0)},x=async()=>{_(!0);try{l(void 0);const v=Dt("payment-method-success"),b=Dt("waiting-for-payment"),y=Dt("payment-cancelled"),C=Dt("payment-error"),j=await e.updatePayPalPaymentMethod(v,b,y,C,d,i);j&&(window.location.href=j.redirectUrl)}catch(v){v instanceof Error&&l(v.message)}_(!1)},w=()=>{const v=u==null?void 0:u.find(b=>b.id===d);return(v==null?void 0:v.methodName)==="card"?r.jsx(uf,{paymentMethodId:v.id,setPaymentError:l,setProcessing:_,error:c,type:"card"}):(v==null?void 0:v.methodName)==="paypal"?r.jsx(gl,{onSubmit:x,error:c||null}):null};return u?r.jsx(af,{onCloseButtonClick:s,paymentMethods:u,paymentMethodId:d,onPaymentMethodChange:f,renderPaymentMethod:w,updateSuccess:t,submitting:g}):r.jsx("div",{style:{height:300},children:r.jsx(Se,{inline:!0})})},mf="_title_11svw_1",pf="_cancelButton_11svw_7",ac={title:mf,cancelButton:pf},ff=({renderPaymentMethod:s,submitting:e,onCancel:t})=>{const{t:n}=T(["common","user"]);return r.jsxs("div",{children:[r.jsx("div",{className:ac.title,children:r.jsx("h1",{children:n("user:payment.add_card_details")})}),r.jsx("div",{children:s?s():null}),r.jsx(F,{onClick:t,className:ac.cancelButton,fullWidth:!0,label:n("common:confirmation_dialog.close")}),e&&r.jsx(Se,{transparentBackground:!0,inline:!0})]})},yl=({value:s,onChange:e,error:t,...n})=>{const{t:a}=T("user"),o=i=>{const c=i.target.value.replace(/\D+/g,"");e&&(i.target.value=c.slice(0,4),e(i))};return r.jsx(pe,{label:a("payment.security_code"),"aria-label":a("payment.security_code"),...n,error:!!t,helperText:t||null,name:"cardCVC",className:"directPostSecurityCode",type:"text",value:s,onChange:o,pattern:"\\d*",placeholder:"###",autoComplete:"cc-csc",required:!0})},vl=({value:s,onChange:e,error:t,...n})=>{const{t:a}=T("account"),o=i=>{let c=i.target.value.replace(/\D+/g,"");c.length===1?Number(c)>1&&(c="0"+c):c.length===2&&Number(c)>12&&(c="12"),c.length>=3?i.target.value=`${c.slice(0,2)}/${c.slice(2,4)}`:i.target.value=c,e&&e(i)};return r.jsx(pe,{label:a("payment.credit_card_expiry_date"),...n,name:"cardExpiry",className:"directPostExpiryDate",value:s,error:!!t,helperText:t||null,onChange:o,type:"text",pattern:"\\d*",placeholder:"MM/YY",autoComplete:"cc-exp",required:!0})},gf="_cardTypeWrapper_lfmk2_1",_f={cardTypeWrapper:gf},Pn={visa:"/images/payments/visa.svg",mastercard:"/images/payments/mastercard.svg",maestro:"/images/payments/maestro.svg",amex:"/images/payments/amex.svg",discover:"/images/payments/discover.svg",diners:"/images/payments/diners.svg",dinersclub:"/images/payments/diners.svg",unionpay:"/images/payments/unionpay.svg",hiper:"/images/payments/hiper.svg"},xl=({value:s,error:e,onChange:t,onBlur:n,...a})=>{const{t:o}=T("account"),[i,c]=p.useState(null),l=d=>{var _,f;const h=ft.fns.cardType((_=d.target)==null?void 0:_.value),u=(f=d.target)==null?void 0:f.value.replace(/\D+/g,"");let g;switch(c(Pn!=null&&Pn[h]?r.jsx("div",{className:_f.cardTypeWrapper,children:r.jsx("img",{src:Pn[h],alt:h,height:"25"})}):null),h){case"amex":g=`${u.slice(0,4)} ${u.slice(4,10)} ${u.slice(10,15)}`;break;case"dinersclub":g=`${u.slice(0,4)} ${u.slice(4,10)} ${u.slice(10,14)}`;break;default:g=`${u.slice(0,4)} ${u.slice(4,8)} ${u.slice(8,12)} ${u.slice(12,16)}`;break}t&&(d.target.value=g.trim(),t(d))};return r.jsx(pe,{value:s,name:"cardNumber",label:o("payment.credit_card_number"),className:"directPostCreditCardNumber",onChange:l,onBlur:n,error:!!e,helperText:e||null,pattern:"\\d*",...a,type:"text",placeholder:"1234 5678 9012 3456",rightControl:i,autoComplete:"cc-number",required:!0})},yf="_paymentForm_g66uf_1",vf="_columns_g66uf_6",oc={paymentForm:yf,columns:vf},xf=({onCancel:s,setUpdatingCardDetails:e})=>{var d,h,u,g,_,f,x,w;const t=q(ye),n=Ke(),{t:a}=T("account"),{mutate:o,isLoading:i}=dt(t.updateCardDetails),{activePayment:c}=U(({activePayment:v})=>({activePayment:v}),de),l=Tt({initialValues:{cardholderName:"",cardNumber:"",cardExpiry:"",cardCVC:"",cardExpMonth:"",cardExpYear:""},validationSchema:ne().shape({cardholderName:B().required(),cardNumber:B().required().test("card number validation",a("checkout.invalid_card_number"),v=>ft.fns.validateCardNumber(v)),cardExpiry:B().required().test("card expiry validation",a("checkout.invalid_card_expiry"),v=>ft.fns.validateCardExpiry(v)),cardCVC:B().required().test("cvc validation",a("checkout.invalid_cvc_number"),v=>{var y;const b=ft.fns.cardType((y=l==null?void 0:l.values)==null?void 0:y.cardNumber);return ft.fns.validateCardCVC(v,b)}),cardExpMonth:B().required(),cardExpYear:B().required()}),validateOnBlur:!0,onSubmit:async()=>{e(!0),o({cardName:l.values.cardholderName,cardNumber:l.values.cardNumber.replace(/\s+/g,""),cvc:parseInt(l.values.cardCVC),expMonth:parseInt(l.values.cardExpMonth),expYear:parseInt(l.values.cardExpYear),currency:(c==null?void 0:c.currency)||""},{onSettled:()=>s(),onSuccess:()=>{n(a("checkout.card_details_updated"),"success")}})}});return p.useEffect(()=>{if(l.values.cardExpiry){const v=ft.fns.cardExpiryVal(l.values.cardExpiry);v.month&&l.setValue("cardExpMonth",v.month.toString()),v.year&&l.setValue("cardExpYear",v.year.toString())}},[l.values.cardExpiry]),r.jsxs("div",{className:oc.paymentForm,children:[r.jsx("div",{children:r.jsx(pe,{label:a("checkout.card_holder_name"),name:"cardholderName",value:(d=l==null?void 0:l.values)==null?void 0:d.cardholderName,onChange:l==null?void 0:l.handleChange,onBlur:l==null?void 0:l.handleBlur,placeholder:a("checkout.credit_card_name"),autoComplete:"cc-name",required:!0})}),r.jsx("div",{children:r.jsx(xl,{value:(u=(h=l==null?void 0:l.values)==null?void 0:h.cardNumber)==null?void 0:u.toString(),error:(g=l==null?void 0:l.errors)==null?void 0:g.cardNumber,onBlur:l==null?void 0:l.handleBlur,onChange:l==null?void 0:l.handleChange})}),r.jsxs("div",{className:oc.columns,children:[r.jsx("div",{children:r.jsx(vl,{value:(_=l==null?void 0:l.values)==null?void 0:_.cardExpiry,onBlur:l==null?void 0:l.handleBlur,onChange:l==null?void 0:l.handleChange,error:(f=l==null?void 0:l.errors)==null?void 0:f.cardExpiry})}),r.jsx("div",{children:r.jsx(yl,{value:(x=l==null?void 0:l.values)==null?void 0:x.cardCVC,onBlur:l==null?void 0:l.handleBlur,onChange:l==null?void 0:l.handleChange,error:(w=l==null?void 0:l.errors)==null?void 0:w.cardCVC})})]}),r.jsx("div",{children:r.jsx(F,{disabled:i,label:a("checkout.save"),variant:"contained",onClick:l.handleSubmit,type:"submit",color:"primary",size:"large",fullWidth:!0})})]})},wf=()=>{const s=ue(),e=ae(),[t,n]=p.useState(!1),a=()=>{e(J(s,null),{replace:!1})},o=()=>r.jsx(xf,{onCancel:a,setUpdatingCardDetails:n});return r.jsx(ff,{onCancel:a,renderPaymentMethod:o,submitting:t})},bf="_title_n9dff_1",Sf="_text_n9dff_7",jf="_button_n9dff_12",Cf="_link_n9dff_16",Pf="_textField_n9dff_17",Ef="_paragraph_n9dff_21",kf="_resendLink_n9dff_31",Qs={title:bf,text:Sf,button:jf,link:Cf,textField:Pf,paragraph:Ef,resendLink:kf},If=({onSubmit:s,onChange:e,onBlur:t,showOldPasswordField:n,showResetTokenField:a,value:o,errors:i,submitting:c,validationError:l,email:d,onResendEmailClick:h})=>{const{t:u}=T(["account","user"]);return r.jsxs("form",{onSubmit:s,"data-testid":void 0,noValidate:!0,children:[i.form&&r.jsx(Oe,{variant:"error",visible:!l,children:i.form}),r.jsx("h2",{className:Qs.title,children:u(n&&a?"user:account.add_password":"reset.password_reset")}),n&&a&&r.jsxs("p",{className:Qs.paragraph,children:[u("user:account.add_password_modal_text",{email:d}),r.jsx("a",{className:Qs.resendLink,onClick:h,children:u("user:account.resend_mail")})]}),n&&!a&&r.jsx(an,{value:o.oldPassword,onChange:e,onBlur:t,label:u("reset.old_password"),placeholder:u("reset.old_password"),error:!!i.oldPassword,name:"oldPassword",showToggleView:!1,showHelperText:!1,autoComplete:"current-password",required:!0}),a&&r.jsx(pe,{className:Qs.textField,value:o.resetPasswordToken||"",onChange:e,onBlur:t,label:u("reset.reset_password_token"),placeholder:u("reset.reset_password_token"),name:"resetPasswordToken",type:"text",autoComplete:"",required:!0}),r.jsx(an,{value:o.password,onChange:e,onBlur:t,label:u("reset.new_password"),placeholder:u("reset.password"),error:!!i.password,name:"password",autoComplete:"new-password",required:!0}),r.jsx(an,{value:o.passwordConfirmation,onChange:e,onBlur:t,label:u("reset.repeat_new_password"),placeholder:u("reset.repeat_new_password"),error:!!i.passwordConfirmation,name:"passwordConfirmation",autoComplete:"new-password",showHelperText:!1,required:!0}),r.jsx(F,{type:"submit",className:Qs.button,fullWidth:!0,color:"primary",disabled:c,label:u("reset.confirm")}),c&&r.jsx(Se,{transparentBackground:!0,inline:!0})]})},ic=({type:s})=>{const e=q(ye),{t}=T("account"),n=Ke(),a=ue(),o=ae(),i=He("resetPasswordToken"),c=He("email"),l=U(_=>{var f;return(f=_.user)==null?void 0:f.email}),d=U.getState().user,h=async(_,{setErrors:f,setSubmitting:x})=>{const{oldPassword:w,password:v,passwordConfirmation:b,resetPasswordToken:y}=_;if(v!==b)return f({form:t("reset.passwords_do_not_match")}),x(!1);let C=i;y&&(C=y);try{if(d&&!C)await e.changePasswordWithOldPassword(w||"",v,b);else{if(!C)return f({form:t("reset.invalid_link")}),x(!1);await e.changePasswordWithToken(c||"",v,C,b)}n(t("reset.password_reset_success"),"success"),await e.logout(),o(J(a,"login"))}catch(j){j instanceof Error&&(j.message.includes("invalid param password")?f({password:t("reset.invalid_password")}):j.message.includes("resetPasswordToken is not valid")?f({form:t("reset.invalid_reset_link")}):j.message.includes("score does not match standards")?f({form:t("reset.password_strength")}):j.message.includes("old password does not match")?f({form:t("reset.old_password_does_not_match")}):j.message.includes("password could not be set")&&f({form:t("reset.invalid_token")}))}x(!1)},u=Tt({initialValues:{password:"",passwordConfirmation:""},validationSchema:ne().shape({email:B(),oldPassword:B(),password:B().matches(/^(?=.*[a-z])(?=.*[0-9]).{8,}$/,t("registration.invalid_password")).required(t("login.field_required",{field:t("login.password")})),passwordConfirmation:B().required(),resetPasswordToken:B()}),validateOnBlur:!0,onSubmit:h}),g=async()=>{try{l&&await e.resetPassword(l,"")}catch{u.setErrors({form:t("user:account.resend_mail_error")})}};return r.jsx(If,{value:u.values,submitting:u.submitting,onChange:u.handleChange,onBlur:u.handleBlur,errors:u.errors,onSubmit:u.handleSubmit,validationError:u.validationSchemaError,showOldPasswordField:!!(d&&!i),showResetTokenField:s==="add"||!d&&!i,email:c||l,onResendEmailClick:g})},Af="_title_9xp06_1",Tf="_infoBox_9xp06_7",Nf="_price_9xp06_23",Lf="_confirmButton_9xp06_32",Xs={title:Af,infoBox:Tf,price:Nf,confirmButton:Lf},$f=({subscription:s,customer:e,error:t,submitting:n,onConfirm:a,onClose:o})=>{const{t:i,i18n:c}=T("account");return r.jsxs("div",{children:[t?r.jsx(Oe,{variant:"error",children:t}):null,r.jsx("h2",{className:Xs.title,children:i("renew_subscription.renew_your_subscription")}),r.jsx("p",{className:Xs.paragraph,children:i("renew_subscription.explanation")}),r.jsxs("div",{className:Xs.infoBox,children:[r.jsxs("p",{children:[r.jsx("strong",{children:s.offerTitle})," ",r.jsx("br",{}),i("renew_subscription.next_billing_date_on",{date:Pt(new Date(s.expiresAt*1e3),c.language)})]}),r.jsxs("p",{className:Xs.price,children:[r.jsx("strong",{children:lt(s.nextPaymentPrice,s.nextPaymentCurrency,e.country)}),r.jsxs("small",{children:["/",i(`periods.${s.period}`)]})]})]}),r.jsx(F,{className:Xs.confirmButton,color:"primary",variant:"contained",label:i("renew_subscription.renew_subscription"),onClick:a,fullWidth:!0,disabled:n,type:"submit"}),r.jsx(F,{label:i("renew_subscription.no_thanks"),onClick:o,fullWidth:!0})]})},Rf="_title_1o843_1",cc={title:Rf},Of=({onClose:s,customer:e,subscription:t})=>{const{t:n,i18n:a}=T("account"),o=Pt(new Date(t.expiresAt*1e3),a.language),i=lt(t.nextPaymentPrice,t.nextPaymentCurrency,e.country);return r.jsxs("div",{children:[r.jsx("h2",{className:cc.title,children:n("subscription_renewed.title")}),r.jsx("p",{className:cc.paragraph,children:n("subscription_renewed.message",{date:o,price:i})}),r.jsx(F,{label:n("subscription_renewed.back_to_profile"),onClick:s,fullWidth:!0})]})},Df=()=>{const s=q(ye),e=ae(),t=ue(),{t:n}=T("account"),a=Ke(),{subscription:o,user:i}=U(({subscription:x,user:w})=>({subscription:x,user:w}),de),[c,l]=p.useState(!1),[d,h]=p.useState(!1),[u,g]=p.useState(null),_=async()=>{h(!0),g(null);try{await s.updateSubscription("active"),a(n("renew_subscription.success"),"success"),l(!0)}catch{g(n("renew_subscription.unknown_error_occurred"))}h(!1)},f=()=>{e(J(t,null),{replace:!0})};return!o||!i?null:r.jsxs(Te.Fragment,{children:[c?r.jsx(Of,{onClose:f,subscription:o,customer:i}):r.jsx($f,{subscription:o,customer:i,error:u,onConfirm:_,onClose:f,submitting:d}),d?r.jsx(Se,{inline:!0}):null]})},Ff="_title_feuiy_1",Mf="_confirmButton_feuiy_7",mr={title:Ff,confirmButton:Mf},Bf=({onConfirm:s,onCancel:e,error:t,submitting:n})=>{const{t:a}=T("account");return r.jsxs("div",{children:[t?r.jsx(Oe,{variant:"error",children:t}):null,r.jsx("h2",{className:mr.title,children:a("cancel_subscription.title")}),r.jsx("p",{className:mr.paragraph,children:a("cancel_subscription.explanation")}),r.jsx(F,{className:mr.confirmButton,label:a("cancel_subscription.unsubscribe"),color:"primary",variant:"contained",onClick:s,fullWidth:!0,disabled:n,type:"submit"}),r.jsx(F,{label:a("cancel_subscription.no_thanks"),variant:"outlined",onClick:e,fullWidth:!0})]})},Uf="_title_od1i3_1",pr={title:Uf},Hf=({expiresDate:s,onClose:e})=>{const{t}=T("account");return r.jsxs("div",{className:pr.SubscriptionCancelled,children:[r.jsx("h2",{className:pr.title,children:t("subscription_cancelled.title")}),r.jsx("p",{className:pr.paragraph,children:t("subscription_cancelled.message",{date:s})}),r.jsx(F,{label:t("subscription_cancelled.return_to_profile"),variant:"outlined",onClick:e,fullWidth:!0})]})},Wf=()=>{const s=q(ye),{t:e,i18n:t}=T("account"),n=Ke(),a=ae(),o=ue(),i=U(w=>w.subscription),[c,l]=p.useState(!1),[d,h]=p.useState(!1),[u,g]=p.useState(null),_=i!=null&&i.expiresAt?Pt(new Date(i.expiresAt*1e3),t.language):"",f=async()=>{h(!0),g(null);try{await s.updateSubscription("cancelled"),_&&n(e("subscription_cancelled.message",{date:_}),"success"),l(!0)}catch{g(e("cancel_subscription.unknown_error_occurred"))}h(!1)},x=()=>{a(J(o,null),{replace:!0})};return i?r.jsxs(Te.Fragment,{children:[c?r.jsx(Hf,{expiresDate:_,onClose:x}):r.jsx(Bf,{onConfirm:f,onCancel:x,submitting:d,error:u}),d?r.jsx(Se,{transparentBackground:!0,inline:!0}):null]}):null},Vf="_title_173ks_1",qf="_text_173ks_7",zf="_button_173ks_12",fr={title:Vf,text:qf,button:zf},Gf=({onCancel:s,onReset:e,submitting:t})=>{const{t:n}=T("account");return r.jsxs("div",{children:[r.jsx("h1",{className:fr.title,children:n("reset.reset_password")}),r.jsx("p",{className:fr.text,children:n("reset.text")}),r.jsx(F,{onClick:e,className:fr.button,fullWidth:!0,color:"primary",label:n("reset.yes"),type:"submit",disabled:t}),r.jsx(F,{onClick:s,fullWidth:!0,label:n("reset.no")})]})},Kf="_title_17xro_1",Jf="_text_17xro_7",Yf="_button_17xro_12",gr={title:Kf,text:Jf,button:Yf},Qf=({onSubmit:s,onChange:e,value:t,errors:n,submitting:a,onBlur:o})=>{const{t:i}=T("account");return r.jsxs("form",{onSubmit:s,"data-testid":void 0,noValidate:!0,children:[r.jsx("h2",{className:gr.title,children:i("reset.forgot_password")}),n.form?r.jsx(Oe,{variant:"error",children:n.form}):null,r.jsx("p",{className:gr.text,children:i("reset.forgot_text")}),r.jsx(pe,{value:t.email,onChange:e,onBlur:o,label:i("reset.email"),placeholder:i("reset.email"),error:!!n.email||!!n.form,helperText:n.email,name:"email",type:"email",autoComplete:"email",required:!0}),r.jsx(F,{type:"submit",className:gr.button,fullWidth:!0,color:"primary",disabled:a,label:i("reset.email_me")})]})},Xf="_title_v7vet_1",Zf="_text_v7vet_7",eg="_button_v7vet_12",tg="_notSure_v7vet_16",sg="_link_v7vet_20",ks={title:Xf,text:Zf,button:eg,notSure:tg,link:sg},ng=({email:s,onBackToLogin:e,loggedIn:t})=>{const{t:n}=T("account"),a=ue();return r.jsxs("div",{className:ks.forgotPasswordForm,children:[r.jsx("h2",{className:ks.title,children:n("reset.link_sent")}),r.jsx("p",{className:ks.text,children:n("reset.link_sent_text",{email:s})}),r.jsx(F,{onClick:e,className:ks.button,fullWidth:!0,color:"primary",label:n("reset.back_login")}),!t&&r.jsxs(Te.Fragment,{children:[r.jsx("span",{className:ks.notSure,children:n("reset.not_sure")}),r.jsx(un,{className:ks.link,to:J(a,"forgot-password"),children:n("reset.try_again")})]})]})},_r=({type:s})=>{const e=q(ye),{t}=T("account"),n=ae(),a=ue(),[o,i]=p.useState(!1),{canChangePasswordWithOldPassword:c}=e.getFeatures(),{customer:l}=U(({user:f})=>({customer:f}),de),d=()=>{n(J(a,null))},h=async()=>{n({pathname:"/",search:"u=login"},{replace:!0}),l&&await e.logout()},u=async()=>{const f=`${W.APP_PUBLIC_URL}/?u=edit-password`;try{if(!(l!=null&&l.email)){Ot("ResetPassword","invalid param email");return}i(!0),await e.resetPassword(l.email,f),i(!1),n(J(a,"send-confirmation"))}catch(x){Ue("ResetPassword","Failed to reset password",{error:x})}},g=async(f,{setErrors:x,setSubmitting:w})=>{const v=`${W.APP_PUBLIC_URL}/?u=edit-password`;try{await e.resetPassword(f.email,v),n(J(a,c?"edit-password":"send-confirmation"))}catch(b){b instanceof Error&&(b.message.toLowerCase().includes("invalid param email")?x({email:t("reset.wrong_email")}):x({form:b.message}))}w(!1)},_=Tt({initialValues:{email:""},validationSchema:ne().shape({email:B().email(t("login.field_is_not_valid_email")).required(t("login.field_required",{field:t("login.email")}))}),validateOnBlur:!0,onSubmit:g});return r.jsxs(Te.Fragment,{children:[s==="reset"&&r.jsx(Gf,{submitting:o,onCancel:d,onReset:u}),s==="forgot"&&r.jsx(Qf,{value:_.values,submitting:_.submitting,onChange:_.handleChange,errors:_.errors,onSubmit:_.handleSubmit,onBlur:_.handleBlur}),s==="confirmation"&&r.jsx(ng,{loggedIn:!!l,email:(l==null?void 0:l.email)||_.values.email,onBackToLogin:h}),(_.submitting||o)&&r.jsx(Se,{transparentBackground:!0,inline:!0})]})},rg=({onUpdateOrderSuccess:s,onSubmitPaymentWithoutDetailsSuccess:e,onSubmitPaypalPaymentSuccess:t,onSubmitStripePaymentSuccess:n})=>{const a=q(ye),o=q(At),{order:i,selectedOffer:c,paymentMethods:l,setOrder:d}=be(({order:v,selectedOffer:b,paymentMethods:y,setOrder:C})=>({order:v,selectedOffer:b,paymentMethods:y,setOrder:C})),h=c&&ua(c)?"svod":"tvod",u=dt({mutationKey:["initialiseOrder"],mutationFn:async({offer:v})=>!!v&&o.initialiseOrder(v)}),g=dt({mutationKey:["updateOrder"],mutationFn:async({paymentMethodId:v,couponCode:b})=>{if(!(!i||!v))return await o.updateOrder(i,v,b)},onSuccess:s}),_=dt({mutationKey:["submitPaymentWithoutDetails"],mutationFn:o.paymentWithoutDetails,onSuccess:async()=>{await a.reloadSubscriptions({retry:10}),e()}}),f=dt({mutationKey:["submitPaymentPaypal"],mutationFn:o.paypalPayment,onSuccess:t}),x=dt({mutationKey:["submitPaymentStripe"],mutationFn:o.directPostCardPayment,onSuccess:n});p.useEffect(()=>{c&&!i&&!u.isLoading&&!u.isError&&u.mutate({offer:c})},[c,i,u]),p.useEffect(()=>()=>d(null),[d]);const w=u.isLoading||g.isLoading||_.isLoading||f.isLoading||x.isLoading;return{selectedOffer:c,offerType:h,paymentMethods:l,order:i,isSubmitting:w,updateOrder:g,submitPaymentWithoutDetails:_,submitPaymentPaypal:f,submitPaymentStripe:x}},wl=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"})),ag="_dialogBackButton_1pa6f_1",og={dialogBackButton:ag},bl=({onClick:s})=>{const{t:e}=T();return r.jsx(Ge,{onClick:s,className:og.dialogBackButton,"aria-label":e("common:back"),children:r.jsx(K,{icon:wl})})},ig="_captcha_q1ooa_1",cg={captcha:ig},Sl=p.forwardRef(({siteKey:s},e)=>r.jsx("div",{className:cg.captcha,children:r.jsx(Md,{ref:e,sitekey:s,size:"invisible",badge:"inline",theme:"dark"})})),lg="_backButton_1xlk4_1",dg="_title_1xlk4_7",ug="_order_1xlk4_13",hg="_orderTitle_1xlk4_22",mg="_orderTitleMargin_1xlk4_28",pg="_orderBillingDate_1xlk4_32",fg="_orderInfo_1xlk4_37",gg="_orderPrice_1xlk4_41",_g="_couponForm_1xlk4_54",yg="_redeemCoupon_1xlk4_59",vg="_couponInput_1xlk4_66",xg="_orderTotals_1xlk4_84",wg="_couponCell_1xlk4_96",bg="_divider_1xlk4_113",Sg="_paymentMethods_1xlk4_118",jg="_paymentMethod_1xlk4_118",Cg="_paymentMethodLabel_1xlk4_127",Pg="_radio_1xlk4_135",Eg="_noPaymentNeeded_1xlk4_170",ke={backButton:lg,title:dg,order:ug,orderTitle:hg,orderTitleMargin:mg,orderBillingDate:pg,orderInfo:fg,orderPrice:gg,couponForm:_g,redeemCoupon:yg,couponInput:vg,orderTotals:xg,couponCell:wg,divider:bg,paymentMethods:Sg,paymentMethod:jg,paymentMethodLabel:Cg,radio:Pg,noPaymentNeeded:Eg},kg=({paymentMethodId:s,paymentMethods:e,order:t,offer:n,offerType:a,onBackButtonClick:o,onPaymentMethodChange:i,error:c,couponFormOpen:l,couponInputValue:d,couponFormError:h,couponFormApplied:u,couponFormSubmitting:g,onCouponInputChange:_,onCloseCouponFormClick:f,onCouponFormSubmit:x,onRedeemCouponButtonClick:w,children:v,submitting:b,captchaSiteKey:y,recaptchaRef:C})=>{var $,L,D,O,I,H,X;const{t:j}=T("account"),S=()=>n?j(`periods.${n.period}`):"",E=ee=>{if(ee.freeDays)return j("checkout.days_trial",{count:ee.freeDays});if(ee.freePeriods){const Q=j(`periods.${ee.period}`,{count:ee.freePeriods});return j("checkout.periods_trial",{count:ee.freePeriods,period:Q})}return null},P=e==null?void 0:e.find(ee=>ee.methodName==="card"),k=e==null?void 0:e.find(ee=>ee.methodName==="paypal"),A=a==="svod"?n.period==="month"?j("checkout.monthly"):j("checkout.yearly"):n.offerTitle;return r.jsxs("div",{children:[c?r.jsx(Oe,{variant:"error",children:c}):null,r.jsx("h1",{className:ke.title,children:j("checkout.payment_method")}),r.jsxs("div",{className:ke.order,children:[r.jsxs("div",{className:ke.orderInfo,children:[r.jsx("p",{className:M(ke.orderTitle,{[ke.orderTitleMargin]:a==="svod"}),children:A}),(($=t.discount)==null?void 0:$.type)==="trial"?r.jsx("p",{className:ke.orderBillingDate,children:E(n)}):null]}),r.jsxs("div",{className:ke.orderPrice,children:[r.jsx("span",{children:lt(n.customerPriceInclTax,t.currency,n.customerCountry)}),a==="svod"&&r.jsxs("small",{children:["/",S()]})]})]}),r.jsx("div",{className:ke.couponForm,children:l?r.jsxs("form",{onSubmit:x,noValidate:!0,children:[r.jsxs("div",{className:ke.redeemCoupon,children:[r.jsx(Ge,{"aria-label":"Close coupon form",onClick:f,children:r.jsx(K,{icon:Yn})}),r.jsx("input",{className:ke.couponInput,name:"couponCode",type:"text",placeholder:"Coupon code",value:d,onChange:_}),r.jsx(F,{variant:"outlined",label:"Apply",type:"submit",disabled:g})]}),h?r.jsx(Oe,{variant:"error",children:h}):null,u?r.jsx(Oe,{variant:"success",children:j("checkout.coupon_applied")}):null]}):r.jsx(F,{variant:"outlined",label:j("checkout.redeem_coupon"),onClick:w})}),r.jsx("div",{children:r.jsxs("table",{className:ke.orderTotals,children:[r.jsxs("tbody",{children:[(L=t.discount)!=null&&L.applied&&((D=t.discount)==null?void 0:D.type)==="coupon"?r.jsxs("tr",{children:[r.jsxs("td",{className:ke.couponCell,children:[j("checkout.coupon_discount"),r.jsx("br",{}),!!n.period&&a==="svod"&&r.jsx("small",{children:j("checkout.discount_period",{count:(O=t.discount)==null?void 0:O.periods,period:j(`periods.${n.period}`,{count:(I=t.discount)==null?void 0:I.periods})})})]}),r.jsx("td",{children:lt(-t.priceBreakdown.discountAmount*(1+t.taxRate),t.currency,n.customerCountry)})]}):null,(H=t.discount)!=null&&H.applied&&((X=t.discount)==null?void 0:X.type)==="trial"?r.jsxs("tr",{children:[r.jsx("td",{className:ke.couponCell,children:j("checkout.free_trial_discount")}),r.jsx("td",{children:lt(-n.customerPriceInclTax,t.currency,n.customerCountry)})]}):null,t.priceBreakdown.paymentMethodFee>0&&r.jsxs("tr",{children:[r.jsx("td",{children:j("checkout.payment_method_fee")}),r.jsx("td",{children:lt(t.priceBreakdown.paymentMethodFee,t.currency,n.customerCountry)})]})]}),r.jsxs("tfoot",{children:[r.jsxs("tr",{children:[r.jsx("td",{children:j("checkout.total_price")}),r.jsx("td",{children:lt(t.totalPrice,t.currency,n.customerCountry)})]}),t.priceBreakdown.taxValue>0&&r.jsxs("tr",{children:[r.jsx("td",{children:j("checkout.applicable_tax",{taxRate:Math.round(t.taxRate*100)})}),r.jsx("td",{children:lt(t.priceBreakdown.taxValue,t.currency,n.customerCountry)})]})]})]})}),!!y&&r.jsx(Sl,{siteKey:y,ref:C}),r.jsx("hr",{className:ke.divider}),t.requiredPaymentDetails?r.jsxs("div",{className:ke.paymentMethods,children:[P?r.jsxs("div",{className:ke.paymentMethod,children:[r.jsx("input",{className:ke.radio,type:"radio",name:"paymentMethodId",value:P.id,id:"card",checked:s===P.id.toString(),onChange:i}),r.jsxs("label",{className:ke.paymentMethodLabel,htmlFor:"card",children:[r.jsx(K,{icon:fl})," ",j("checkout.credit_card")]})]}):null,k?r.jsxs("div",{className:ke.paymentMethod,children:[r.jsx("input",{className:ke.radio,type:"radio",name:"paymentMethodId",value:k.id,id:"paypal",checked:s===k.id.toString(),onChange:i}),r.jsxs("label",{className:ke.paymentMethodLabel,htmlFor:"paypal",children:[r.jsx(K,{icon:ya})," ",j("checkout.paypal")]})]}):null]}):null,v?r.jsx("div",{children:v}):null,b&&r.jsx(Se,{transparentBackground:!0,inline:!0}),r.jsx(bl,{onClick:o})]})},Ig="_noPaymentRequired_170kq_1",Ag={noPaymentRequired:Ig},Tg=({onSubmit:s,error:e})=>{const{t}=T("account");return r.jsxs("div",{className:Ag.noPaymentRequired,children:[e?r.jsx(Oe,{variant:"error",children:e}):null,r.jsx("p",{children:t("checkout.no_payment_needed")}),r.jsx(F,{label:t("checkout.continue"),variant:"contained",color:"primary",size:"large",onClick:s,fullWidth:!0})]})},Ng="_paymentForm_1nfvx_1",Lg="_columns_1nfvx_6",$g="_formError_1nfvx_13",yr={paymentForm:Ng,columns:Lg,formError:$g},Rg=({onPaymentFormSubmit:s})=>{const{t:e}=T("account"),{values:t,errors:n,setValue:a,handleChange:o,handleBlur:i,handleSubmit:c}=Tt({initialValues:{cardholderName:"",cardNumber:"",cardExpiry:"",cardCVC:"",cardExpMonth:"",cardExpYear:""},validationSchema:ne().required().shape({cardholderName:B().required(),cardNumber:B().required().test("card number validation",e("checkout.invalid_card_number"),l=>ft.fns.validateCardNumber(l)),cardExpiry:B().required().test("card expiry validation",e("checkout.invalid_card_expiry"),l=>ft.fns.validateCardExpiry(l)),cardCVC:B().required().test("cvc validation",e("checkout.invalid_cvc_number"),(l,d)=>{const h=ft.fns.cardType(d.parent.cardNumber);return ft.fns.validateCardCVC(l,h)}),cardExpMonth:B().required(),cardExpYear:B().required()}),validateOnBlur:!0,onSubmit:s});return p.useEffect(()=>{if(t.cardExpiry){const l=ft.fns.cardExpiryVal(t.cardExpiry);l.month&&a("cardExpMonth",l.month.toString()),l.year&&a("cardExpYear",l.year.toString())}},[t.cardExpiry]),r.jsx("div",{className:yr.paymentForm,children:r.jsxs("form",{onSubmit:c,"data-testid":void 0,noValidate:!0,children:[n.form?r.jsx("div",{className:yr.formError,children:r.jsx(Oe,{variant:"error",children:n.form})}):null,r.jsx("div",{children:r.jsx(pe,{label:e("checkout.card_holder_name"),name:"cardholderName",value:t.cardholderName,onChange:o,onBlur:i,placeholder:e("checkout.credit_card_name"),autoComplete:"cc-name",required:!0})}),r.jsx("div",{children:r.jsx(xl,{value:t.cardNumber.toString(),error:n.cardNumber,onBlur:i,onChange:o})}),r.jsxs("div",{className:yr.columns,children:[r.jsx("div",{children:r.jsx(vl,{value:t.cardExpiry,onBlur:i,onChange:o,error:n.cardExpiry})}),r.jsx("div",{children:r.jsx(yl,{value:t.cardCVC,onBlur:i,onChange:o,error:n.cardCVC})})]}),r.jsx("div",{children:r.jsx(F,{label:e("checkout.continue"),variant:"contained",color:"primary",type:"submit",size:"large",fullWidth:!0})})]})})};function Og({setUpdatingOrder:s,type:e,paymentSuccessUrl:t,orderId:n,getCaptchaValue:a}){const o=q(ye),i=q(At),{t:c}=T(["account","error"]),l=Ke(),[d,h]=p.useState(),[u,g]=p.useState(),_=o.getSandbox(),f=ae();p.useEffect(()=>{(async()=>{s(!0);try{const b=await i.createAdyenPaymentSession(window.origin);g(b)}catch(b){b instanceof Error&&h(b.message)}s(!1)})()},[s,i]);const x=p.useCallback(async(v,b)=>{if(v.isValid){try{if(s(!0),h(void 0),n===void 0){h(c("error:adyen_order_unknown"));return}const y=await a(),C=Ie(window.location.href,{u:"finalize-payment",orderId:n}),j=await i.initialAdyenPayment(v.data.paymentMethod,C,y);"action"in j&&b(j.action),await o.reloadSubscriptions({retry:10}),l(c("account:checkout.payment_success"),"success"),f(t,{replace:!0})}catch(y){y instanceof Error&&h(y.message)}s(!1)}},[s,n,i,o,l,c,f,t,a]),w=p.useMemo(()=>({session:u,showPayButton:!1,environment:_?"test":"live",clientKey:_?Bc:Uc,paymentMethodsConfiguration:{card:{hasHolderName:!0,holderNameRequired:!0}},onAdditionalDetails:async v=>{try{s(!0);const b=v.data.details;await i.finalizeAdyenPayment(n,b),l(c("account:checkout.payment_success"),"success"),f(t,{replace:!0})}catch(b){b instanceof Error&&(h(b.message),s(!1))}},onSubmit:(v,b)=>x(v,b.handleAction),onError:v=>h(v.message)}),[u,_,s,i,n,l,c,f,t,x]);return r.jsx(_l,{configuration:w,type:e,error:d})}const jl=()=>{const s=p.useRef(null),e=G(({config:n})=>{var a,o;return(a=n.custom)!=null&&a.captchaSiteKey?(o=n.custom)==null?void 0:o.captchaSiteKey:void 0}),t=he(async()=>{var n;return e&&await((n=s.current)==null?void 0:n.executeAsync())||void 0});return{recaptchaRef:s,captchaSiteKey:e,getCaptchaValue:t}},Dg=()=>{var ce,ve;const s=ue(),e=ae(),[t,n]=p.useState(!1),[a,o]=p.useState(!1),[i,c]=p.useState(!1),{t:l}=T("account"),d=Ke(),h=J(s,"choose-offer"),u=J(s,"welcome"),g=J(s,null),{recaptchaRef:_,captchaSiteKey:f,getCaptchaValue:x}=jl(),w=()=>e(h),{selectedOffer:v,offerType:b,paymentMethods:y,order:C,isSubmitting:j,updateOrder:S,submitPaymentWithoutDetails:E,submitPaymentPaypal:P,submitPaymentStripe:k}=rg({onUpdateOrderSuccess:()=>!!A&&c(!0),onSubmitPaymentWithoutDetailsSuccess:()=>(d(l("checkout.payment_success"),"success"),e(b==="svod"?u:g,{replace:!0})),onSubmitPaypalPaymentSuccess:({redirectUrl:V})=>{window.location.href=V},onSubmitStripePaymentSuccess:()=>e(J(s,"waiting-for-payment"),{replace:!0})}),{values:{couponCode:A,paymentMethodId:$},setValue:L,submitting:D,errors:O,handleChange:I,handleSubmit:H}=Tt({initialValues:{couponCode:"",paymentMethodId:zr(y)},onSubmit:({couponCode:V,paymentMethodId:oe})=>(c(!1),S.mutateAsync({couponCode:V,paymentMethodId:parseInt(oe)})),onSubmitSuccess:({couponCode:V})=>c(!!V),onSubmitError:({error:V})=>{var oe;V instanceof Ze&&((oe=V.errors.order)!=null&&oe.includes(`Order with id ${C==null?void 0:C.id} not found`))&&e(J(s,"choose-offer"),{replace:!0})}}),X=V=>{I(V),S.mutateAsync({couponCode:A,paymentMethodId:parseInt(V.target.value)})};if(p.useEffect(()=>{if(!v)return e(h,{replace:!0})},[e,h,v]),p.useEffect(()=>{y!=null&&y.length&&L("paymentMethodId",zr(y))},[y,L]),p.useEffect(()=>()=>c(!1),[]),!v||!C||!y||!b)return r.jsx("div",{style:{height:300},children:r.jsx(Se,{inline:!0})});const ee=Dt("payment-cancelled"),Q=Dt("waiting-for-payment",{offerId:v==null?void 0:v.offerId}),N=Dt("payment-error"),R=b==="svod"?Q:Ie(window.location.href,{u:""}),Y=window.location.href,z=y==null?void 0:y.find(V=>V.id===parseInt($)),re=!(C!=null&&C.requiredPaymentDetails),$e=(z==null?void 0:z.methodName)==="card"&&(z==null?void 0:z.provider)==="stripe",me=(z==null?void 0:z.methodName)==="card"&&(z==null?void 0:z.paymentGateway)==="adyen",je=(z==null?void 0:z.methodName)==="paypal";return r.jsxs(kg,{order:C,offer:v,offerType:b,error:O.form,onBackButtonClick:w,paymentMethods:y,paymentMethodId:$,onPaymentMethodChange:X,onCouponFormSubmit:H,onCouponInputChange:I,onRedeemCouponButtonClick:()=>o(!0),onCloseCouponFormClick:()=>o(!1),couponInputValue:A,couponFormOpen:a,couponFormApplied:i,couponFormSubmitting:D,couponFormError:O.couponCode,submitting:j||t,captchaSiteKey:f,recaptchaRef:_,children:[re&&r.jsx(Tg,{onSubmit:async()=>{const V=await x();return E.mutateAsync({captchaValue:V})},error:((ce=E.error)==null?void 0:ce.message)||null}),$e&&r.jsx(Rg,{onPaymentFormSubmit:async V=>await k.mutateAsync({cardPaymentPayload:V,referrer:Y,returnUrl:Q})}),me&&r.jsx(r.Fragment,{children:r.jsx(Og,{paymentSuccessUrl:b==="svod"?u:g,setUpdatingOrder:n,orderId:C.id,type:"card",getCaptchaValue:x})}),je&&r.jsx(gl,{onSubmit:async()=>{const V=await x();P.mutate({successUrl:R,waitingUrl:Q,cancelUrl:ee,errorUrl:N,couponCode:A,captchaValue:V})},error:((ve=P.error)==null?void 0:ve.message)||null})]})},va=()=>{const s=q(At),e=q(ye),{mediaOffers:t,subscriptionOffers:n,switchSubscriptionOffers:a,requestedMediaOffers:o}=be(({mediaOffers:f,subscriptionOffers:x,switchSubscriptionOffers:w,requestedMediaOffers:v})=>({mediaOffers:f,subscriptionOffers:x,switchSubscriptionOffers:w,requestedMediaOffers:v}),de),{isLoading:i}=We({queryKey:["initialiseOffers",o],queryFn:s.initialiseOffers}),c=dt({mutationKey:["chooseOffer"],mutationFn:s.chooseOffer}),l=dt({mutationKey:["switchSubscription"],mutationFn:s.switchSubscription,onSuccess:()=>e.reloadSubscriptions({delay:3e3,retry:10})}),d=t.length>0,h=n.length>0,u=o.some(f=>f.premier),g=(n.length>0||a.length>0)&&d&&!u,_=u||!h?"tvod":"svod";return{isLoading:i||c.isLoading,mediaOffers:t,subscriptionOffers:n,switchSubscriptionOffers:a,chooseOffer:c,switchSubscription:l,hasMultipleOfferTypes:g,defaultOfferType:_}},vr=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M10 17L5 12L6.41 10.59L10 14.17L17.59 6.58L19 8L10 17Z"})),Fg="_title_1h3nw_1",Mg="_subtitle_1h3nw_7",Bg="_offerGroupSwitch_1h3nw_13",Ug="_label_1h3nw_19",Hg="_offers_1h3nw_24",Wg="_offer_1h3nw_13",Vg="_radio_1h3nw_41",qg="_offerGroupLabel_1h3nw_68",zg="_offerTitle_1h3nw_80",Gg="_offerDivider_1h3nw_86",Kg="_offerBenefits_1h3nw_93",Jg="_fill_1h3nw_114",Yg="_offerPrice_1h3nw_118",De={title:Fg,subtitle:Mg,offerGroupSwitch:Bg,label:Ug,offers:Hg,offer:Wg,radio:Vg,offerGroupLabel:qg,offerTitle:zg,offerDivider:Gg,offerBenefits:Kg,fill:Jg,offerPrice:Yg},Qg=({offer:s,selected:e,onChange:t})=>{const{t:n}=T("account"),a=c=>{if(c.freeDays)return n("choose_offer.benefits.first_days_free",{count:c.freeDays});if(c.freePeriods){const l=n(`periods.${c.period}`,{count:c.freePeriods});return n("choose_offer.benefits.first_periods_free",{count:c.freePeriods,period:l})}return null},o=(c,l)=>r.jsxs("li",{children:[r.jsx(K,{icon:l}),c,r.jsx("span",{className:"hidden",children:"."})]}),i=({title:c,periodString:l,secondBenefit:d})=>r.jsxs("div",{className:De.offer,"aria-labelledby":`title-${s.offerId}`,children:[r.jsx("input",{className:De.radio,onChange:t,type:"radio",name:"selectedOfferId",value:s.offerId,id:s.offerId,checked:e,"data-testid":(s.offerId,void 0)}),r.jsx("div",{className:De.label,children:r.jsxs("label",{htmlFor:s.offerId,children:[r.jsx("h2",{className:De.offerTitle,id:`title-${s.offerId}`,children:c}),r.jsx("span",{className:"hidden",children:"."}),r.jsx("hr",{className:De.offerDivider,"aria-hidden":!0}),r.jsxs("ul",{className:De.offerBenefits,children:[s.freeDays||s.freePeriods?o(a(s)||"",vr):null,!!d&&o(d,vr),o(n("choose_offer.benefits.watch_on_all_devices"),vr)]}),r.jsx("div",{className:De.fill}),r.jsxs("div",{className:De.offerPrice,children:[Bh(s)," ",!!l&&r.jsxs("small",{children:["/",l]})]})]})})]});if(ua(s)){const c=s.period==="month";return i({title:n(c?"choose_offer.monthly":"choose_offer.yearly"),secondBenefit:n("choose_offer.benefits.cancel_anytime"),periodString:n(c?"periods.month":"periods.year")})}return i({title:s.offerTitle,secondBenefit:s.durationPeriod&&s.durationAmount?n("choose_offer.tvod_access",{period:s.durationPeriod,count:s.durationAmount}):void 0})},Xg=({values:s,errors:e,submitting:t,offers:n,showOfferTypeSwitch:a,onChange:o,onSubmit:i,onBackButtonClickHandler:c})=>{const l=G(g=>g.config.siteName),{t:d}=T("account"),{selectedOfferType:h,selectedOfferId:u}=s;return r.jsxs("form",{onSubmit:i,"data-testid":void 0,noValidate:!0,children:[c?r.jsx(bl,{onClick:c}):null,r.jsx("h1",{className:De.title,children:d("choose_offer.title")}),r.jsx("p",{className:De.subtitle,children:d("choose_offer.watch_this_on_platform",{siteName:l})}),e.form?r.jsx(Oe,{variant:"error",children:e.form}):null,a&&r.jsxs("div",{className:De.offerGroupSwitch,children:[r.jsx("input",{className:De.radio,onChange:o,type:"radio",name:"selectedOfferType",id:"svod",value:"svod",checked:h==="svod"}),r.jsx("label",{className:M(De.label,De.offerGroupLabel),htmlFor:"svod",children:d("choose_offer.subscription")}),r.jsx("input",{className:De.radio,onChange:o,type:"radio",name:"selectedOfferType",id:"tvod",value:"tvod",checked:h==="tvod"}),r.jsx("label",{className:M(De.label,De.offerGroupLabel),htmlFor:"tvod",children:d("choose_offer.one_time_only")})]}),r.jsx("div",{className:De.offers,children:n.length?n.map(g=>r.jsx(Qg,{offer:g,selected:u===g.offerId,onChange:o},g.offerId)):r.jsx("p",{children:d("choose_offer.no_pricing_available")})}),t&&r.jsx(Se,{transparentBackground:!0,inline:!0}),r.jsx(F,{label:d("choose_offer.continue"),disabled:t||!n.length,variant:"contained",color:"primary",type:"submit",fullWidth:!0})]})},lc=()=>{const s=ae(),e=ue(),{t}=T("account"),n=He("u")==="upgrade-subscription",a=U(({pendingOffer:P})=>({isPendingOffer:!!P})),{isLoading:o,mediaOffers:i,subscriptionOffers:c,switchSubscriptionOffers:l,defaultOfferType:d,hasMultipleOfferTypes:h,chooseOffer:u,switchSubscription:g}=va(),_=J(e,"checkout"),f=J(e,"upgrade-subscription-pending"),x=J(e,"upgrade-subscription-success"),w=J(e,"upgrade-subscription-error"),{values:v,errors:b,submitting:y,setValue:C,handleSubmit:j,handleChange:S}=Tt({initialValues:{selectedOfferType:d,selectedOfferId:void 0},validationSchema:ne().shape({selectedOfferId:ds().required(t("choose_offer.field_required")),selectedOfferType:ds().required(t("choose_offer.field_required"))}),onSubmit:async({selectedOfferType:P,selectedOfferId:k})=>{if(!P||!k)return;const A=E.find($=>$.offerId===k);if(A&&(await u.mutateAsync(A),n))return await g.mutateAsync()},onSubmitSuccess:async()=>{if(n&&a)return s(f);if(n)return s(x);s(_)},onSubmitError:()=>s(w)}),E=v.selectedOfferType==="tvod"?i:n?l:c;return p.useEffect(()=>{var k;if(o||!E.length)return;const P=(k=E[E.length-1])==null?void 0:k.offerId;C("selectedOfferId",P)},[E,v.selectedOfferType,C,o]),p.useEffect(()=>{o||!d||C("selectedOfferType",d)},[o,d,C]),o?r.jsx("div",{style:{height:300},children:r.jsx(Se,{inline:!0})}):r.jsx(Xg,{onSubmit:j,onChange:S,values:v,errors:b,submitting:y,offers:E,showOfferTypeSwitch:h})},Zg="_container_19jg4_1",e_="_error_19jg4_25",t_="_medium_19jg4_28",s_="_select_19jg4_31",n_="_disabled_19jg4_38",r_="_option_19jg4_69",Is={container:Zg,error:e_,medium:t_,select:s_,disabled:n_,option:r_},Cl=({required:s,className:e,disabled:t,defaultLabel:n,options:a,optionsStyle:o,editing:i=!0,value:c,onChange:l,id:d,name:h,error:u,helperTextId:g,type:_,...f})=>{const x=y=>{if(!i)return y.preventDefault();l==null||l(y)},w=M(Is.container,{[Is.error]:u,[Is.disabled]:t},e),v={"aria-required":!!s,"aria-invalid":!!(s&&u&&c!==""),"aria-describedby":g},b={id:d,name:h,value:c,disabled:t,className:Is.select,readOnly:!i,required:s,...v,...f};return r.jsx("div",{className:M({[w]:i}),children:r.jsxs("select",{...b,onChange:x,children:[n&&r.jsx("option",{className:M(Is.option,o),value:"",disabled:s,children:n}),a&&a.map(y=>r.jsx("option",{className:M(Is.option,o),value:typeof y=="string"?y:y.value,children:typeof y=="string"?y:y.label},typeof y=="string"?y:y.value))]})})},Pl=({name:s,className:e,label:t,error:n,helperText:a,editing:o=!0,required:i=!1,size:c="medium",testId:l,lang:d,...h})=>r.jsx(fn,{className:e,error:n,helperText:a,label:t,required:i,editing:o,testId:l,name:s,size:c,lang:d,renderInput:u=>r.jsx(Cl,{name:s,required:i,editing:o,error:n,size:c,...u,...h})}),a_="_checkbox_13vmv_1",o_="_error_13vmv_17",i_="_row_13vmv_68",xr={checkbox:a_,error:o_,row:i_},Qn=({className:s,label:e,checkboxLabel:t,name:n,onChange:a,editing:o=!0,value:i,helperText:c,error:l,required:d,lang:h,size:u,...g})=>{const _=M(xr.checkbox,{[xr.error]:l},s),f=x=>{if(!o)return x.preventDefault();a==null||a(x)};return r.jsx(fn,{className:_,name:n,label:e,editing:o,required:d,error:l,helperText:c,renderInput:({id:x,helperTextId:w})=>r.jsxs("div",{className:xr.row,children:[r.jsx("input",{name:n,type:"checkbox",id:x,value:i,"aria-required":d,"aria-describedby":w,...g,onChange:f,readOnly:!o}),r.jsxs("label",{htmlFor:x,lang:h,children:[d?r.jsx("span",{role:"presentation","aria-hidden":"true",children:"*"}):"",t]})]})})},c_="_radio_p1qnp_1",l_="_error_p1qnp_6",dc={radio:c_,error:l_},El=({name:s,onChange:e,label:t,value:n,editing:a=!0,size:o,values:i,helperText:c,error:l,required:d,disabled:h,lang:u,...g})=>{const _=f=>{if(!a)return f.preventDefault();e==null||e(f)};return r.jsx(fn,{name:s,label:t,error:l,helperText:c,required:d,renderInput:({id:f,helperTextId:x})=>r.jsx("div",{id:f,children:i.map(({value:w,label:v},b)=>r.jsxs("div",{className:M(dc.radio,{[dc.error]:l}),lang:u,children:[r.jsx("input",{value:w,name:s,type:"radio",id:f+b,onChange:_,checked:n===w,required:d,disabled:h,"aria-describedby":x,...g}),r.jsx("label",{htmlFor:f+b,children:v})]},b))})})},d_="_container_n2mrr_1",u_="_error_n2mrr_10",h_="_disabled_n2mrr_13",m_="_leftControl_n2mrr_16",p_="_input_n2mrr_16",f_="_rightControl_n2mrr_19",g_="_control_n2mrr_31",__="_dateField_n2mrr_62",y_="_hiddenInput_n2mrr_102",ns={container:d_,error:u_,disabled:h_,leftControl:m_,input:p_,rightControl:f_,control:g_,dateField:__,hiddenInput:y_},v_=s=>{if(!s)return null;const e=new Date(s);return isNaN(e.getTime())?null:e},kl=s=>s>0&&s<10?`0${s}`:s.toString(),Il=(s,e,t)=>Math.min(t,Math.max(e,s)),wr=(s,e,t)=>{const n=Il(parseInt(s),e,t);return isNaN(n)?"":s.length>0&&n<10?kl(n):n.toString()},br=(s,e,t)=>{const n=Il(parseInt(s),e,t);return isNaN(n)?"":s.length>1&&n<10?kl(n):n.toString()},Al=({className:s,label:e,error:t,helperText:n,value:a,onChange:o,format:i="YYYY-MM-DD",name:c,editing:l,lang:d,required:h,onFocus:u,testId:g})=>{const _=v_(a),[f,x]=p.useState({date:(_==null?void 0:_.getDate().toString())||"",month:_?(_.getMonth()+1).toString():"",year:(_==null?void 0:_.getFullYear().toString())||""}),w=ht("text-field",c),v=ht("helper_text",c),b=p.useRef(null),y=M(ns.dateField,{[ns.error]:t},s),C=k=>{k.currentTarget.select(),u==null||u(k)},j=k=>{var A;if(k.key==="Backspace"&&f[k.currentTarget.name]==="")return(A=k.currentTarget.previousElementSibling)==null||A.focus(),k.preventDefault();if(!/^[0-9]$/.test(k.key)&&k.key!=="Tab"&&k.key!=="Backspace")return k.preventDefault()},S=k=>{const{name:A,value:$}=k.target;x(L=>{const D=A==="date"?wr($,1,31):L.date,O=A==="month"?wr($,1,12):L.month,I=A==="year"?wr($,1900,2100):L.year;return{date:D,month:O,year:I}})},E=(k,A,$)=>{var I,H;const L=(I=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value"))==null?void 0:I.set,D=k&&A&&$?i.replace("YYYY",$).replace("MM",A).replace("DD",k):"";L==null||L.call(b.current,D);const O=new Event("input",{bubbles:!0});(H=b.current)==null||H.dispatchEvent(O)},P=k=>{var H;const{name:A,value:$}=k.target,L=(H=k.currentTarget)==null?void 0:H.nextElementSibling,D=A==="date"?br($,0,31):f.date,O=A==="month"?br($,0,12):f.month,I=A==="year"?br($,0,2100).slice(0,4):f.year;x({date:D,month:O,year:I}),E(D,O,I),(L&&A==="month"&&O.length===2||A==="date"&&D.length===2)&&setTimeout(()=>L.focus(),1)};return r.jsx(fn,{className:y,name:c,helperText:n,error:t,label:e,editing:l,lang:d,required:h,testId:g,renderInput:()=>r.jsxs("div",{className:ns.container,children:[r.jsx("input",{ref:b,id:`${w}-hidden`,className:ns.hiddenInput,name:c,onChange:o,"aria-invalid":t,"aria-describedby":v}),r.jsx("input",{className:ns.input,name:"date",placeholder:"dd",value:f.date,onFocus:C,onBlur:S,onChange:P,onKeyDown:j,maxLength:2,type:"number",id:`${w}-date`,autoComplete:"bday-day"})," / ",r.jsx("input",{className:ns.input,name:"month",placeholder:"mm",value:f.month,onFocus:C,onBlur:S,onChange:P,onKeyDown:j,maxLength:2,type:"number",id:`${w}-month`,autoComplete:"bday-month"})," / ",r.jsx("input",{className:ns.input,name:"year",placeholder:"yyyy",value:f.year,onFocus:C,onBlur:S,onChange:P,onKeyDown:j,maxLength:4,type:"number",id:`${w}-year`,autoComplete:"bday-year"})]})})},x_="_title_a6ei2_1",uc={title:x_,continue:"_continue_a6ei2_7"},w_=({initialValues:s,onSubmit:e,fields:t,questions:n,onQuestionChange:a,questionValues:o,questionErrors:i})=>{var w,v,b,y,C;const{t:c}=T("account"),{setValue:l,handleSubmit:d,handleChange:h,values:u,errors:g,validationSchemaError:_,submitting:f}=Tt({initialValues:s,onSubmit:e}),x=({value:j,key:S,question:E,required:P,enabled:k})=>{if(!k)return null;const A=j==null?void 0:j.split(";").map(L=>{const[D,O=D]=L.split(":");return{value:D,label:O}}),$={name:S,onChange:a,error:!!i[S],helperText:i[S],required:P,key:S};return A.length===1&&A[0].value===""?r.jsx(pe,{value:o[S],label:E,...$}):A.length===1?r.jsx(Qn,{checked:!!o[S],value:A[0].value,label:E,checkboxLabel:A[0].label,...$}):A.length===2?r.jsx(El,{values:A,value:o[S],label:E,...$}):A.length>2?r.jsx(Pl,{options:A,value:o[S],label:E,defaultLabel:c("personal_details.select_answer"),...$}):null};return r.jsxs("form",{onSubmit:d,"data-testid":void 0,noValidate:!0,children:[r.jsx("h2",{className:uc.title,children:c("personal_details.title")}),g.form?r.jsx(Oe,{variant:"error",visible:!_,children:g.form}):null,(w=t.firstNameLastName)!=null&&w.enabled?r.jsxs(Te.Fragment,{children:[r.jsx(pe,{value:u.firstName,onChange:h,label:c("personal_details.fist_name"),placeholder:c("personal_details.fist_name"),error:!!g.firstName,helperText:g.firstName,required:t.firstNameLastName.required,name:"firstName",autoComplete:"given-name"}),r.jsx(pe,{value:u.lastName,onChange:h,label:c("personal_details.last_name"),placeholder:c("personal_details.last_name"),error:!!g.lastName,helperText:g.lastName,required:t.firstNameLastName.required,name:"lastName",autoComplete:"family-name"})]}):null,(v=t.companyName)!=null&&v.enabled?r.jsx(pe,{value:u.companyName,onChange:h,label:c("personal_details.company_name"),placeholder:c("personal_details.company_name"),error:!!g.companyName,helperText:g.companyName,required:t.companyName.required,name:"companyName",autoComplete:"organization"}):null,(b=t.address)!=null&&b.enabled?r.jsxs(Te.Fragment,{children:[r.jsx(pe,{value:u.address,onChange:h,label:c("personal_details.address"),placeholder:c("personal_details.address"),error:!!g.address,helperText:g.address,required:t.address.required,name:"address",autoComplete:"address-line1"}),r.jsx(pe,{value:u.address2,onChange:h,label:c("personal_details.address2"),placeholder:c("personal_details.address2"),error:!!g.address2,helperText:g.address2,name:"address2",autoComplete:"address-line2"}),r.jsx(pe,{value:u.city,onChange:h,label:c("personal_details.city"),placeholder:c("personal_details.city"),error:!!g.city,helperText:g.city,required:t.address.required,name:"city",autoComplete:"address-level2"}),r.jsx(pe,{value:u.state,onChange:h,label:c("personal_details.state"),placeholder:c("personal_details.state"),error:!!g.state,helperText:g.state,required:t.address.required,name:"state",autoComplete:"address-level1"}),r.jsx(pe,{value:u.postCode,onChange:h,label:c("personal_details.post_code"),placeholder:c("personal_details.post_code"),error:!!g.postCode,helperText:g.postCode,required:t.address.required,name:"postCode",autoComplete:"postal-code"})]}):null,(y=t.phoneNumber)!=null&&y.enabled?r.jsx(pe,{value:u.phoneNumber,onChange:h,label:c("personal_details.phone_number"),placeholder:c("personal_details.phone_number"),error:!!g.phoneNumber,helperText:g.phoneNumber,required:t.phoneNumber.required,name:"phoneNumber"}):null,(C=t.birthDate)!=null&&C.enabled?r.jsx(Al,{value:u.birthDate,onChange:j=>l("birthDate",j.currentTarget.value),label:c("personal_details.birth_date"),error:!!g.birthDate,helperText:g.birthDate,required:t.birthDate.required,name:"birthDate"}):null,n.map(j=>x(j)),r.jsx(F,{className:uc.continue,type:"submit",label:c("personal_details.continue"),variant:"contained",color:"primary",size:"large",disabled:f,fullWidth:!0}),f&&r.jsx(Se,{transparentBackground:!0,inline:!0})]})},$t=(s,e)=>s?B().required(e):ds().notRequired(),b_=()=>{const s=q(ye),e=ae(),t=ue(),{t:n}=T("account"),a=G(y=>y.accessModel),{data:o,isLoading:i}=We("captureStatus",s.getCaptureStatus),{mediaOffers:c}=va(),l=c.length>0,[d,h]=p.useState({}),[u,g]=p.useState({}),_=p.useMemo(()=>Object.fromEntries((o==null?void 0:o.settings.map(y=>[y.key,y]))||[]),[o]),f=p.useMemo(()=>(o==null?void 0:o.settings.filter(y=>!!y.question))||[],[o]),x=p.useCallback(()=>{const y=a===Fe.SVOD||a===Fe.AUTHVOD&&l;e(J(t,y?"choose-offer":"welcome"),{replace:!0})},[e,t,a,l]);p.useEffect(()=>{o&&((!o.isCaptureEnabled||!o.shouldCaptureBeDisplayed)&&x(),f&&h(Object.fromEntries(f.map(y=>[y.key,""]))))},[o,x,f]);const w=p.useMemo(()=>{const[y,C]=(()=>{var j,S;if((j=_.firstNameLastName)!=null&&j.enabled){const E=(S=_.firstNameLastName)==null?void 0:S.answer;return[(E==null?void 0:E.firstName)||"",(E==null?void 0:E.lastName)||""]}return["",""]})();return{firstName:y,lastName:C,birthDate:"",companyName:"",phoneNumber:"",address:"",address2:"",city:"",state:"",postCode:"",country:""}},[_]),v=y=>{const C=y.target.type==="checkbox"&&!y.target.checked?"":y.target.value;h(j=>({...j,[y.target.name]:C}))},b=async(y,{setErrors:C,setSubmitting:j,setValidationSchemaError:S,validate:E})=>{var $,L,D,O,I,H,X,ee,Q,N;const P=n("personal_details.this_field_is_required"),k=ne().shape({firstName:$t(!!(($=_.firstNameLastName)!=null&&$.required),P),lastName:$t(!!((L=_.firstNameLastName)!=null&&L.required),P),address1:$t(!!((D=_.address)!=null&&D.required),P),address2:$t(!!((O=_.address)!=null&&O.required),P),postCode:$t(!!((I=_.address)!=null&&I.required),P),state:$t(!!((H=_.address)!=null&&H.required),P),city:$t(!!((X=_.address)!=null&&X.required),P),companyName:$t(!!((ee=_.companyName)!=null&&ee.required),P),birthDate:(Q=_.birthDate)!=null&&Q.required?B().required(P).matches(/\d{4}-\d{2}-\d{2}/,n("personal_details.birth_date_not_valid")):ds().notRequired(),phoneNumber:$t(!!((N=_.phoneNumber)!=null&&N.required),P)}),A={};if(f.forEach(R=>{R.enabled&&R.required&&!d[R.key]&&(A[R.key]=n("personal_details.this_field_is_required"))}),g(A),!E(k)||Object.keys(A).length){j(!1),S(!0);return}try{const R=z=>Object.fromEntries(Object.keys(z).filter(re=>z[re]!=="").map(re=>[re,z[re]])),Y=f.map(z=>({question:z.question,questionId:z.key,value:d[z.key]}));await s.updateCaptureAnswers(R({...y,customAnswers:Y})),x()}catch(R){R instanceof Error&&C({form:R.message})}j(!1)};return i?r.jsx("div",{style:{height:400},children:r.jsx(Se,{inline:!0})}):r.jsx(w_,{initialValues:w,fields:_,questions:f,onQuestionChange:v,questionValues:d,questionErrors:u,onSubmit:b})};function Tl(s){const e=q(ye),{data:t,error:n}=We(["socialUrls",s],()=>e.getSocialLoginUrls(s),{enabled:e.getFeatures().hasSocialURLs,retry:!1}),a=p.useMemo(()=>t?t.reduce((o,i)=>({...o,...i}),{}):null,[t]);return n||!a?null:a}const Nl=({type:s,value:e="",label:t,options:n,editing:a,lang:o,...i})=>{const{t:c,i18n:l}=T(),d=p.useMemo(()=>s&&["country","us_state"].includes(s)?Object.keys(l.getResourceBundle(l.language,s)).map(u=>({value:u,label:c(`${s}:${u}`)})):n?Object.entries(n).map(([h,u])=>({value:h,label:u})):[],[s,n,l,c]);switch(s){case"input":return r.jsx(pe,{...i,value:String(e),label:t,testId:void 0});case"radio":return r.jsx(El,{...i,label:t,values:d,value:String(e),"data-testid":void 0,lang:o});case"select":case"country":case"us_state":return r.jsx(Pl,{...i,options:d,value:String(e),label:t,defaultLabel:i.placeholder,testId:void 0,lang:o});case"datepicker":return r.jsx(Al,{...i,value:String(e),label:t,testId:void 0});default:return r.jsx(Qn,{...i,checkboxLabel:t,checked:fs(e),"data-testid":void 0,lang:o})}},S_="_link_1nyb9_1",j_={link:S_},ln=({to:s,href:e,children:t,className:n,onClick:a,target:o,...i})=>{const c=M(j_.link,n);return s?r.jsx(un,{to:s,className:c,onClick:a,...i,children:t}):r.jsx("a",{href:e,className:c,onClick:a,target:o,rel:o==="_blank"?"noreferrer":void 0,...i,children:t})},C_="_title_io7pr_1",P_="_bottom_io7pr_11",E_="_alreadyAccount_io7pr_16",k_="_login_io7pr_20",I_="_customFields_io7pr_27",En={title:C_,continue:"_continue_io7pr_7",bottom:P_,alreadyAccount:E_,login:k_,customFields:I_},A_=({onSubmit:s,onChange:e,onBlur:t,values:n,errors:a,submitting:o,validationError:i,loading:c,publisherConsents:l,consentValues:d,onConsentChange:h,consentErrors:u,captchaSiteKey:g,recaptchaRef:_})=>{const{t:f,i18n:x}=T("account"),w=ue(),v=p.useRef(null),b=x.language!==W.APP_DEFAULT_LANGUAGE?W.APP_DEFAULT_LANGUAGE:void 0,y=C=>{const j=ea.sanitize(C),S=/<a(.|\n)*?>/.test(j),E=/<\/a(.|\n)*?>/.test(j);return S&&E?r.jsx("span",{dangerouslySetInnerHTML:{__html:C}}):C};return p.useEffect(()=>{var C;a.form&&((C=v.current)==null||C.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}))},[a.form]),r.jsxs("form",{onSubmit:s,"data-testid":void 0,noValidate:!0,children:[r.jsx("div",{ref:v,children:a.form?r.jsx(Oe,{variant:"error",visible:!i,children:a.form}):null}),r.jsx("h2",{className:En.title,children:f("registration.sign_up")}),r.jsx(pe,{value:n.email,onChange:e,onBlur:t,label:f("registration.email"),placeholder:f("registration.email"),error:!!a.email,helperText:a.email,name:"email",type:"email",autoComplete:"email",required:!0}),r.jsx(an,{value:n.password,onChange:e,onBlur:t,label:f("registration.password"),placeholder:f("registration.password"),error:!!a.password,name:"password",autoComplete:"new-password",required:!0}),l&&r.jsx("div",{className:En.customFields,"data-testid":"custom-reg-fields",children:l.map(C=>{const j=u.find(S=>S===C.name);return r.jsx(Nl,{type:C.type,name:C.name,options:C.options,label:y(C.label),placeholder:C.placeholder,value:d[C.name]||"",required:C.required,error:!!j,helperText:j?f("registration.field_required"):void 0,onChange:h,lang:b},C.name)})}),!!g&&r.jsx(Sl,{siteKey:g,ref:_}),r.jsx(F,{className:En.continue,type:"submit",label:f("registration.continue"),variant:"contained",color:"primary",size:"large",disabled:o,fullWidth:!0}),r.jsxs("p",{className:En.bottom,children:[f("registration.already_account")," ",r.jsx(ln,{to:J(w,"login"),children:f("login.sign_in")})]}),(c||o)&&r.jsx(Se,{transparentBackground:!0,inline:!0})]})},T_=()=>{const s=q(ye),e=ae(),t=ue(),{t:n}=T("account"),a=Ke(),[o,i]=p.useState({}),[c,l]=p.useState([]),{publisherConsents:d,publisherConsentsLoading:h,loading:u}=U(({publisherConsents:P,publisherConsentsLoading:k,loading:A})=>({publisherConsents:P,publisherConsentsLoading:k,loading:A})),{recaptchaRef:g,captchaSiteKey:_,getCaptchaValue:f}=jl(),x=({currentTarget:P})=>{if(!P)return;const{name:k,type:A}=P,$=A==="checkbox"?P.checked:P.value;i(L=>({...L,[k]:$})),l(L=>L.filter(D=>D!==k))};p.useEffect(()=>{if(!d){s.getPublisherConsents();return}i(Lh(d))},[s,d]);const w=Tl(Dt("personal-details")),{handleSubmit:v,handleChange:b,handleBlur:y,values:C,errors:j,validationSchemaError:S,submitting:E}=Tt({initialValues:{email:"",password:""},validationSchema:ne().shape({email:B().email(n("registration.field_is_not_valid_email")).required(n("registration.field_required",{field:n("registration.email")})),password:B().matches(/^(?=.*[a-z])(?=.*[0-9]).{8,}$/,n("registration.invalid_password",{field:n("registration.password")})).required(n("registration.field_required",{field:n("registration.password")})),captchaValue:B().notRequired()}),validateOnBlur:!0,onSubmit:async({email:P,password:k})=>{const{consentsErrors:A}=$h(d||[],o);if(A.length)throw l(A),new Error(n("registration.consents_error"));const $=await f();await s.register(P,k,window.location.href,Fn(d,o),$)},onSubmitSuccess:()=>{a(n("registration.success"),"success"),e(J(t,"personal-details"))}});return r.jsx(A_,{onSubmit:v,onChange:b,onConsentChange:x,onBlur:y,values:C,errors:j,consentErrors:c,validationError:S,submitting:E,consentValues:o,publisherConsents:d,loading:u||h,socialLoginURLs:w,captchaSiteKey:_,recaptchaRef:g})},N_="_title_8jji7_1",L_="_link_8jji7_7",$_="_bottom_8jji7_11",R_="_top_8jji7_16",Sr={title:N_,link:L_,bottom:$_,top:R_},O_=({onSubmit:s,onChange:e,values:t,errors:n,validationError:a,submitting:o,siteName:i})=>{const[c,l]=fa(),{t:d}=T("account"),h=ue();return r.jsxs("form",{onSubmit:s,"data-testid":void 0,noValidate:!0,children:[n.form?r.jsx(Oe,{variant:"error",visible:!a,children:n.form}):null,r.jsx("h2",{className:Sr.title,children:d("login.sign_in")}),r.jsx(pe,{value:t.email,onChange:e,label:d("login.email"),placeholder:d("login.email"),error:!!n.email,helperText:n.email,name:"email",type:"email",required:!0,testId:"login-email-input",autoComplete:"email"}),r.jsx(pe,{value:t.password,onChange:e,label:d("login.password"),placeholder:d("login.password"),error:!!n.password,helperText:n.password,name:"password",type:c?"text":"password",rightControl:r.jsx(Ge,{"aria-label":d("login.view_password"),onClick:()=>l(),"aria-pressed":c,children:r.jsx(K,{icon:c?ga:_a})}),required:!0,testId:"login-password-input",autoComplete:"current-password"}),o&&r.jsx(Se,{transparentBackground:!0,inline:!0}),r.jsx(ln,{className:Sr.link,to:J(h,"forgot-password"),children:d("login.forgot_password")}),r.jsx(F,{type:"submit",label:d("login.sign_in"),variant:"contained",color:"primary",size:"large",disabled:o,fullWidth:!0}),r.jsxs("p",{className:Sr.bottom,children:[d("login.not_registered",{siteName:i})," ",r.jsx(ln,{to:J(h,"create-account"),children:d("login.sign_up")})]})]})},D_=()=>{const s=q(ye),{siteName:e}=G(_=>_.config),t=ae(),n=ue(),{t:a}=T("account"),o=Ke(),i=Tl(window.location.href.split("?")[0]),{values:c,errors:l,submitting:d,validationSchemaError:h,handleSubmit:u,handleChange:g}=Tt({initialValues:{email:"",password:""},validationSchema:ne().shape({email:B().email(a("login.field_is_not_valid_email")).required(a("login.field_required",{field:a("login.email")})),password:B().required(a("login.field_required",{field:a("login.password")}))}),onSubmit:({email:_,password:f})=>s.login(_,f,window.location.href),onSubmitSuccess:()=>{o(a("login.sign_in_success"),"success"),t(J(n,null))},onSubmitError:({resetValue:_})=>_("password")});return r.jsx(O_,{values:c,validationError:h,errors:l,submitting:d,siteName:e,socialLoginURLs:i,onSubmit:u,onChange:g})},F_="_banner_ygdsu_1",M_={banner:F_},B_=["login","create-account","forgot-password","reset-password","send-confirmation","edit-password"],U_=()=>{const s=ae(),e=ue(),t=He("u"),n=p.useRef(t),a=He("message"),{loading:o,user:i}=U(({loading:v,user:b})=>({loading:v,user:b}),de),c=G(v=>v.config),{assets:{banner:l},siteName:d}=c,h=t&&B_.includes(t),u=he(()=>{s(J(e,"login"))}),g=p.useMemo(()=>(t&&(n.current=t),n.current),[t]);p.useEffect(()=>{t&&!o&&!i&&!h&&u()},[t,o,h,i,u]);const _=he(()=>{s(ml(e,{u:null,message:null}))}),f=()=>{if(!i&&o&&!h)return r.jsx("div",{style:{height:300},children:r.jsx(Se,{inline:!0})});switch(g){case"login":return r.jsx(D_,{});case"create-account":return r.jsx(T_,{});case"personal-details":return r.jsx(b_,{});case"choose-offer":return r.jsx(lc,{});case"edit-card":return r.jsx(wf,{});case"upgrade-subscription":return r.jsx(lc,{});case"upgrade-subscription-error":return r.jsx(hr,{type:"error",onCloseButtonClick:_});case"upgrade-subscription-success":return r.jsx(hr,{type:"success",onCloseButtonClick:_});case"upgrade-subscription-pending":return r.jsx(hr,{type:"pending",onCloseButtonClick:_});case"checkout":return r.jsx(Dg,{});case"payment-error":return r.jsx(Ji,{type:"error",message:a,onCloseButtonClick:_});case"payment-cancelled":return r.jsx(Ji,{type:"cancelled",message:a,onCloseButtonClick:_});case"welcome":return r.jsx(Bm,{onCloseButtonClick:_,onCountdownCompleted:_,siteName:d});case"reset-password":return r.jsx(_r,{type:"reset"});case"forgot-password":return r.jsx(_r,{type:"forgot"});case"add-password":return r.jsx(ic,{type:"add"});case"delete-account":case"delete-account-confirmation":return r.jsx(Rp,{});case"warning-account-deletion":return r.jsx(Xp,{});case"send-confirmation":return r.jsx(_r,{type:"confirmation"});case"edit-password":return r.jsx(ic,{});case"unsubscribe":return r.jsx(Wf,{});case"renew-subscription":return r.jsx(Df,{});case"payment-method":case"payment-method-success":return r.jsx(hf,{onCloseButtonClick:_});case"waiting-for-payment":return r.jsx(Hp,{});case"finalize-payment":return r.jsx(Fp,{})}},x=!["delete-account","delete-account-confirmation","edit-card","warning-account-deletion"].includes(g??""),w=["delete-account-confirmation"].includes(g??"")?"large":"small";return r.jsxs(pa,{size:w,open:!!t,onClose:_,children:[x&&l&&r.jsx("div",{className:M_.banner,children:r.jsx("img",{src:l,alt:""})}),f()]})},H_={jwpAuth:{id:"9qqwmnbx",label:"JWP AUTHVOD"},jwpSvod:{id:"a2kbjdv0",label:"JWP SVOD"},jwpAuthNoWatchlist:{id:"oqrsyxin",label:"JWP Authvod (No WL)"},basicNoAuth:{id:"gnnuzabk",label:"Demo App (No Auth)"},noStyling:{id:"kujzeu1b",label:"No Styling (No Auth)"},inlinePlayer:{id:"ata6ucb8",label:"Inline Player"},cleengAuthvod:{id:"nvqkufhy",label:"Cleeng Authvod"},cleengAuthvodNoWatchlist:{id:"7weyqrua",label:"Cleeng Authvod (No WL)"},svod:{id:"ozylzc5m",label:"Cleeng SVOD"}},W_=H_;[...Object.values(W_).map(({id:s,label:e})=>({value:s,label:`${s.length>8?"ext-json":s} - ${e}`}))];const V_=q(Gn),q_=(s,e)=>{const t=ta(),{i18n:n}=T(),a=()=>t.invalidateQueries({queryKey:["entitlements"]}),{data:o,isLoading:i,error:c,isSuccess:l,refetch:d}=We("config-init",()=>V_.initializeApp(s,n.language,a),{refetchInterval:!1,retry:1,onSettled:h=>{Ot("Bootstrap","Initialized application",{...h}),e(h==null?void 0:h.config)},cacheTime:ms,staleTime:ps});return{data:o,isLoading:i,error:c,isSuccess:l,refetch:d}},z_=s=>{const e=document.querySelector(":root"),{highlightColor:t,backgroundColor:n,headerBackground:a}=s.styling||{},o=W.APP_BODY_FONT,i=W.APP_BODY_ALT_FONT;if(e){if(e.style.setProperty("--highlight-color",t||"#fff"),e.style.setProperty("--highlight-contrast-color",t?ir(t):"#000"),a&&(e.style.setProperty("--header-background",a),e.style.setProperty("--header-contrast-color",ir(a))),n){const c=ir(n);e.style.setProperty("--body-background-color",n),e.style.setProperty("--body-color",c),c==="#000000"&&(e.style.setProperty("--body-text-shadow","none"),e.style.setProperty("--hero-shelf-background-color","#1f1f1f"),e.style.setProperty("--epg-background-color","#262626"))}o&&e.style.setProperty("--body-font-family",o),i&&e.style.setProperty("--body-alt-font-family",i)}},G_="_title_gkrmh_1",K_="_body_gkrmh_8",J_="_confirmButton_gkrmh_12",jr={title:G_,body:K_,confirmButton:J_},Y_=({open:s,title:e,body:t,onConfirm:n,onClose:a,busy:o})=>{const{t:i}=T("common");return r.jsxs(pa,{open:s,onClose:a,role:"alertdialog",children:[r.jsx("h2",{className:jr.title,children:e}),r.jsx("p",{className:jr.body,children:t}),r.jsx(F,{className:jr.confirmButton,label:i("confirmation_dialog.confirm"),variant:"contained",color:o?"default":"primary",onClick:n,fullWidth:!0,disabled:o,busy:o}),r.jsx(F,{label:i("confirmation_dialog.close"),variant:"outlined",onClick:a,fullWidth:!0,disabled:o})]})},Q_=()=>{const s=Bd();return r.jsx(nt,{error:s})},X_="_markdown_hxhg7_1",Z_="_inline_hxhg7_62",hc={markdown:X_,inline:Z_},xa=new Mn.Renderer;xa.link=(s,e,t)=>{const n=/^(https?|www\.|\/\/)/.test(s||""),a=n?'target="_blank"':void 0,o=n?'rel="noopener"':void 0,i=e?`title="${e}"`:void 0,c=[a,o,i].filter(Boolean);return`<a href="${s}" ${c.join(" ")}>${t}</a>`};const wa=new Mn.Renderer({gfm:!1});wa.image=()=>"";wa.link=xa.link;const Hs=({markdownString:s,className:e,tag:t="div",inline:n=!1})=>{const a=p.useMemo(()=>{const o=n?Mn.parseInline(s,{renderer:wa}):Mn.parse(s,{renderer:xa});return ea.sanitize(o,{ADD_ATTR:["target"]})},[n,s]);return Te.createElement(t,{dangerouslySetInnerHTML:{__html:a},className:M(hc.markdown,n&&hc.inline,e)})},ey="_about_c4gxs_1",ty={about:ey},sy=()=>r.jsx(Hs,{className:ty.about,markdownString:`# About JW OTT Webapp
  
JW OTT Webapp is an open-source, dynamically generated video website built around JW Player and JW Platform services. It enables you to easily publish your JW Player-hosted video content with no coding and minimal configuration.

To see an example of JW OTT Webapp in action, see [https://app-preview.jwplayer.com/](https://app-preview.jwplayer.com/).

## Supported Features

- Works with any JW Player edition, from Free to Enterprise (note that usage will count against your monthly JW streaming limits). Only cloud-hosted JW Players are supported.
- It looks great on any device. The responsive UI automatically optimizes itself for desktop, tablet, and mobile screens.
- Populates your site's media content using JSON feeds. If you are using JW Platform, this happens auto-magically based on playlists that you specify. Using feeds from other sources will require you to hack the source code.
- Video titles, descriptions and hero images are populated from JW Platform JSON feed metadata.
- Playback of HLS video content from the JW Platform CDN. You can add external URLs (for example, URLS from your own server or CDN) to your playlists in the Content section of your JW Player account dashboard, but they must be HLS streams (\`.m3u8\` files).
- Support for live video streams (must be registered as external .m3u8 URLs in your JW Dashboard).
- Customize the user interface with your own branding. The default app is configured for JW Player branding and content, but you can easily change this to use your own assets by modifying the \`config.json\` file. Advanced customization is possible (for example, editing the CSS files), but you will need to modify the source code and build from source.
- Site-wide video search and related video recommendations powered by [JW Recommendations](https://docs.jwplayer.com/platform/docs/vdh-learn-about-recommendations).
- Basic playback analytics is reported to your JW Dashboard.
- Ad integrations (VAST, VPAID, GoogleIMA, etc.). These features require a JW Player Ads Edition license. For more information, see the [JW Player pricing page](https://www.jwplayer.com/pricing/).
- A "Favorites" feature for users to save videos for watching later. A separate list for "Continue Watching" is also kept so users can resume watching videos from where they left off. The lists are per-browser at this time (i.e., lists do not sync across user's browsers or devices). The "Continue Watching" list can be disabled in your JW OTT Webapp's \`config.json\` file.
- A grid view for a particular playlist of videos, with the ability to deep-link to the playlist through a static URL.
- Social sharing options using the device native sharing dialog.

## Unsupported Features

- Security-related features (encrypted HLS, DRM, signed URLs)
- Self-hosted JW Players`}),ny=al(30),Ll=({type:s,contentId:e,siteId:t,enabled:n,usePlaceholderData:a,params:o={},queryClient:i,language:c})=>{const l=q(Le);return{enabled:!!e&&n,queryKey:["playlist",s,e,o,c],queryFn:async()=>{var d;if(s===Ft.playlist){const h=await l.getPlaylistById(e,o,c);return(d=h==null?void 0:h.playlist)==null||d.forEach(u=>{i.setQueryData(["media",u.mediaid],u)}),h}else if(s===Ft.content_list)return await l.getContentList({siteId:t,id:e,language:c})},placeholderData:e&&a?ny:void 0,refetchInterval:d=>d&&(fs(d.refetch)||d.playlist.some(qc))?1e3*30:!1,retry:!1}};function gn(s,e={},t=!0,n=!0,a=Ft.playlist){const{i18n:o}=T(),i=o.language,c=ta(),l=G(h=>h.config.siteId),d=Ll({type:a,contentId:s,siteId:l,params:e,queryClient:c,enabled:t,usePlaceholderData:n,language:i});return We(d)}const ry=s=>!cu.some(e=>e===s),ay=(s,e=void 0)=>{const t=lu.toString(),n=ta(),a=G(h=>h.config.siteId),o=pt(h=>h.getPlaylist()),i=gt(h=>h.getPlaylist()),{i18n:c}=T(),l=$c(s.map(({contentId:h,type:u},g)=>ry(u)?Ll({enabled:!e||e>g,type:u,siteId:a,contentId:h,queryClient:n,usePlaceholderData:!0,params:{page_limit:t},language:c.language}):{enabled:!1}));return s.map(({type:h},u)=>{if(h===_t.Favorites)return{data:o,isLoading:!1,isSuccess:!0};if(h===_t.ContinueWatching)return{data:i,isLoading:!1,isSuccess:!0};const{data:g,isSuccess:_,error:f,isPlaceholderData:x}=l[u];return{data:g,isSuccess:_,error:f,isPlaceholderData:x}})},Xn=s=>{const{i18n:e}=T();return`${s}-${e.language}`},ba=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})),_n=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})),kn=(s,e)=>{typeof s.addEventListener>"u"?s.addListener(e):s.addEventListener("change",e)},In=(s,e)=>{typeof s.removeEventListener>"u"?s.removeListener(e):s.removeEventListener("change",e)},Kr=matchMedia("screen and (max-width: 479px)"),Jr=matchMedia("screen and (min-width: 480px) and (max-width: 767px)"),Yr=matchMedia("screen and (min-width: 768px) and (max-width: 1023px)"),Qr=matchMedia("screen and (min-width: 1024px) and (max-width: 1199px)");var Z=(s=>(s[s.xs=0]="xs",s[s.sm=1]="sm",s[s.md=2]="md",s[s.lg=3]="lg",s[s.xl=4]="xl",s))(Z||{});const mc=()=>Kr.matches?0:Jr.matches?1:Yr.matches?2:Qr.matches?3:4,Pe=()=>{const[s,e]=p.useState(()=>mc());return p.useEffect(()=>{const t=()=>e(mc());return kn(Kr,t),kn(Jr,t),kn(Yr,t),kn(Qr,t),()=>{In(Kr,t),In(Jr,t),In(Yr,t),In(Qr,t)}},[]),s},Sa=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{fill:"currentColor",d:"M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z"})),ja=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),p.createElement("path",{d:"M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"})),oy="_image_f8aiq_1",iy={image:oy},cy=(s,e)=>Ie(s,{w:e}),Cr=new Map,ly=async(s,e)=>{const t=cy(s,e);let n=t;if(Cr.has(t))return Cr.get(t);try{const a=await fetch(t);a.redirected&&(n=a.url.replace("-1920",`-${e}`)),Cr.set(t,n)}catch(a){Kc("Image","Failed to fetch image",{error:a,url:n})}return n},dy=p.forwardRef(({className:s,image:e,onLoad:t,alt:n="",width:a=640},o)=>{const[i,c]=p.useState(null);return p.useEffect(()=>{if(!e)return;(async()=>{const d=await ly(e,a);c(d),t==null||t()})()},[e,a,t]),i?r.jsx("img",{ref:o,className:`${s} ${iy.image}`,src:i,alt:n}):null}),Ws=Te.memo(dy),uy="_card_w4d6e_1",hy="_featured_w4d6e_18",my="_title_w4d6e_18",py="_tag_w4d6e_33",fy="_meta_w4d6e_42",gy="_disabled_w4d6e_50",_y="_poster_w4d6e_55",yy="_current_w4d6e_65",vy="_posterImage_w4d6e_74",xy="_currentLabel_w4d6e_82",wy="_aspect11_w4d6e_98",by="_aspect21_w4d6e_102",Sy="_aspect23_w4d6e_106",jy="_aspect43_w4d6e_110",Cy="_aspect53_w4d6e_114",Py="_aspect169_w4d6e_118",Ey="_aspect916_w4d6e_122",ky="_aspect913_w4d6e_126",Iy="_titleContainer_w4d6e_130",Ay="_loading_w4d6e_152",Ty="_scheduledStart_w4d6e_167",Ny="_tags_w4d6e_189",Ly="_lock_w4d6e_211",$y="_live_w4d6e_220",Ry="_scheduled_w4d6e_167",Oy="_progressContainer_w4d6e_230",Dy="_progressBar_w4d6e_240",fe={card:uy,featured:hy,title:my,tag:py,meta:fy,disabled:gy,poster:_y,current:yy,posterImage:vy,currentLabel:xy,aspect11:wy,aspect21:by,aspect23:Sy,aspect43:jy,aspect53:Cy,aspect169:Py,aspect916:Ey,aspect913:ky,titleContainer:Iy,loading:Ay,scheduledStart:Ty,tags:Ny,lock:Ly,live:$y,scheduled:Ry,progressContainer:Oy,progressBar:Dy},Fy=Symbol("CARD");function My({onHover:s,progress:e,item:t,posterAspect:n="16:9",featured:a=!1,disabled:o=!1,loading:i=!1,isCurrent:c=!1,isLocked:l=!0,currentLabel:d,headingLevel:h=3,url:u,tabIndex:g=0}){const{title:_,duration:f,episodeNumber:x,seasonNumber:w,cardImage:v,mediaStatus:b,scheduledStart:y}=t,{t:C,i18n:{language:j}}=T(["common","video"]),S=M(fe.card,{[fe.featured]:a,[fe.disabled]:o}),E=n?fe[`aspect${n.replace(":","")}`]:void 0,P=M(fe.poster,E,{[fe.current]:c}),k=Qc(t),A=b===Mt.LIVE||Zc(t),$=b===Mt.SCHEDULED,L=()=>{if(i||!_)return null;if(k)return r.jsx("div",{className:fe.tag,children:C("video:series")});if(x)return r.jsx("div",{className:fe.tag,children:Kn(w,x)});if(f)return r.jsx("div",{className:fe.tag,children:da(f,{minutesAbbreviation:C("common:abbreviation.minutes")})});if(A)return r.jsx("div",{className:M(fe.tag,fe.live),children:C("live")});if($)return r.jsxs("div",{className:fe.tag,children:[r.jsx(K,{icon:ja,className:fe.scheduled}),C("scheduled")]})},D=Te.createElement(`h${h}`,{className:M(fe.title,{[fe.loading]:i})},i?"":_);return r.jsxs(un,{role:"button",to:u,className:S,onClick:o?O=>O.preventDefault():void 0,onMouseEnter:s,tabIndex:o?-1:g,"data-testid":void 0,children:[!a&&r.jsxs("div",{className:fe.titleContainer,children:[D,!!y&&Vc(t)&&r.jsx("div",{className:M(fe.scheduledStart,{[fe.loading]:i}),children:Bn(y,j)})]}),r.jsxs("div",{className:P,children:[r.jsx(Ws,{className:fe.posterImage,image:v,width:a?640:320,alt:""}),!i&&r.jsxs("div",{className:fe.meta,children:[a&&D,r.jsxs("div",{className:fe.tags,children:[l&&r.jsx("div",{className:M(fe.tag,fe.lock),"aria-label":C("card_lock"),role:"img",children:r.jsx(K,{icon:Sa})}),L()]})]}),c&&r.jsx("div",{className:fe.currentLabel,children:d}),e?r.jsx("div",{className:fe.progressContainer,children:r.jsx("div",{className:fe.progressBar,style:{width:`${Math.round(e*100)}%`}})}):null]})]})}const $l=p.memo(ys(Fy,My)),By="_shelf_11rpw_1",Uy="_chevron_11rpw_5",Hy="_loadingTitle_11rpw_9",Wy="_title_11rpw_17",Vy="_slider_11rpw_29",qy="_dots_11rpw_71",zy="_dot_11rpw_71",Gy="_active_11rpw_90",Ky="_error_11rpw_95",jt={shelf:By,chevron:Uy,loadingTitle:Hy,title:Wy,slider:Vy,dots:qy,dot:zy,active:Gy,error:Ky},Jy={[Z.xs]:1,[Z.sm]:2,[Z.md]:3,[Z.lg]:4,[Z.xl]:5},Yy={[Z.xs]:1,[Z.sm]:1,[Z.md]:1,[Z.lg]:1,[Z.xl]:1},Qy=Symbol("SHELF"),Xy=({playlist:s,type:e,onCardHover:t,title:n,watchHistory:a,featured:o=!1,loading:i=!1,error:c=null,accessModel:l,isLoggedIn:d,hasSubscription:h,posterAspect:u,visibleTilesDelta:g=0})=>{const _=Pe(),{t:f}=T("common"),x=(o?Yy[_]:Jy[_])+g,w=p.useCallback(({item:C,isVisible:j})=>{const{mediaid:S,title:E}=C,P=Ae({id:S,title:E,playlistId:s.feedid,play:e===_t.ContinueWatching});return r.jsx($l,{progress:a?a[C.mediaid]:void 0,onHover:typeof t=="function"?()=>t(C):void 0,featured:o,disabled:!j,loading:i,isLocked:zn(l,d,h,C),posterAspect:u,item:C,url:P},C.mediaid)},[a,t,o,i,l,d,h,u,s.feedid,e]),v=p.useCallback(({onClick:C})=>r.jsx("button",{className:jt.chevron,"aria-label":f("slide_next"),onClick:C,children:r.jsx(K,{icon:_n})}),[f]),b=p.useCallback(({onClick:C})=>r.jsx("button",{className:jt.chevron,"aria-label":f("slide_previous"),onClick:C,children:r.jsx(K,{icon:ba})}),[f]),y=({page:C,pages:j})=>{const S=Array.from({length:j},(E,P)=>P);return r.jsxs(r.Fragment,{children:[r.jsx("div",{"aria-live":"polite",className:"hidden",children:f("slide_indicator",{page:C+1,pages:j})}),o&&r.jsx("div",{"aria-hidden":"true",className:jt.dots,children:S.map(E=>r.jsx("span",{className:M(jt.dot,{[jt.active]:C===E})},E))})]})};return c||!(s!=null&&s.playlist)?r.jsx("h2",{className:jt.error,children:"Could not load items"}):r.jsxs("div",{className:M(jt.shelf),children:[o?null:i?r.jsx("div",{className:jt.loadingTitle}):r.jsx("h2",{className:M(jt.title),children:n||s.title}),r.jsx(Ud,{className:jt.slider,items:s.playlist,tilesToShow:x,cycleMode:Hd,showControls:!i,spacing:16,renderLeftControl:b,renderRightControl:v,renderPagination:y,renderTile:w})]})},Zy=ys(Qy,Xy),ev="_infiniteScrollLoader_6rn4e_1",tv={infiniteScrollLoader:ev},Ca=()=>r.jsx("div",{className:tv.infiniteScrollLoader,children:r.jsx(_s,{})}),Vs=({className:s,open:e=!0,duration:t=250,delay:n=0,onOpenAnimationEnd:a,onCloseAnimationEnd:o,keepMounted:i,children:c})=>{const d=`opacity ${t/1e3}s ease-in-out`,h=u=>({transition:d,opacity:u==="opening"||u==="open"?1:0,willChange:"opacity"});return r.jsx(ha,{className:s,createStyle:u=>h(u),open:e,duration:t,delay:n,onOpenAnimationEnd:a,onCloseAnimationEnd:o,keepMounted:i,children:c})},Rl=(s=300,e=30,t)=>{const n=he(()=>{const o=(document.scrollingElement||document.body).scrollTop,i=Math.max(0,Math.min(1,(o-s)/(e-s)));t(i)});p.useEffect(()=>{const{scrollingElement:a,documentElement:o,body:i}=document,c=a&&a!==o&&a!==i?a:window;return c.addEventListener("scroll",n,{passive:!0}),()=>{c.removeEventListener("scroll",n)}},[n])},sv="_shelf_19ep9_1",nv="_chevron_19ep9_19",rv="_loadingTitle_19ep9_47",av="_title_19ep9_55",ov="_poster_19ep9_74",iv="_background_19ep9_108",cv="_image_19ep9_141",lv="_fade_19ep9_148",dv="_fade2_19ep9_157",uv="_swipeSlider_19ep9_171",hv="_swipeSliderMobile_19ep9_178",mv="_metadata_19ep9_183",pv="_error_19ep9_250",fv="_dimmed_19ep9_290",gv="_chevronLeft_19ep9_295",_v="_chevronRight_19ep9_300",yv="_dots_19ep9_304",vv="_dotsList_19ep9_318",xv="_dot_19ep9_304",wv="_dotActive_19ep9_354",bv="_dotPlaceholder_19ep9_363",Ce={shelf:sv,chevron:nv,loadingTitle:rv,title:av,poster:ov,background:iv,image:cv,fade:lv,fade2:dv,swipeSlider:uv,swipeSliderMobile:hv,metadata:mv,error:pv,dimmed:fv,chevronLeft:gv,chevronRight:_v,dots:yv,dotsList:vv,dot:xv,dotActive:wv,dotPlaceholder:bv},Sv="_truncatedText_vuggl_1",jv={truncatedText:Sv},Ol=({text:s,maximumLines:e,className:t})=>r.jsx("div",{className:M(jv.truncatedText,t),style:{maxHeight:`calc(1.5em * ${e})`,WebkitLineClamp:e,lineClamp:e,display:"-webkit-box"},children:r.jsx(Hs,{markdownString:s,inline:!0})}),Cv=["data","isLoading"],qs=s=>{const{accessModel:e}=G(),{user:t,subscription:n}=U(({user:u,subscription:g})=>({user:u,subscription:g}),de),a=q(At,!1),o=s&&!zn(e,!!t,!!n,s),i=(s==null?void 0:s.mediaOffers)||[],c=$c(i.map(({offerId:u})=>({queryKey:["entitlements",u],queryFn:()=>a==null?void 0:a.getEntitlements({offerId:u}),enabled:!!s&&!!t&&!!t.id&&!!u&&!o,refetchOnMount:"always",notifyOnChangeProps:Cv}))),l=!!t&&c.some(u=>{var g,_;return u.isSuccess&&((_=(g=u.data)==null?void 0:g.responseData)==null?void 0:_.accessGranted)}),d=!l&&c.some(u=>u.isLoading);return{isEntitled:!!s&&(o||l),isMediaEntitlementLoading:d,mediaOffers:i}},Dl=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M8,5.14V19.14L19,12.14L8,5.14Z"})),Pv="_progressRail_14udi_1",Ev="_progress_14udi_1",pc={progressRail:Pv,progress:Ev},zs=({item:s,playUrl:e,disabled:t=!1,onClick:n})=>{const{t:a}=T("video"),o=ae(),i=ue(),c=Pe(),l=G(y=>y.accessModel),h=!!U(y=>y.user),u=gt(y=>s&&y.getItem(s)),g=u==null?void 0:u.progress,_=be(y=>y.setRequestedMediaOffers),{isEntitled:f,mediaOffers:x}=qs(s),w=!!x.length,v=p.useMemo(()=>a(f?typeof g=="number"?"continue_watching":"start_watching":w?"buy":h?"complete_your_subscription":"sign_up_to_start_watching"),[f,h,w,g,a]),b=p.useCallback(()=>{if(f){if(n){n();return}return e&&o(e)}return o(h?w?J(i,"choose-offer"):"/u/payments":J(i,"create-account"))},[f,e,o,h,i,w,n]);return p.useEffect(()=>(_(x),()=>_([])),[x,_]),l===Fe.AVOD&&!f?null:r.jsx(F,{color:"primary",variant:"contained",size:"large",label:v,startIcon:f?r.jsx(K,{icon:Dl}):void 0,onClick:b,fullWidth:c<Z.md,disabled:t,children:g?r.jsx("div",{className:pc.progressRail,children:r.jsx("div",{className:pc.progress,style:{width:`${g*100}%`}})}):null})},Pr=({item:s,loading:e,playlistId:t,style:n,hidden:a})=>{const o=ae(),{t:i}=T("common"),l=Pe()<Z.sm;if(!s)return null;const d=!Yt(s,st.hub)&&!Yt(s,st.liveChannel)&&!Yt(s,st.page),u=s.sources.find(g=>g.file.indexOf(".m3u8")>-1||g.file.indexOf(".mp4")>-1)&&d&&!l;return r.jsxs("div",{className:Ce.metadata,"data-testid":void 0,style:{...n,visibility:a?"hidden":void 0},"aria-hidden":a?"true":void 0,children:[r.jsx("h2",{className:M(e?Ce.loadingTitle:Ce.title),children:!e&&(s==null?void 0:s.title)}),r.jsx(Ol,{text:s==null?void 0:s.description,maximumLines:3}),r.jsxs("div",{children:[u&&r.jsx(zs,{item:s,playUrl:Ae({id:s.mediaid,title:s.title,playlistId:t,play:!0})}),r.jsx(F,{label:i("common:more_info"),onClick:()=>o(Ae({id:s.mediaid,title:s.title,playlistId:t})),startIcon:r.jsx(K,{icon:_n}),size:"large",variant:u?void 0:"contained",color:u?void 0:"primary"})]})]})},kv=({item:s,style:e,hidden:t,onTransitionEnd:n})=>{if(!s)return null;const a=s==null?void 0:s.backgroundImage;return r.jsx("div",{style:{...e,visibility:t?"hidden":void 0},"aria-hidden":t?"true":void 0,onTransitionEnd:n,children:r.jsx(Ws,{className:Ce.image,image:a,width:1920,alt:s==null?void 0:s.title})},s.mediaid)},Er=Te.memo(kv),Iv=(s,e,t,n,a)=>{const o=s==="left",i=s==="right",c={semiEdgeLeft:e===t-n+1&&i,edgeLeft:e===t-n,newDotLeft:e===t-n-1,semiEdgeRight:e===t+n-1&&o,edgeRight:e===t+n,newDotRight:e===t+n+1};return c.semiEdgeLeft||c.semiEdgeRight?a:c.edgeLeft?i?0:o?1:a:c.edgeRight?o?0:i?1:a:c.newDotLeft?o?a:0:c.newDotRight?i?a:0:1},Av=({playlist:s,index:e,direction:t,nextIndex:n,setIndex:a,range:o=3,animationDuration:i=200})=>{const{t:c}=T("common"),l=o+1,d=e+l,h=n+l,u=p.useMemo(()=>{const g=Array.from({length:l}).map(()=>!1);return[...g,...s.playlist,...g]},[s.playlist,l]);return r.jsxs(r.Fragment,{children:[r.jsx("div",{"aria-live":"polite",className:"hidden",children:c("slide_indicator",{page:e+1,pages:s.playlist.length})}),r.jsx("nav",{className:Ce.dots,children:r.jsx("ul",{className:Ce.dotsList,children:u.map((g,_)=>{if(_<d-o-1||_>d+o+1)return null;if(!g)return r.jsx("li",{className:M(Ce.dotPlaceholder),"aria-hidden":"true"},_);const x=Math.abs(d-h)*22,v=`translateX(${t==="left"?x:t==="right"?0-x:0}px)`,b=t?`transform ${i}ms ease-out ${i/3}ms, width ${i/2}ms ease-out ${i/3}ms`:"",y=Iv(t,_,d,o,.6),C=`scale(${y})`,j=t?`width ${i}ms ease-out, height ${i}ms ease-out, transform ${i}ms ease-out`:"",S=_===d,E=y!==1,P=E?void 0:c("slide_to",{item:_-l+1,items:s.playlist.length});return r.jsx("li",{"aria-hidden":E||void 0,"aria-current":S||void 0,children:r.jsx("button",{className:M(Ce.dot,_===h&&Ce.dotActive,!t&&_===d&&Ce.dotActive),style:{transform:v,transition:b},"aria-label":P,disabled:E||void 0,onClick:E||S?void 0:()=>a(_-l),children:r.jsx("div",{style:{transform:C,transition:j}})})},g==null?void 0:g.mediaid)})})})]})},Tv=({hasLeftItem:s,hasRightItem:e,renderItem:t,renderLeftItem:n,renderRightItem:a,direction:o,isSwipeAnimation:i,onSwipeLeft:c,onSwipeRight:l})=>{const d=p.useRef({x:0,y:0,start:Date.now()}),h=p.useRef(null),[u,g]=p.useState(null),f=Pe()<=Z.sm,x=he(b=>{o||(d.current={x:b.touches[0].clientX,y:b.touches[0].clientY,start:Date.now()},g(null))}),w=he(b=>{if(o||!h.current)return;const y=b.changedTouches[0].clientX-d.current.x,C=b.changedTouches[0].clientY-d.current.y,j=Math.abs(y)>Math.abs(C)?"slide":"scroll";if(u||g(j),j==="scroll"||u==="scroll")return;b.preventDefault(),b.stopPropagation();const S=e?-window.innerWidth:0,E=s?window.innerWidth:0,P=Math.max(Math.min(y,E),S);h.current.style.transform=`translateX(${P}px)`,h.current.style.transition="none"}),v=he(b=>{if(o||!h.current||u==="scroll")return;const y=d.current.x-b.changedTouches[0].clientX,C=Math.round(y/(Date.now()-d.current.start)*100),j=80;e&&(y>window.innerWidth/2||C>j)?l():s&&(y<-window.innerWidth/2||C<-j)?c():(h.current.style.transition="transform 0.2s ease-out",h.current.style.transform="translateX(0)"),g(null)});return p.useLayoutEffect(()=>{h.current&&(i&&o==="left"?(h.current.style.transition="transform 0.2s ease-out",h.current.style.transform="translateX(100%)"):i&&o==="right"?(h.current.style.transition="transform 0.2s ease-out",h.current.style.transform="translateX(-100%)"):(h.current.style.transform="translateX(0)",h.current.style.transition="none"))},[o,i]),p.useEffect(()=>{const b=h.current;if(b)return b.addEventListener("touchstart",x),b.addEventListener("touchmove",w,{passive:!1}),b.addEventListener("touchend",v),()=>{b.removeEventListener("touchstart",x),b.removeEventListener("touchmove",w),b.removeEventListener("touchend",v)}},[x,w,v]),r.jsxs("div",{ref:h,className:M(Ce.swipeSlider,f&&Ce.swipeSliderMobile),children:[n(u==="slide"),t(),a(u==="slide")]})},Nv=({playlist:s,loading:e=!1,error:t=null})=>{const[n,a]=p.useState(0),[o,i]=p.useState(0),{t:c}=T("common"),d=Pe()<=Z.sm,h=p.useRef(null),[u,g]=p.useState(null),[_,f]=p.useState(null),[x,w]=p.useState(!1);Rl(50,d?200:600,I=>{h.current&&(h.current.style.opacity=`${Math.max(1-I,d?0:.1)}`)});const v=(I,H=!1)=>{_||(i(I),g(I>n?"right":"left"),f("init"),w(H))},b=()=>v(n-1),y=()=>v(n+1),C=()=>v(n-1,!0),j=()=>v(n+1,!0),S=p.useCallback(I=>{I.propertyName==="transform"&&_==="start"&&f("end")},[_]);p.useEffect(()=>{if(u){if(_==="init"){f("start");return}_==="end"&&(a(o),g(null),f(null),w(!1))}},[_,u,o]);const E=_==="start"||_==="end",P=u==="left"?1:u==="right"?-1:0,k=I=>{const H=d?10:40;return I=="left"?{transform:`scale(1.2) translateX(${_==="init"?H*-1:0}px)`,opacity:E?1:0,transition:E?"opacity 0.3s ease-out, transform 0.3s ease-out":"none"}:I=="right"?{transform:`scale(1.2) translateX(${_==="init"?H:0}px)`,opacity:E?1:0,transition:E?"opacity 0.3s ease-out, transform 0.3s ease-out":"none"}:{transform:`scale(1.2) translateX(${E?H*P:0}px)`,opacity:E?0:1,transition:E?`opacity ${d?.3:.1}s ease-out, transform 0.3s ease-in`:"none"}},A=(I,H=!1)=>I==="left"?{left:H||x?"-100%":_==="init"?-60:0,opacity:H||x||E?1:0,transition:E?"opacity 0.2s ease-out, left 0.2s ease-out":"none",pointerEvents:"none"}:I==="right"?{left:H||x?"100%":_==="init"?60:0,opacity:H||x||E?1:0,transition:E?"opacity 0.2s ease-out, left 0.2s ease-out":"none",pointerEvents:"none"}:{left:E&&u?60*P:0,opacity:E?0:1,transition:E?"opacity 0.15s ease-out, left 0.15s ease-out":"none",pointerEvents:E?"none":"initial"},$=s.playlist[n],L=s.playlist[o<n?o:n-1]||null,D=s.playlist[o>n?o:n+1]||null,O=_!=="end"?$:u==="right"?L:D;return t||!(s!=null&&s.playlist)?r.jsx("h2",{className:Ce.error,children:"Could not load items"}):r.jsxs("div",{className:M(Ce.shelf),children:[r.jsxs("div",{className:Ce.poster,ref:h,children:[r.jsxs("div",{className:Ce.background,id:"background",children:[r.jsx(Er,{item:L,style:k("left"),hidden:u!=="left"},(O==null?void 0:O.mediaid)===(L==null?void 0:L.mediaid)?"left-item":L==null?void 0:L.mediaid),r.jsx(Er,{item:O,style:k(),onTransitionEnd:S},O==null?void 0:O.mediaid),r.jsx(Er,{item:D,style:k("right"),hidden:u!=="right"},(O==null?void 0:O.mediaid)===(D==null?void 0:D.mediaid)?"right-item":D==null?void 0:D.mediaid),r.jsx("div",{className:Ce.fade})]}),r.jsx("div",{className:Ce.fade2})]}),r.jsx("button",{className:M(Ce.chevron,Ce.chevronLeft),"aria-label":c("slide_previous"),disabled:!L,onClick:L?b:void 0,children:r.jsx(K,{icon:ba})}),r.jsx(Tv,{direction:u,isSwipeAnimation:x,loading:e,onSwipeLeft:C,onSwipeRight:j,hasLeftItem:!!L,hasRightItem:!!D,renderLeftItem:I=>r.jsx(Pr,{loading:e,item:L,playlistId:s.feedid,style:A("left",I),hidden:u!=="left"&&!I},(O==null?void 0:O.mediaid)===(L==null?void 0:L.mediaid)?"left-item":L==null?void 0:L.mediaid),renderItem:()=>r.jsx(Pr,{loading:e,item:O,playlistId:s.feedid,style:A()},O==null?void 0:O.mediaid),renderRightItem:I=>r.jsx(Pr,{loading:e,item:D,playlistId:s.feedid,style:A("right",I),hidden:u!=="right"&&!I},(O==null?void 0:O.mediaid)===(D==null?void 0:D.mediaid)?"right-item":D==null?void 0:D.mediaid)}),r.jsx("button",{className:M(Ce.chevron,Ce.chevronRight),"aria-label":c("slide_next"),disabled:!D,onClick:D?y:void 0,children:r.jsx(K,{icon:_n})}),r.jsx(Av,{playlist:s,index:n,setIndex:v,nextIndex:o,direction:u||!1})]})},Lv="_shelfList_1mffp_1",$v="_shelfContainer_1mffp_6",Rv="_hero_1mffp_10",Ov="_featured_1mffp_13",An={shelfList:Lv,shelfContainer:$v,hero:Rv,featured:Ov},fc=6,Dv=4,Fl=({rows:s})=>{const{accessModel:e}=G(({accessModel:u})=>({accessModel:u}),de),[t,n]=p.useState(fc),{t:a}=T("error"),o=Xn("title"),i=gt(u=>u.getDictionaryWithSeries()),{user:c,subscription:l}=U(({user:u,subscription:g})=>({user:u,subscription:g}),de),d=ay(s,t);return p.useEffect(()=>()=>n(fc),[s]),d.every(({data:u,isSuccess:g})=>{var _;return g&&!((_=u==null?void 0:u.playlist)!=null&&_.length)})?r.jsx(nt,{title:a("empty_shelves_heading"),message:a("empty_shelves_description")}):r.jsx("div",{className:An.shelfList,children:r.jsx(sa,{style:{overflow:"hidden"},loadMore:()=>n(u=>u+Dv),hasMore:t<s.length,loader:r.jsx(Ca,{},"loader"),useWindow:!1,children:s.slice(0,t).map(({type:u,featured:g,title:_,custom:f},x)=>{var k;const{data:w,isPlaceholderData:v,error:b}=d[x];if(!((k=w==null?void 0:w.playlist)!=null&&k.length))return null;const y=ol(w.cardImageAspectRatio||w.shelfImageAspectRatio),C=il(y),S=(f==null?void 0:f[o])||(w==null?void 0:w[o])||_||(w==null?void 0:w.title),E=(f==null?void 0:f.layoutType)===Wa.hero&&x===0,P=!E&&((f==null?void 0:f.layoutType)===Wa.featured||g);return r.jsx("section",{className:M(An.shelfContainer,{[An.hero]:E,[An.featured]:P}),"data-testid":(`${E?"hero":P?"featured":u==="playlist"?qn(S):u}`,void 0),"aria-label":S,children:r.jsx(Vs,{duration:250,delay:x*33,open:!0,children:E?r.jsx(Nv,{loading:v,error:b,playlist:w}):r.jsx(Zy,{loading:v,error:b,type:u,playlist:w,watchHistory:u===_t.ContinueWatching?i:void 0,title:S,featured:P,accessModel:e,isLoggedIn:!!c,hasSubscription:!!l,posterAspect:y,visibleTilesDelta:C})})},`${x}_${w.id}`)})})})},Fv=()=>{const{config:s}=G(({config:n,accessModel:a})=>({config:n,accessModel:a}),de),e=s==null?void 0:s.content,{t}=T("common");return r.jsxs(r.Fragment,{children:[r.jsx("h1",{className:"hideUntilFocus",children:t("home")}),r.jsx(Fl,{rows:e})]})},Me=gs("UIStore",()=>({searchQuery:"",searchActive:!1,userMenuOpen:!1,sideBarOpen:!1,languageMenuOpen:!1})),Ml=()=>{const s=p.useRef(!0);return p.useEffect(()=>{s.current=!1},[]),s.current},Mv=(s,e)=>{const t=p.useRef(),n=p.useRef(fu((...a)=>{t.current&&t.current(...a)},e));return p.useEffect(()=>{t.current=s},[s]),n.current},Bl=()=>{const s=ae(),e=Mv(a=>{s(`/q/${encodeURIComponent(a)}`)},350),t=p.useCallback(a=>{Me.setState({searchQuery:a}),e(a)},[e]),n=p.useCallback(()=>{const a=Me.getState().preSearchPage;Me.setState({searchQuery:"",preSearchPage:void 0}),s(a||"/")},[s]);return{updateSearchQuery:t,resetSearchQuery:n}},Bv=al(30),Uv=({siteId:s,enabled:e,query:t})=>{const n=q(Le);return We(["app-search",t],async()=>await n.getContentSearch({siteId:s,params:{searchTerm:t}}),{placeholderData:e?Bv:void 0,enabled:e,staleTime:ps,cacheTime:ms})},Hv=s=>{var c,l;const{config:e}=G(({config:d})=>({config:d}),de),t=e==null?void 0:e.siteId,n=(c=e==null?void 0:e.features)==null?void 0:c.searchPlaylist,a=fs((l=e==null?void 0:e.custom)==null?void 0:l.appContentSearch),o=gn(n||"",{search:s||""},!a,!!s),i=Uv({siteId:t,enabled:a,query:s});return a?{data:i.data,isFetching:i.isFetching,error:i.error}:{isFetching:o.isFetching,error:o.error,data:o.data}},Wv="_row_gdady_1",Vv="_cell_gdady_5",gc={row:Wv,cell:Vv},qv=gu(function(s){s.scrollIntoView({behavior:"smooth",block:"center"})},300),zv=({className:s,columnCount:e,data:t,renderCell:n,getCellKey:a})=>{const[o,i]=p.useState(0),[c,l]=p.useState(0),d=p.useRef(null),h=Math.ceil(t.length/e),u=(f,x)=>{const w=document.getElementById(`layout_grid_${f}-${x}`),b=(w==null?void 0:w.querySelector('button, a, input, [tabindex]:not([tabindex="-1"])'))||w;i(f),l(x),b&&(b.focus({preventScroll:!0}),qv(b))},g=he(f=>{const{key:x,ctrlKey:w}=f;if(!["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(x))return;f.preventDefault();const v=h-1,b=c===0,y=c===e-1,C=o===0,j=o===v,S=(t.length%e||e)-1,E=j?S:e-1,P=Math.min(o+1,v),k=Math.max(o-1,0);switch(x){case"ArrowLeft":return b&&!C?u(k,e-1):u(o,Math.max(c-1,0));case"ArrowRight":return y&&!j?u(P,0):u(o,Math.min(c+1,E));case"ArrowUp":return u(k,c);case"ArrowDown":return u(P,P===v?Math.min(c,S):c);case"Home":return u(w?0:o,0);case"End":return w?u(v,S):u(o,E);case"PageUp":return u(k,c);case"PageDown":return u(P,P===v?Math.min(S,c):c);default:return}});p.useEffect(()=>{var x;if(!((x=d.current)!=null&&x.contains(document.activeElement)))return;const f=(t.length%e||e)-1;if(c>e-1)return u(o,e-1);if(o===h-1&&c>f)return u(o,f)},[e]);const _=p.useMemo(()=>({width:`${Math.floor(100/e*100)/100}%`}),[e]);return r.jsx("div",{role:"grid",ref:d,"aria-rowcount":h,className:s,onKeyDown:g,children:Array.from({length:h}).map((f,x)=>r.jsx("div",{role:"row","aria-rowindex":x+1,className:gc.row,children:t.slice(x*e,x*e+e).map((w,v)=>r.jsx("div",{role:"gridcell",id:`layout_grid_${x}-${v}`,"aria-colindex":v+1,className:gc.cell,style:_,children:n(w,o===x&&c===v?0:-1)},a(w)))},x))})},Gv="_cell_1jw02_1",Kv="_container_1jw02_6",_c={cell:Gv,container:Kv,"cols-1":"_cols-1_1jw02_10","cols-2":"_cols-2_1jw02_13","cols-3":"_cols-3_1jw02_16","cols-4":"_cols-4_1jw02_19","cols-5":"_cols-5_1jw02_22","cols-6":"_cols-6_1jw02_25","cols-7":"_cols-7_1jw02_28","cols-8":"_cols-8_1jw02_31","cols-9":"_cols-9_1jw02_34","cols-10":"_cols-10_1jw02_37"},yc=6,Jv=4,Yv={[Z.xs]:2,[Z.sm]:2,[Z.md]:3,[Z.lg]:4,[Z.xl]:5},Qv=Symbol("CARD_GRID"),Xv=s=>s.mediaid;function Zv({playlist:s,watchHistory:e,isLoading:t=!1,cols:n=Yv,currentCardItem:a,currentCardLabel:o,accessModel:i,isLoggedIn:c,hasSubscription:l,hasMore:d,getUrl:h,loadMore:u,onCardHover:g,headingLevel:_}){const f=Pe(),x=ol(s.cardImageAspectRatio||s.shelfImageAspectRatio),w=n[f]+il(x),[v,b]=p.useState(yc),y=()=>b(S=>S+Jv),C=v*w<s.playlist.length;p.useEffect(()=>{b(yc)},[s.feedid]);const j=p.useCallback((S,E)=>r.jsx($l,{tabIndex:E,progress:e?e[S.mediaid]:void 0,url:h(S),onHover:typeof g=="function"?()=>g(S):void 0,loading:t,isCurrent:a&&a.mediaid===S.mediaid,currentLabel:o,isLocked:zn(i,c,l,S),posterAspect:x,item:S,headingLevel:_}),[i,a,o,h,l,_,t,c,g,x,e]);return r.jsx(sa,{pageStart:0,loadMore:u??y,hasMore:d??C,loader:r.jsx(Ca,{},"loader"),useWindow:!1,children:r.jsx(zv,{className:M(_c.container,_c[`cols-${w}`]),data:u?s.playlist:s.playlist.slice(0,v*w),columnCount:w,renderCell:j,getCellKey:Xv})})}const Zn=ys(Qv,Zv),ex="_search_1fatj_1",tx="_header_1fatj_17",sx="_error_1fatj_33",nx="_subHeading_1fatj_38",Tn={search:ex,header:tx,error:sx,subHeading:nx},rx=()=>{const{t:s}=T("search"),{config:e,accessModel:t}=G(({config:b,accessModel:y})=>({config:b,accessModel:y}),de),{siteName:n,features:a}=e,o=ht("search_heading"),i=Ml(),c=Me(b=>b.searchQuery),{updateSearchQuery:l}=Bl(),h=Fs()["*"],{isFetching:u,error:g,data:_}=Hv(h||""),{user:f,subscription:x}=U(({user:b,subscription:y})=>({user:b,subscription:y}),de),w=b=>Ae({id:b.mediaid,title:b.title,playlistId:a==null?void 0:a.searchPlaylist}),v=p.useMemo(()=>u?s("heading"):h?_!=null&&_.playlist.length?s("title",{count:_.playlist.length,query:h}):s("no_results_heading",{query:h}):s("start_typing"),[u,_==null?void 0:_.playlist.length,h,s]);return p.useEffect(()=>{i&&h&&h!==c&&l(h)},[i,h,c,l]),p.useEffect(()=>()=>{Me.setState({searchQuery:"",searchActive:!1})},[]),(g||!_)&&!u?r.jsxs(nt,{title:s("error_heading"),children:[r.jsx("h2",{className:Tn.subHeading,children:s("error_subheading")}),r.jsx("p",{children:s("error_description")})]}):h?_!=null&&_.playlist.length?r.jsxs("div",{className:Tn.search,children:[r.jsx(It,{children:r.jsxs("title",{children:[v," - ",n]})}),r.jsx("header",{className:Tn.header,children:r.jsx("h2",{id:o,"aria-live":u?void 0:"polite",children:v})}),r.jsx(Zn,{"aria-labelledby":o,getUrl:w,playlist:_,isLoading:i,accessModel:t,isLoggedIn:!!f,hasSubscription:!!x})]}):r.jsxs(r.Fragment,{children:[r.jsx(It,{children:r.jsxs("title",{children:[v," - ",n]})}),r.jsxs(nt,{title:v,children:[r.jsx("h2",{className:Tn.subHeading,children:s("suggestions")}),r.jsxs("ul",{children:[r.jsx("li",{children:s("tip_one")}),r.jsx("li",{children:s("tip_two")}),r.jsx("li",{children:s("tip_three")})]})]})]}):r.jsx(nt,{title:v})},Pa=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M12,19.2C9.5,19.2 7.29,17.92 6,16C6.03,14 10,12.9 12,12.9C14,12.9 17.97,14 18,16C16.71,17.92 14.5,19.2 12,19.2M12,5A3,3 0 0,1 15,8A3,3 0 0,1 12,11A3,3 0 0,1 9,8A3,3 0 0,1 12,5M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z"})),Ul=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M5,3C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V16.72C21.59,16.37 22,15.74 22,15V9C22,8.26 21.59,7.63 21,7.28V5A2,2 0 0,0 19,3H5M5,5H19V7H13A2,2 0 0,0 11,9V15A2,2 0 0,0 13,17H19V19H5V5M13,9H20V15H13V9M16,10.5A1.5,1.5 0 0,0 14.5,12A1.5,1.5 0 0,0 16,13.5A1.5,1.5 0 0,0 17.5,12A1.5,1.5 0 0,0 16,10.5Z"})),Hl=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M19,3H5C3.89,3 3,3.89 3,5V9H5V5H19V19H5V15H3V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M10.08,15.58L11.5,17L16.5,12L11.5,7L10.08,8.41L12.67,11H3V13H12.67L10.08,15.58Z"})),Ea=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})),ax="_title_gkrmh_1",ox="_body_gkrmh_8",ix="_confirmButton_gkrmh_12",vc={title:ax,body:ox,confirmButton:ix},ka=({open:s,message:e,onClose:t,isSuccess:n,actionsOverride:a,titleOverride:o})=>{const{t:i}=T("common"),c=ht("alert-heading");return r.jsxs(pa,{open:s,onClose:t,role:"alertdialog","aria-modal":"true","aria-labelledby":c,children:[r.jsx("h2",{id:c,className:vc.title,children:o??i(n?"alert.success":"alert.title")}),r.jsx("p",{className:vc.body,children:e}),a??r.jsx(F,{label:i("alert.close"),variant:"outlined",onClick:t,fullWidth:!0})]})},cx="_flexBox_17rhj_1",lx="_controls_17rhj_9",dx="_submitConsents_17rhj_16",xc={flexBox:cx,controls:lx,submitConsents:dx};function ux({className:s,panelHeaderClassName:e,label:t,editButton:n,saveButton:a,cancelButton:o,onSubmit:i,content:c,readOnly:l=!1}){const d=ht(t),{formState:{values:h,activeSectionId:u,errors:g,isBusy:_},setFormState:f,isLoading:x,onCancel:w}=p.useContext(Wl),v=d===u,b=p.useCallback(({currentTarget:j})=>{if(!j)return;const{name:S,type:E}=j,P=E==="checkbox"?j.checked:j.value;v||w(),f(k=>{const A={...k.values};return S.split(".").reduce(($,L,D,O)=>(D===O.length-1?$[L]=P:$[L]={...$[L]},$[L]),A),{...k,values:A,activeSectionId:d}})},[v,w,d,f]),y=p.useCallback(async function(S){var E;if(S&&S.preventDefault(),i){let P;try{f(k=>({...k,isBusy:!0,errors:[]})),P=await i(h)}catch(k){P={errors:Array.of(k instanceof Error?k.message:k)}}if((E=P==null?void 0:P.errors)!=null&&E.length){f(k=>({...k,errors:P==null?void 0:P.errors,isBusy:!1}));return}}f(P=>({...P,activeSectionId:void 0,isBusy:!1}))},[i,f,h]),C=p.useCallback(function(){v||(w(),f(S=>({...S,activeSectionId:d})))},[v,w,d,f]);return r.jsxs("section",{"aria-labelledby":d,className:s,children:[r.jsx("div",{className:e,children:r.jsx("h2",{id:d,children:t})}),_&&v&&r.jsx(Se,{transparentBackground:!0}),c&&r.jsx("form",{className:xc.flexBox,noValidate:!0,onSubmit:j=>j.preventDefault(),children:c({values:h,isEditing:v,isBusy:_,onChange:b,...v?{errors:g}:{}})}),(a||n||o)&&r.jsx("div",{className:xc.controls,children:v?r.jsxs(r.Fragment,{children:[a&&r.jsx(F,{label:a,type:"submit",onClick:y,disabled:x}),o&&r.jsx(F,{label:o,type:"reset",variant:"text",onClick:w})]}):!l&&n&&(typeof n=="object"?n:r.jsx(F,{label:n,type:"button",onClick:C,disabled:x}))})]})}const Wl=p.createContext(void 0);function hx({isLoading:s,initialValues:e,onReset:t,children:n}){const[a,o]=p.useState({values:e,activeSectionId:void 0,isDirty:!1,isBusy:!1}),i=p.useCallback(function(){o(l=>({...l,values:e,isDirty:!1,activeSectionId:void 0,success:!1,errors:void 0})),t&&t()},[e,t]);return p.useEffect(()=>{a.activeSectionId||o(c=>({...c,values:e}))},[e,a.activeSectionId]),r.jsx(Wl.Provider,{value:{isLoading:s,onCancel:i,formState:a,setFormState:o},children:n==null?void 0:n.map((c,l)=>r.jsx(ux,{...c},l))})}const mx="_textWithButtonContainer_1cz0o_1",px="_customFields_1cz0o_7",kr={textWithButtonContainer:mx,customFields:px},fx=({panelClassName:s,panelHeaderClassName:e,canUpdateEmail:t=!0})=>{var ee,Q;const n=q(ye),{t:a,i18n:o}=T("user"),i=Ke(),c=ae(),l=ue(),[d,h]=fa(),u=dt(n.exportAccountData),[g,_]=p.useState(!1),f=u.isSuccess?a("account.export_data_success"):a("account.export_data_error"),x=o.language!==W.APP_DEFAULT_LANGUAGE?W.APP_DEFAULT_LANGUAGE:void 0;p.useEffect(()=>{(u.isSuccess||u.isError)&&_(!0)},[u.isSuccess,u.isError]);const{customer:w,customerConsents:v,publisherConsents:b}=U(({user:N,customerConsents:R,publisherConsents:Y})=>({customer:N,customerConsents:R,publisherConsents:Y}),de),{canChangePasswordWithOldPassword:y,canExportAccountData:C,canDeleteAccount:j}=n.getFeatures(),S=(ee=w==null?void 0:w.metadata)==null?void 0:ee.register_source,E=S&&S!=="inplayer"||!1,P=E&&!((Q=w==null?void 0:w.metadata)!=null&&Q.has_password)||!1;p.useEffect(()=>{if(!b){n.getPublisherConsents();return}},[n,b]);const[k,A]=p.useMemo(()=>{const N=[],R=[];return b==null||b.forEach(Y=>{!(Y!=null&&Y.type)||(Y==null?void 0:Y.type)==="checkbox"?N.push(Y):R.push(Y)}),[N,R]},[b]),$=p.useMemo(()=>Nh(b,v),[b,v]),L=p.useMemo(()=>Th(b,v),[b,v]),D=p.useMemo(()=>({...w,consents:$,consentsValues:L,confirmationPassword:""}),[w,$,L]),O=N=>{const R=ea.sanitize(N),Y=/<a(.|\n)*?>/.test(R),z=/<\/a(.|\n)*?>/.test(R);return Y&&z?r.jsx("span",{dangerouslySetInnerHTML:{__html:N}}):N};function I(N){const R={};return N==null||N.flatMap(Y=>Y.split(",")).forEach(Y=>{switch(Y.trim()){case"Invalid param email":R.form=a("account.errors.validation_error"),R.email=a("account.errors.invalid_param_email");break;case"Customer email already exists":R.form=a("account.errors.validation_error"),R.email=a("account.errors.email_exists");break;case"Please enter a valid e-mail address.":R.form=a("account.errors.validation_error"),R.email=a("account.errors.please_enter_valid_email");break;case"Invalid confirmationPassword":{R.form=a("account.errors.validation_error"),R.confirmationPassword=a("account.errors.invalid_password");break}case"firstName can have max 50 characters.":{R.form=a("account.errors.validation_error"),R.firstName=a("account.errors.first_name_too_long");break}case"lastName can have max 50 characters.":{R.form=a("account.errors.validation_error"),R.lastName=a("account.errors.last_name_too_long");break}case"Email update not supported":{R.form=a("account.errors.email_update_not_supported");break}case"Wrong email/password combination":{R.form=a("account.errors.wrong_combination");break}default:{R.form=a("account.errors.unknown_error"),Ue("Account","Unknown error",{error:Y});break}}}),R}function H(N){return{...N,className:s,panelHeaderClassName:e,saveButton:a("account.save"),cancelButton:a("account.cancel"),content:R=>{var z;const Y=I(R.errors);return r.jsxs(r.Fragment,{children:[Y!=null&&Y.form?r.jsx(Oe,{variant:"error",children:Y.form}):null,(z=N.content)==null?void 0:z.call(N,{...R,errors:Y})]})}}}const X=async()=>{if(w){if(E&&P)return await n.resetPassword(w.email,""),c(J(l,"add-password"));c(J(l,y?"edit-password":"reset-password"))}};return r.jsxs(r.Fragment,{children:[r.jsx("h1",{className:"hideUntilFocus",children:a("nav.account")}),r.jsx(hx,{initialValues:D,children:[H({label:a("account.about_you"),editButton:a("account.edit_information"),onSubmit:async N=>{const R=Fn(b,{...N.metadata,...N.consentsValues}),Y=await n.updateUser({firstName:N.firstName||"",lastName:N.lastName||"",metadata:{...N.metadata,...Gr(R),consents:JSON.stringify(R)}});return i(a("account.update_success",{section:a("account.about_you")}),"success"),Y},content:N=>{var R,Y,z,re;return r.jsxs(r.Fragment,{children:[r.jsx(pe,{name:"firstName",label:a("account.firstname"),value:N.values.firstName||"",onChange:N.onChange,error:!!((R=N.errors)!=null&&R.firstName),helperText:(Y=N.errors)==null?void 0:Y.firstName,disabled:N.isBusy,editing:N.isEditing,autoComplete:"given-name",lang:x}),r.jsx(pe,{name:"lastName",label:a("account.lastname"),value:N.values.lastName||"",onChange:N.onChange,error:!!((z=N.errors)!=null&&z.lastName),helperText:(re=N.errors)==null?void 0:re.lastName,disabled:N.isBusy,editing:N.isEditing,autoComplete:"family-name",lang:x})]})}}),H({label:a("account.email"),onSubmit:async N=>{if(!N.email||!N.confirmationPassword)throw new Error("Wrong email/password combination");const R=await n.updateUser({email:N.email||"",confirmationPassword:N.confirmationPassword});return i(a("account.update_success",{section:a("account.email")}),"success"),R},editButton:a("account.edit_account"),readOnly:!t,content:N=>{var R,Y,z,re;return r.jsxs(r.Fragment,{children:[r.jsx(pe,{name:"email",label:a("account.email"),value:N.values.email||"",onChange:N.onChange,error:!!((R=N.errors)!=null&&R.email),helperText:(Y=N.errors)==null?void 0:Y.email,disabled:N.isBusy,editing:N.isEditing,autoComplete:"email",required:!0}),N.isEditing&&r.jsx(pe,{name:"confirmationPassword",label:a("account.confirm_password"),value:N.values.confirmationPassword,onChange:N.onChange,error:!!((z=N.errors)!=null&&z.confirmationPassword),helperText:(re=N.errors)==null?void 0:re.confirmationPassword,type:d?"text":"password",disabled:N.isBusy,autoComplete:"current-password",rightControl:r.jsx(Ge,{"aria-label":a("account.view_password"),onClick:()=>h(),"aria-pressed":d,children:r.jsx(K,{icon:d?ga:_a})}),required:!0})]})}}),H({label:a("account.security"),editButton:r.jsx(F,{label:a(P?"account.add_password":"account.edit_password"),type:"button",onClick:()=>w?X():null})}),H({label:a("account.terms_and_tracking"),saveButton:a("account.update_consents"),onSubmit:async N=>{const R=await n.updateConsents(Fn(b,N.consentsValues));return i(a("account.update_success",{section:a("account.terms_and_tracking")}),"success"),R},content:N=>r.jsx(r.Fragment,{children:k==null?void 0:k.map((R,Y)=>{var z;return r.jsx(Qn,{name:`consentsValues.${R.name}`,checked:fs((z=N.values.consentsValues)==null?void 0:z[R.name]),onChange:N.onChange,checkboxLabel:O(R.label),disabled:R.required||N.isBusy,required:R.required,lang:x},Y)})})}),(A==null?void 0:A.length)&&H({label:a("account.other_registration_details"),saveButton:a("account.update_consents"),onSubmit:N=>n.updateConsents(Fn(b,N.consentsValues)),content:N=>r.jsx("div",{className:kr.customFields,"data-testid":void 0,children:A.map(R=>r.jsx(Nl,{type:R.type,name:`consentsValues.${R.name}`,options:R.options,label:O(R.label),placeholder:R.placeholder,value:N.values.consentsValues[R.name],disabled:R.type==="checkbox"&&R.required||N.isBusy,onChange:N.onChange,required:R.required},R.name))})}),C&&H({label:a("account.export_data_title"),content:N=>r.jsxs("div",{className:kr.textWithButtonContainer,children:[r.jsx("div",{children:r.jsx(Wd,{t:a,i18nKey:"account.export_data_body",values:{email:N.values.email}})}),r.jsx("div",{children:r.jsx(F,{label:a("account.export_data_title"),type:"button",disabled:u.isLoading,onClick:async()=>{u.mutate()}})})]})}),j&&H({label:a("account.delete_account.title"),content:()=>r.jsxs("div",{className:kr.textWithButtonContainer,children:[r.jsx("div",{children:a("account.delete_account.body")}),r.jsx("div",{children:r.jsx(F,{label:a("account.delete_account.title"),type:"button",variant:"danger",onClick:()=>{c(J(l,P?"warning-account-deletion":"delete-account"))}})})]})})].filter(wu)}),C&&r.jsx(ka,{open:g,message:f,onClose:()=>_(!1),isSuccess:u.isSuccess})]})},gx="_header_ljwt2_1",_x={header:gx},yx={[Z.xs]:2,[Z.sm]:3,[Z.md]:3,[Z.lg]:3,[Z.xl]:3},vx=({playlist:s,accessModel:e,hasSubscription:t,onCardHover:n,onClearFavoritesClick:a})=>{const{t:o}=T("user"),i=c=>Ae({id:c.mediaid,title:c.title,playlistId:c.feedid});return r.jsxs("div",{children:[r.jsxs("div",{className:_x.header,children:[r.jsx("h1",{children:o("favorites.title")}),s.playlist.length>0?r.jsx(F,{label:o("favorites.clear"),onClick:a}):null]}),s.playlist.length>0?r.jsx(Zn,{getUrl:i,playlist:s,onCardHover:n,cols:yx,isLoading:!1,accessModel:e,isLoggedIn:!0,hasSubscription:t}):r.jsx("p",{children:o("favorites.no_favorites")})]})},xx=(s,e,t,n)=>{const a=q(ye),o=q(At),i=dt(a.updateUser,{onSuccess:()=>{U.setState({loading:!1})}});return dt(o.changeSubscription,{onSuccess:()=>{!s&&e&&i.mutate({firstName:(t==null?void 0:t.firstName)||"",lastName:(t==null?void 0:t.lastName)||"",metadata:{[`${n}_pending_downgrade`]:e}})}})},wx="_user_15a6w_1",bx="_leftColumn_15a6w_18",Sx="_button_15a6w_29",jx="_logoutLi_15a6w_41",Cx="_mainColumn_15a6w_50",Px="_panel_15a6w_55",Ex="_panelHeader_15a6w_73",kx="_checkbox_15a6w_86",Xe={user:wx,leftColumn:bx,button:Sx,logoutLi:jx,mainColumn:Cx,panel:Px,panelHeader:Ex,checkbox:kx},Ix=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"})),Ax="_offerSwitchContainer_booqe_1",Tx="_activeOfferSwitchContainer_booqe_13",Nx="_offerSwitchInfoContainer_booqe_18",Lx="_offerSwitchPlanContainer_booqe_28",$x="_currentPlanHeading_booqe_36",Rx="_activeCurrentPlanHeading_booqe_41",Ox="_nextBillingDate_booqe_45",Dx="_price_booqe_51",Fx="_paymentFrequency_booqe_57",Rt={offerSwitchContainer:Ax,activeOfferSwitchContainer:Tx,offerSwitchInfoContainer:Nx,offerSwitchPlanContainer:Lx,currentPlanHeading:$x,activeCurrentPlanHeading:Rx,nextBillingDate:Ox,price:Dx,paymentFrequency:Fx},Mx=({isCurrentOffer:s,pendingDowngradeOfferId:e,offer:t,selected:n,onChange:a,expiresAt:o})=>{const{t:i,i18n:c}=T(["user","account"]),{customerPriceInclTax:l,customerCurrency:d,period:h}=t,u=e===t.offerId;return r.jsxs("div",{className:M(Rt.offerSwitchContainer,{[Rt.activeOfferSwitchContainer]:n}),children:[r.jsx(Qn,{disabled:u,name:t.offerId,checked:n,onChange:()=>a(t.offerId)}),r.jsxs("div",{className:Rt.offerSwitchInfoContainer,children:[(s||u)&&r.jsxs("div",{className:M(Rt.currentPlanHeading,{[Rt.activeCurrentPlanHeading]:n}),children:[s&&i("user:payment.current_plan").toUpperCase(),u&&i("user:payment.pending_downgrade").toUpperCase()]}),r.jsxs("div",{className:Rt.offerSwitchPlanContainer,children:[r.jsx("div",{children:i(`user:payment.${h==="month"?"monthly":"annual"}_subscription`)}),(s||u)&&o&&r.jsxs("div",{className:Rt.nextBillingDate,children:[s&&!e&&i("user:payment.next_billing_date_on",{date:Pt(new Date(o*1e3),c.language)}),u&&i("user:payment.downgrade_on",{date:Pt(new Date(o*1e3),c.language)})]})]})]}),r.jsxs("div",{className:Rt.price,children:[lt(l,d,void 0),r.jsxs("span",{className:Rt.paymentFrequency,children:["/",i(`account:periods.${h}_one`)]})]})]})},Bx="_infoBox_6csa0_1",Ux="_transactionItem_6csa0_22",Hx="_pendingSwitch_6csa0_31",Wx="_transactionDetails_6csa0_36",Vx="_transactionPrice_6csa0_56",qx="_price_6csa0_60",zx="_explanation_6csa0_69",Gx="_cardDetails_6csa0_73",Kx="_paypal_6csa0_78",Jx="_upgradeSubscription_6csa0_90",Yx="_changePlanContainer_6csa0_99",Qx="_changePlanButtons_6csa0_105",Xx="_changePlanCancelButton_6csa0_112",Zx="_editCard_6csa0_116",qe={infoBox:Bx,transactionItem:Ux,pendingSwitch:Hx,transactionDetails:Wx,transactionPrice:Vx,price:qx,explanation:zx,cardDetails:Gx,paypal:Kx,upgradeSubscription:Jx,changePlanContainer:Yx,changePlanButtons:Qx,changePlanCancelButton:Xx,editCard:Zx},wc=4,ew=({accessModel:s,activePaymentDetail:e,activeSubscription:t,pendingOffer:n,transactions:a,customer:o,isLoading:i,panelClassName:c,panelHeaderClassName:l,onShowAllTransactionsClick:d,showAllTransactions:h,onShowReceiptClick:u,canRenewSubscription:g=!1,canShowReceipts:_=!1,canUpdatePaymentMethod:f,onUpgradeSubscriptionClick:x,offerSwitchesAvailable:w,offers:v=[],pendingDowngradeOfferId:b="",changeSubscriptionPlan:y,onChangePlanClick:C,selectedOfferId:j,setSelectedOfferId:S,isUpgradeOffer:E,setIsUpgradeOffer:P,isExternalPaymentProvider:k,paymentProvider:A,paymentProviderLink:$})=>{var Ee;const L=ht("subscription-details"),D=ht("payment-method"),O=ht("billing-history"),{t:I,i18n:H}=T(["user","account"]),X=a?(a==null?void 0:a.length)-wc:0,ee=X>0,Q=ae(),N=ue(),R=(t==null?void 0:t.period)==="granted",z=Pe()===Z.xs,[re,$e]=p.useState(!1);p.useEffect(()=>{re||S((t==null?void 0:t.accessFeeId)??null)},[t,re,S]),p.useEffect(()=>{$e(!1)},[t==null?void 0:t.status,t==null?void 0:t.pendingSwitchId]),p.useEffect(()=>{var se,Ve;j&&v&&P((((se=v.find(Je=>Je.offerId===j))==null?void 0:se.customerPriceInclTax)??0)>(((Ve=v.find(Je=>Je.offerId===(t==null?void 0:t.accessFeeId)))==null?void 0:Ve.customerPriceInclTax)??0))},[j,v,t,P]);function me(){Q(J(N,"choose-offer"))}function je(){Q(J(N,"edit-card"))}function ce(){Q(J(N,"unsubscribe"))}function ve(){Q(J(N,"renew-subscription"))}function V(se){switch(se){case"month":return I("user:payment.monthly_subscription");case"year":return I("user:payment.annual_subscription");case"day":return I("user:payment.daily_subscription");case"week":return I("user:payment.weekly_subscription");case"granted":return I("user:payment.granted_subscription");default:return I("user:payment.other")}}const oe=!k&&w||!re&&!g;return r.jsxs(r.Fragment,{children:[r.jsx(ka,{isSuccess:!y.isError,message:y.isError?I("user:payment.change_plan_error"):E?I("user:payment.upgrade_plan_success"):I("user:payment.downgrade_plan_success",{date:(t==null?void 0:t.expiresAt)&&Pt(new Date(t.expiresAt*1e3),H.language)}),open:re&&(y.isSuccess||y.isError),onClose:()=>{y.reset(),$e(!1)}}),r.jsx("h1",{className:"hideUntilFocus",children:I("nav.payments")}),s===Fe.SVOD&&r.jsxs("section",{"aria-labelledby":L,className:c,children:[r.jsx("div",{className:l,children:r.jsx("h2",{id:L,children:I(re?"user:payment.change_plan":"user:payment.subscription_details")})}),t?r.jsxs(Te.Fragment,{children:[!re&&r.jsxs("div",{className:qe.infoBox,children:[r.jsxs("p",{children:[r.jsx("strong",{children:V(t.period)})," ",r.jsx("br",{}),t.status==="active"&&!R&&!b?I("user:payment.next_billing_date_on",{date:Pt(new Date(t.expiresAt*1e3),H.language)}):I("user:payment.subscription_expires_on",{date:Pt(new Date(t.expiresAt*1e3),H.language)}),(n||b)&&t.status!=="cancelled"&&r.jsx("span",{className:qe.pendingSwitch,children:I("user:payment.pending_offer_switch",{title:V((n==null?void 0:n.period)||((Ee=v.find(se=>se.offerId===b))==null?void 0:Ee.period)||"month")})})]}),!R&&r.jsxs("p",{className:qe.price,children:[r.jsx("strong",{children:lt(t.nextPaymentPrice,t.nextPaymentCurrency,o.country)}),r.jsxs("small",{children:["/",I(`account:periods.${t.period}`)]})]})]},t.subscriptionId),k?r.jsxs("p",{className:qe.explanation,children:[I("account:external_payment.explanation",{paymentProvider:A})," ",r.jsx(ln,{href:$,target:"_blank",children:I("account:external_payment.manage_subscription")})]}):oe&&r.jsx(F,{className:qe.upgradeSubscription,label:I("user:payment.change_subscription"),disabled:!g&&t.status==="cancelled",onClick:()=>{v.length>1&&!g?$e(!0):x==null||x()},fullWidth:z,color:"primary","data-testid":"change-subscription-button"}),(t.status==="active"||t.status==="active_trial")&&!R&&!re&&g?r.jsx(F,{label:I("user:payment.cancel_subscription"),onClick:ce,fullWidth:z,"data-testid":"cancel-subscription-button"}):g?r.jsx(F,{label:I("user:payment.renew_subscription"),onClick:ve}):null]}):i?null:r.jsxs(Te.Fragment,{children:[r.jsx("p",{children:I("user:payment.no_subscription")}),r.jsx(F,{variant:"contained",color:"primary",label:I("user:payment.complete_subscription"),onClick:me})]}),re&&r.jsxs("div",{className:qe.changePlanContainer,children:[v.filter(se=>se.planSwitchEnabled).map(se=>r.jsx(Mx,{isCurrentOffer:se.offerId===(t==null?void 0:t.accessFeeId),pendingDowngradeOfferId:b,offer:se,selected:j===se.offerId,onChange:Ve=>S(Ve),expiresAt:t==null?void 0:t.expiresAt},se.offerId)),r.jsxs("div",{className:qe.changePlanButtons,children:[r.jsx(F,{label:I("user:account.save"),onClick:C,disabled:j===(t==null?void 0:t.accessFeeId)||y.isLoading}),r.jsx(F,{label:I("user:account.cancel"),onClick:()=>$e(!1),variant:"text"}),(t==null?void 0:t.status)!=="cancelled"&&r.jsx(F,{className:qe.changePlanCancelButton,label:I("user:payment.cancel_subscription"),onClick:ce,variant:"danger","data-testid":"cancel-subscription-button"})]})]})]}),r.jsxs("section",{"aria-labelledby":D,className:c,children:[r.jsx("div",{className:l,children:r.jsx("h2",{id:D,children:I("user:payment.payment_method")})}),e?e.paymentMethod==="paypal"?r.jsxs("div",{children:[r.jsxs("div",{className:qe.paypal,children:[r.jsx(K,{icon:ya})," ",I("account:payment.paypal")]}),e.currency]}):r.jsxs("div",{children:[r.jsx(pe,{label:I("user:payment.card_number"),name:"cardNumber",value:`•••• •••• •••• ${e.paymentMethodSpecificParams.lastCardFourDigits||""}`,"aria-label":I("user:payment.card_number_hidden",{number:e.paymentMethodSpecificParams.lastCardFourDigits}),editing:!1,autoComplete:"cc-number"}),r.jsxs("div",{className:qe.cardDetails,children:[r.jsx(pe,{label:I("user:payment.expiry_date"),name:"cardExpiry",value:e.paymentMethodSpecificParams.cardExpirationDate,editing:!1,autoComplete:"cc-exp"}),r.jsx(pe,{label:I("user:payment.security_code"),name:"cardSecurityCode",value:"******",editing:!1,"aria-label":I("user:payment.security_code_hidden"),autoComplete:"cc-csc"})]}),r.jsx(F,{className:M({[qe.editCard]:f}),label:I("account:payment.edit_card"),variant:"outlined",onClick:je})]},e.id):r.jsx("div",{children:r.jsx("p",{children:!i&&I("user:payment.no_payment_methods")})}),f&&r.jsx(F,{label:I("user:payment.update_payment_details"),type:"button",onClick:()=>Q(J(N,"payment-method"))})]}),r.jsxs("section",{"aria-labelledby":O,className:c,children:[r.jsx("div",{className:l,children:r.jsx("h2",{id:O,children:I("user:payment.billing_history")})}),a!=null&&a.length?r.jsxs(Te.Fragment,{children:[a==null?void 0:a.slice(0,h?9999:wc).map(se=>r.jsxs("div",{className:qe.infoBox,children:[r.jsxs("p",{className:qe.transactionItem,children:[r.jsx("strong",{children:Pt(new Date(se.transactionDate*1e3),H.language)}),r.jsx("span",{children:se.offerTitle}),r.jsx("span",{children:se.transactionId})]}),r.jsxs("div",{className:qe.transactionDetails,children:[r.jsx("div",{className:qe.transactionPrice,children:!R&&I("user:payment.price_paid_with",{price:lt(parseFloat(se.transactionPriceInclTax),se.transactionCurrency,se.customerCountry),method:se.paymentMethod})}),_&&r.jsx(Ge,{"aria-label":I("user:payment.show_receipt"),onClick:()=>!i&&u((se==null?void 0:se.trxToken)??se.transactionId),children:r.jsx(K,{icon:Ix})})]})]},se.transactionId)),!h&&ee?r.jsxs(Te.Fragment,{children:[r.jsx("p",{children:I("user:payment.hidden_transactions",{count:X})}),r.jsx(F,{label:I("user:payment.show_all"),onClick:d})]}):null]}):r.jsx("div",{children:r.jsx("p",{children:!i&&I("user:payment.no_transactions")})})]}),i&&r.jsx(Se,{inline:!0})]})},tw=(s,e)=>{if(s instanceof Blob){const t=window.URL.createObjectURL(new Blob([s])),n=document.createElement("a");n.href=t,n.setAttribute("download",`receipt_${e}.pdf`),document.body.appendChild(n),n.click()}else{const t=window.open("",`Receipt ${e}`,""),n=window.atob(s);t&&(t.opener=null,t.document.write(n),t.document.close())}},sw=["Apple In-App","Google In-App","Roku In-App"],nw={apple:"https://support.apple.com/118428",google:"https://support.google.com/googleplay/answer/7018481",roku:"https://support.roku.com/article/208756478"},rw=()=>{var I;const s=q(ye),e=ae(),{accessModel:t}=G(({accessModel:H})=>({accessModel:H}),de),{user:n,subscription:a,transactions:o,activePayment:i,pendingOffer:c,loading:l}=U(),{canUpdatePaymentMethod:d,canShowReceipts:h,canRenewSubscription:u}=s.getFeatures(),{subscriptionOffers:g,switchSubscriptionOffers:_}=va(),[f,x]=p.useState(!1),[w,v]=p.useState(!1),[b,y]=p.useState((a==null?void 0:a.accessFeeId)??null),[C,j]=p.useState(void 0),S=ue(),E=async()=>e(J(S,"upgrade-subscription")),P=async H=>{v(!0);try{const X=await s.getReceipt(H);X&&tw(X,H)}catch(X){throw new Error("Couldn't parse receipt. "+(X instanceof Error?X.message:""))}v(!1)},k=xx(C??!1,b,n,a==null?void 0:a.subscriptionId),A=async()=>{b&&(a!=null&&a.subscriptionId)&&k.mutate({accessFeeId:b.slice(1),subscriptionId:`${a.subscriptionId}`})};if(!n)return r.jsx(Se,{});const $=((I=n.metadata)==null?void 0:I[`${a==null?void 0:a.subscriptionId}_pending_downgrade`])||"",L=!!a&&sw.includes(a.paymentMethod),D=(a==null?void 0:a.paymentMethod.split(" ")[0])||"unknown",O=nw[D.toLowerCase()];return r.jsx(ew,{accessModel:t,activeSubscription:a,activePaymentDetail:i,transactions:o,customer:n,pendingOffer:c,isLoading:l||w,panelClassName:Xe.panel,panelHeaderClassName:Xe.panelHeader,onShowAllTransactionsClick:()=>x(!0),showAllTransactions:f,canUpdatePaymentMethod:d,canRenewSubscription:u,onUpgradeSubscriptionClick:E,offerSwitchesAvailable:_.length>0,canShowReceipts:h,onShowReceiptClick:P,offers:g,pendingDowngradeOfferId:$,changeSubscriptionPlan:k,onChangePlanClick:A,selectedOfferId:b,setSelectedOfferId:H=>y(H),isUpgradeOffer:C,setIsUpgradeOffer:H=>j(H),isExternalPaymentProvider:L,paymentProvider:D,paymentProviderLink:O})},aw=()=>{const s=q(hs),e=q(ye),{accessModel:t,favoritesList:n}=G(w=>{var v;return{accessModel:w.accessModel,favoritesList:(v=w.config.features)==null?void 0:v.favoritesList}},de),a=ae(),{t:o}=T("user"),i=Pe(),[c,l]=p.useState(!1),d=i>Z.md,{user:h,subscription:u,loading:g}=U(),{canUpdateEmail:_}=e.getFeatures(),f=pt(w=>w.getPlaylist()),x=p.useCallback(async()=>{await e.logout()},[e]);return p.useEffect(()=>{!g&&!h&&a("/",{replace:!0})},[a,h,g]),h?r.jsxs("div",{className:Xe.user,children:[d&&r.jsx("nav",{className:Xe.leftColumn,children:r.jsx("div",{className:Xe.panel,children:r.jsxs("ul",{children:[r.jsx("li",{children:r.jsx(F,{to:nn,label:o("nav.account"),variant:"text",startIcon:r.jsx(K,{icon:Pa}),className:Xe.button})}),n&&r.jsx("li",{children:r.jsx(F,{to:Ur,label:o("nav.favorites"),variant:"text",startIcon:r.jsx(K,{icon:Ea}),className:Xe.button})}),t!==Fe.AVOD&&r.jsx("li",{children:r.jsx(F,{to:Hr,label:o("nav.payments"),variant:"text",startIcon:r.jsx(K,{icon:Ul}),className:Xe.button})}),r.jsx("li",{className:Xe.logoutLi,children:r.jsx(F,{onClick:x,label:o("nav.logout"),variant:"text",startIcon:r.jsx(K,{icon:Hl}),className:Xe.button})})]})})}),r.jsx("div",{className:Xe.mainColumn,children:r.jsxs(Rc,{children:[r.jsx(ze,{path:nn,element:r.jsx(fx,{panelClassName:Xe.panel,panelHeaderClassName:Xe.panelHeader,canUpdateEmail:_})}),n&&r.jsx(ze,{path:Ur,element:r.jsxs(r.Fragment,{children:[r.jsx(vx,{playlist:f,onClearFavoritesClick:()=>l(!0),accessModel:t,hasSubscription:!!u}),r.jsx(Y_,{open:c,title:o("favorites.clear_favorites_title"),body:o("favorites.clear_favorites_body"),onConfirm:async()=>{await s.clear(),l(!1)},onClose:()=>l(!1)})]})}),r.jsx(ze,{path:Hr,element:t!==Fe.AVOD?r.jsx(rw,{}):r.jsx(us,{to:nn})}),r.jsx(ze,{path:"*",element:r.jsx(us,{to:nn})})]})})]}):r.jsx("div",{className:Xe.user,children:r.jsx(Se,{inline:!0})})},Ia=(s,e)=>{const t=[],n=cl(s.duration,e);return s.pubdate&&t.push(String(new Date(s.pubdate*1e3).getFullYear())),!e.episodesLabel&&n&&t.push(n),e.episodesLabel&&t.push(e.episodesLabel),s.genre&&t.push(s.genre),s.rating&&t.push(s.rating),t},ow=(s,e)=>{const t=[];return e&&t.push(e),s.genre&&t.push(s.genre),s.rating&&t.push(s.rating),t},iw=(s,e,t)=>{const n=[],a=Mh(e,s.scheduledStart,s.scheduledEnd),o=cl(s.duration,t);return a&&n.push(a),o&&n.push(o),s.genre&&n.push(s.genre),s.rating&&n.push(s.rating),n};function Qt(s,e=!0){const t=q(Le),{i18n:n}=T(),a=n.language;return We(["media",s,a],()=>t.getMediaById({id:s,language:a}),{enabled:!!s&&e,refetchInterval:(o,i)=>o&&qc(o)?1e3*30:!1,staleTime:60*1e3*10})}const er=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M19,19H5V5H19M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M10,8V16L15,12L10,8Z"})),cw="_filterRow_1pd69_1",lw="_dropDown_1pd69_10",dw="_filterDropDown_1pd69_17",Ir={filterRow:cw,dropDown:lw,filterDropDown:dw},Vl=({name:s,value:e,defaultLabel:t,options:n,setValue:a,forceDropdown:o=!1})=>{const{t:i}=T("common"),c=Pe();if(!n.length)return null;const l=h=>a(h.target.value),d=!o&&c>=Z.md&&n.length<6;return r.jsx(p.Fragment,{children:d?r.jsxs("div",{className:Ir.filterRow,role:"listbox","aria-label":i("filter_videos_by",{name:s}),children:[n.map(h=>{const u=typeof h=="string"?h:h.label,g=typeof h=="string"?h:h.value,_=e===g;return r.jsx(F,{label:u,onClick:()=>a(g),active:_,role:"option","aria-selected":_},g)}),r.jsx(F,{label:t,onClick:()=>a(""),active:e==="",role:"option","aria-selected":e===""},t)]}):r.jsx("div",{className:Ir.filterDropDown,children:r.jsx(Cl,{className:Ir.dropDown,size:"small",options:n,defaultLabel:t,name:s,value:e,onChange:l,"aria-label":i("filter_videos_by",{name:s})})})})},uw="_hero_oabkm_1",hw="_info_oabkm_10",mw="_title_oabkm_17",pw="_description_oabkm_34",fw="_poster_oabkm_41",gw="_posterFade_oabkm_56",cs={hero:uw,info:hw,title:mw,description:pw,poster:fw,posterFade:gw},ql=({image:s,children:e})=>{const t="",n=p.useRef(null),o=Pe()<=Z.sm;return Rl(50,o?150:500,i=>{n.current&&(n.current.style.opacity=`${Math.max(1-i,.1)}`)}),r.jsxs("div",{className:cs.hero,children:[r.jsx(Ws,{ref:n,className:cs.poster,image:s,width:1280,alt:t}),r.jsx("div",{className:cs.posterFade}),r.jsx("div",{className:cs.info,children:e})]})},zl=({title:s})=>r.jsx("h1",{className:cs.title,children:s}),_w="_collapsibleText_1ve3l_1",yw="_dummyDiv_1ve3l_6",vw="_textContainer_1ve3l_11",xw="_collapsed_1ve3l_15",ww="_chevron_1ve3l_20",bw="_expanded_1ve3l_33",Zs={collapsibleText:_w,dummyDiv:yw,textContainer:vw,collapsed:xw,chevron:ww,expanded:bw},Gl=({text:s,className:e})=>{const t=p.useRef(),n=Pe(),[a,o]=p.useState(!1),[i,c]=p.useState(!1),l=i?"Collapse":"Expand",d=4,h=60;return p.useEffect(()=>{t.current&&o(t.current.scrollHeight>t.current.offsetHeight+d||h<t.current.offsetHeight)},[h,s,n]),r.jsxs("div",{className:M(Zs.collapsibleText),children:[r.jsx("p",{ref:t,id:"collapsible-content",className:M(Zs.textContainer,e,{[Zs.collapsed]:!i&&a}),style:{maxHeight:i?t.current.scrollHeight:h},children:r.jsx(Hs,{tag:"span",markdownString:s,inline:!0})}),a&&r.jsx(Ge,{"aria-label":l,"aria-expanded":i,"aria-controls":"collapsible-content",className:M(Zs.chevron,{[Zs.expanded]:i}),onClick:()=>c(!i),children:r.jsx(K,{icon:_n})})]})},Kl=({className:s,description:e,maximumLines:t=8})=>Pe()===Z.xs?r.jsx(Gl,{text:e,className:M(cs.description,s)}):r.jsx(Ol,{text:e,maximumLines:t,className:M(cs.description,s)}),Sw="_videoDetails_1pu6q_1",jw="_metaContainer_1pu6q_5",Cw="_primaryMetadata_1pu6q_10",Pw="_secondaryMetadata_1pu6q_24",Ew="_description_1pu6q_39",kw="_buttonBar_1pu6q_43",Iw="_playIcon_1pu6q_64",As={videoDetails:Sw,metaContainer:jw,primaryMetadata:Cw,secondaryMetadata:Pw,description:Ew,buttonBar:kw,playIcon:Iw},Jl=({title:s,description:e,primaryMetadata:t,secondaryMetadata:n,image:a,startWatchingButton:o,shareButton:i,favoriteButton:c,trailerButton:l,children:d})=>r.jsxs("div",{"data-testid":void 0,children:[r.jsx("header",{className:As.videoDetails,"data-testid":void 0,id:"video-details",children:r.jsxs(ql,{image:a,children:[r.jsx(zl,{title:s}),r.jsxs("div",{className:As.metaContainer,children:[r.jsx("div",{className:As.primaryMetadata,children:t}),n&&r.jsx("div",{className:As.secondaryMetadata,children:n})]}),r.jsx(Kl,{className:As.description,description:e}),r.jsxs("div",{className:As.buttonBar,children:[o,l,c,i]})]})}),d]}),Aw="_details_72tjp_1",Tw="_inlinePlayerMetadata_72tjp_23",Nw="_title_72tjp_39",Lw="_primaryMetadata_72tjp_65",$w="_buttonBar_72tjp_77",Rw="_description_72tjp_98",rs={details:Aw,inlinePlayerMetadata:Tw,title:Nw,primaryMetadata:Lw,buttonBar:$w,description:Rw},Ow=({title:s,description:e,primaryMetadata:t,shareButton:n,favoriteButton:a,trailerButton:o})=>{const c=Pe()===Z.xs,l=typeof s=="string"?"h1":"div";return r.jsxs("div",{className:rs.details,"data-testid":void 0,children:[r.jsx(l,{className:rs.title,children:s}),r.jsxs("div",{className:rs.inlinePlayerMetadata,children:[r.jsx("div",{className:rs.primaryMetadata,children:t}),r.jsxs("div",{className:rs.buttonBar,children:[o,a,n]})]}),c?r.jsx(Gl,{text:e,className:rs.description}):r.jsx(Hs,{markdownString:e,className:rs.description})]})},Dw="_listItem_1hb3b_1",Fw="_poster_1hb3b_20",Mw="_posterImage_1hb3b_39",Bw="_visible_1hb3b_48",Uw="_activeLabel_1hb3b_58",Hw="_title_1hb3b_90",Ww="_titleContainer_1hb3b_104",Vw="_scheduledStart_1hb3b_109",qw="_tags_1hb3b_120",zw="_lock_1hb3b_127",Gw="_scheduled_1hb3b_109",Kw="_tag_1hb3b_120",Jw="_live_1hb3b_155",Yw="_progressContainer_1hb3b_159",Qw="_progressBar_1hb3b_169",Ne={listItem:Dw,poster:Fw,posterImage:Mw,visible:Bw,activeLabel:Uw,title:Hw,titleContainer:Ww,scheduledStart:Vw,tags:qw,lock:zw,scheduled:Gw,tag:Kw,live:Jw,progressContainer:Yw,progressBar:Qw};function Xw({onHover:s,progress:e,activeLabel:t,item:n,url:a,loading:o=!1,isActive:i=!1,isLocked:c=!0}){const{title:l,duration:d,seasonNumber:h,episodeNumber:u,cardImage:g,mediaStatus:_,scheduledStart:f}=n,{t:x,i18n:{language:w}}=T("common"),[v,b]=p.useState(!1),y=M(Ne.posterImage,{[Ne.visible]:v}),C=Qc(n),j=_===Mt.LIVE||Zc(n),S=_===Mt.SCHEDULED,E=()=>{if(o||!l)return null;if(C)return r.jsx("div",{className:Ne.tag,children:x("video:series")});if(u)return r.jsx("div",{className:Ne.tag,children:Kn(h,u)});if(d)return r.jsx("div",{className:Ne.tag,children:da(d,{minutesAbbreviation:x("common:abbreviation.minutes")})});if(j)return r.jsx("div",{className:M(Ne.tag,Ne.live),children:x("live")});if(S)return r.jsxs("div",{className:Ne.tag,children:[r.jsx(K,{icon:ja,className:Ne.scheduled}),x("scheduled")]})};return r.jsxs(un,{role:"button",to:a,className:Ne.listItem,onMouseEnter:s,tabIndex:0,"data-testid":void 0,children:[r.jsxs("div",{className:Ne.titleContainer,children:[r.jsx("h3",{className:Ne.title,children:l}),!!f&&r.jsx("div",{className:Ne.scheduledStart,children:Bn(f,w)})]}),r.jsxs("div",{className:Ne.poster,children:[r.jsx(Ws,{className:y,image:g,onLoad:()=>b(!0),width:320,alt:""}),r.jsxs("div",{className:Ne.tags,children:[c&&r.jsx("div",{className:M(Ne.tag,Ne.lock),"aria-label":x("card_lock"),children:r.jsx(K,{icon:Sa})}),E()]}),i&&r.jsx("div",{className:Ne.activeLabel,children:t}),e?r.jsx("div",{className:Ne.progressContainer,children:r.jsx("div",{className:Ne.progressBar,style:{width:`${Math.round(e*100)}%`}})}):null]})]})}const Zw=p.memo(Xw),e1="_container_w9k9j_1",t1="_content_w9k9j_6",s1="_list_w9k9j_13",Ar={container:e1,content:t1,list:s1},bc=()=>{};function n1({playlist:s,header:e,onListItemHover:t,isLoading:n=!1,watchHistory:a,activeMediaId:o,activeLabel:i,className:c,accessModel:l,isLoggedIn:d,hasSubscription:h,hasMore:u,loadMore:g=bc,getUrl:_}){var f;return r.jsxs("div",{className:M(Ar.container,!!c&&c),"data-testid":void 0,children:[!!e&&e,r.jsx("div",{className:Ar.content,children:r.jsx(sa,{element:"ul",pageStart:0,loadMore:g??bc,hasMore:u??!1,className:Ar.list,loader:r.jsx(Ca,{},"loader"),useWindow:!1,children:(f=s==null?void 0:s.playlist)==null?void 0:f.map(x=>r.jsx("li",{children:r.jsx(Zw,{url:_(x),progress:a?a[x.mediaid]:void 0,onHover:()=>t&&t(x),loading:n,isActive:o===x.mediaid,activeLabel:i,isLocked:zn(l,d,h,x),item:x})},x.mediaid))})})]})}const r1="_videoInlineLayout_1o3za_1",a1="_player_1o3za_29",o1="_videoDetailsInline_1o3za_53",i1="_relatedVideosList_1o3za_58",c1="_relatedVideosListHeader_1o3za_62",l1="_relatedVideos_1o3za_58",d1="_relatedVideosGrid_1o3za_89",u1="_inlineLayout_1o3za_96",h1="_relatedVideosGridTitle_1o3za_112",m1="_relatedVideosListTitle_1o3za_121",p1="_filters_1o3za_129",f1="_filtersInline_1o3za_135",g1="_filterMetadata_1o3za_140",et={videoInlineLayout:r1,player:a1,videoDetailsInline:o1,relatedVideosList:i1,relatedVideosListHeader:c1,relatedVideos:l1,relatedVideosGrid:d1,inlineLayout:u1,relatedVideosGridTitle:h1,relatedVideosListTitle:m1,filters:p1,filtersInline:f1,filterMetadata:g1},tr=({inlineLayout:s,player:e,playlist:t,accessModel:n,isLoading:a,isLoggedIn:o,item:i,hasSubscription:c,title:l,description:d,image:h,primaryMetadata:u,secondaryMetadata:g,shareButton:_,favoriteButton:f,startWatchingButton:x,trailerButton:w,relatedTitle:v,watchHistory:b,activeLabel:y,filters:C,setFilter:j,filterMetadata:S,currentFilter:E="",defaultFilterLabel:P="",children:k,hasMore:A,loadMore:$,getURL:L})=>{const D=Pe(),O=D===Z.sm||D===Z.md,I=C&&C.length>1,H=I&&j,X=Q=>r.jsxs("div",{className:M(et.filters,{[et.filtersInline]:s}),children:[!!S&&s&&r.jsx("span",{className:et.filterMetadata,children:S}),H&&r.jsx(Vl,{name:"season",value:E,defaultLabel:P,options:C,setValue:j,forceDropdown:Q})]}),ee=(Q=!0)=>t?Q?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:M(et.relatedVideosGrid,{[et.inlineLayout]:s}),children:[r.jsx("h2",{className:et.relatedVideosGridTitle,children:v||" "}),I&&X(s)]}),r.jsx(Zn,{playlist:t,isLoading:a,watchHistory:b,accessModel:n,isLoggedIn:o,currentCardItem:i,currentCardLabel:y,hasSubscription:c,hasMore:A,loadMore:$,getUrl:L})]}):r.jsx("div",{className:et.relatedVideosList,children:r.jsx(n1,{header:r.jsxs("div",{className:et.relatedVideosListHeader,children:[l&&r.jsx("h2",{className:et.relatedVideosListTitle,children:v}),I&&X(!0)]}),activeMediaId:i==null?void 0:i.mediaid,activeLabel:y,playlist:t,watchHistory:b,isLoading:a,accessModel:n,isLoggedIn:o,hasSubscription:c,hasMore:A,loadMore:$,getUrl:L})}):null;return s?r.jsxs("div",{className:et.videoInlineLayout,"data-testid":void 0,children:[r.jsx("div",{className:et.player,children:e}),r.jsx("div",{className:et.videoDetailsInline,children:r.jsx(Ow,{title:g||l,live:(i==null?void 0:i.duration)===0,description:d,primaryMetadata:u,shareButton:_,favoriteButton:f,trailerButton:w})}),ee(O),k]}):r.jsxs(Jl,{title:l,description:d,image:h,startWatchingButton:x,favoriteButton:f,trailerButton:w,shareButton:_,primaryMetadata:u,secondaryMetadata:g,children:[t&&r.jsx("section",{className:et.relatedVideos,children:ee(!0)}),k,e]})},_1=3e5,y1=(s,e,t)=>{const n=p.useRef(null),a=q(Rs),{features:o}=G(h=>h.config),c=!!(o==null?void 0:o.continueWatchingList),l=p.useCallback(()=>{if(!c||!n.current)return;const{item:h,seriesItem:u,progress:g}=n.current;a.saveItem(h,u,g),n.current=null},[c,a]),d=he(h=>{var g;if(h.duration<0)return;const u=Number((h.position/h.duration).toFixed(5));!isNaN(u)&&isFinite(u)&&(n.current={item:e,seriesItem:t,progress:u,timestamp:((g=n.current)==null?void 0:g.timestamp)||Date.now()},Date.now()-n.current.timestamp>_1&&l())});p.useEffect(()=>{if(!(!s||!c))return s.on("time",d),s.on("pause",l),s.on("complete",l),s.on("remove",l),()=>{s.off("time",d),s.off("pause",l),s.off("complete",l),s.off("remove",l)}},[s,c,l,d]),p.useEffect(()=>()=>{l()},[e==null?void 0:e.mediaid,l]),p.useLayoutEffect(()=>{const h=()=>document.visibilityState==="hidden"&&l();return window.addEventListener("pagehide",l),window.addEventListener("visibilitychange",h),()=>{window.removeEventListener("pagehide",l),window.removeEventListener("visibilitychange",h)}},[l])},v1=(s,e,t)=>{const{features:n}=G(c=>c.config),o=!!(n==null?void 0:n.continueWatchingList);y1(s,e,t);const i=gt(c=>e&&o?c.getItem(e):void 0);return p.useMemo(()=>{const c=i==null?void 0:i.progress;return c&&c>Jt.Min&&c<Jt.Max?c*e.duration:0},[e.duration,i==null?void 0:i.progress])},x1=(s,e)=>{const t=n=>{if(!s)return n;const a=[s,e].filter(Boolean).join("-");return{...n,allSources:void 0,sources:n.sources.map(o=>({...o,file:Ie(o.file,{t:a})}))}};return he(async n=>t(n))},Sc=60*1e3*20,w1=({adScheduleId:s,enabled:e})=>{const t=q(Le),{isLoading:n,data:a}=We(["ad-schedule",s],async()=>t.getAdSchedule(s),{enabled:e&&!!s,cacheTime:Sc,staleTime:Sc});return{isLoading:n,data:a}},b1=({mediaId:s})=>{const{adSchedule:e,adConfig:t,adScheduleUrls:n,adDeliveryMethod:a}=G(d=>d.config),o=!!t&&a!=="ssai",{data:i,isLoading:c}=w1({adScheduleId:e,enabled:!!e}),l=o?{client:"vast",schedule:Ie((n==null?void 0:n.xml)||"",{media_id:s})}:void 0;return{isLoading:o?!1:c,data:o?l:i}},S1=(s,e,t,n={},a=!0,o)=>{var C;const i=q(nl),c=q(la),{configId:l,signingConfig:d,contentProtection:h,jwp:u,urlSigning:g,isAccessBridgeEnabled:_}=G(({config:j,settings:S})=>{var E;return{configId:j.id,signingConfig:j.contentSigningService,contentProtection:j.contentProtection,jwp:j.integrations.jwp,urlSigning:fs((E=j==null?void 0:j.custom)==null?void 0:E.urlSigning),isAccessBridgeEnabled:!!(S!=null&&S.apiAccessBridgeUrl)}}),f=d==null?void 0:d.host,x=((C=h==null?void 0:h.drm)==null?void 0:C.defaultPolicyId)??(d==null?void 0:d.drmPolicyId),w=!!g||!!f||!!x&&!f,{data:v,isLoading:b}=We(["token",s,e,n],async()=>{if(e&&f){const S=await q(ye).getAuthData(),{host:E,drmPolicyId:P}=d;return i.getMediaToken(E,e,S==null?void 0:S.jwt,n,P)}if(u&&l&&e&&w)return c.getJWPMediaToken(l,e)},{enabled:w&&a&&!!e&&!_,keepPreviousData:!1,staleTime:15*60*1e3}),y=We([s,e,n,v],async()=>t(v,x),{enabled:!!e&&a&&(!w||!!v),placeholderData:e?o:void 0,retry:2,retryDelay:1e3,keepPreviousData:!1});return{...y,isLoading:b||y.isLoading}};function j1(s){const e=q(Le),t=q(cn),{isAccessBridgeEnabled:n}=G(({settings:c})=>({isAccessBridgeEnabled:!!(c!=null&&c.apiAccessBridgeUrl)})),a=S1("media",s.mediaid,async(c,l)=>n?t.getMediaById(s.mediaid):e.getMediaById({id:s.mediaid,token:c,drmPolicyId:l})),{isLoading:o,data:i}=We(["media","geo",s.mediaid],()=>{var l;const c=(l=a.data)==null?void 0:l.sources.find(d=>d.file.indexOf(".m3u8")!==-1);return c?fetch(c.file,{method:"HEAD"}).then(d=>d.status===403):!1},{enabled:a.isFetched});return{...a,isGeoBlocked:i,isLoading:a.isLoading||o}}const C1=(s,e,t,n)=>n.some(a=>s===`${e}/manifests/${t}.${a}`),P1=(s,e,t,n)=>n.some(a=>s===`${e}/live/broadcast/${t}.${a}`),E1=({item:s,baseUrl:e,config:t,user:n,passport:a})=>{const{sources:o,mediaid:i}=s,{adConfig:c,siteId:l,adDeliveryMethod:d}=t,h=n==null?void 0:n.id,u=!!c&&d==="ssai";return o.map(g=>{const _=new URL(g.file),f=_.href,x=P1(f,e,i,["m3u8","mpd"]),w=C1(f,e,i,["m3u8","mpd"]),v=_.searchParams.has("exp")&&_.searchParams.has("sig");return w&&u&&!v?(_.href=`${e}/v2/sites/${l}/media/${i}/ssai.m3u8`,_.searchParams.set("ad_config_id",c)):(w||x)&&h&&_.searchParams.set("user_id",h),a&&k1(g,a),g.file=_.toString(),g})};function k1(s,e){var n,a,o,i,c,l;function t(d,h){const u=new URL(d);return u.searchParams.has("token")||u.searchParams.set("passport",h),u.toString()}return s!=null&&s.drm&&((a=(n=s.drm)==null?void 0:n.playready)!=null&&a.url&&(s.drm.playready.url=t(s.drm.playready.url,e)),(i=(o=s.drm)==null?void 0:o.widevine)!=null&&i.url&&(s.drm.widevine.url=t(s.drm.widevine.url,e)),(l=(c=s.drm)==null?void 0:c.fairplay)!=null&&l.processSpcUrl&&(s.drm.fairplay.processSpcUrl=t(s.drm.fairplay.processSpcUrl,e))),s}const I1=({item:s,baseUrl:e})=>{const t=G(o=>o.config),n=U(o=>o.user),a=Dn(o=>o.passport);return p.useMemo(()=>E1({item:s,baseUrl:e,config:t,user:n,passport:a}),[s,e,t,n,a])},A1="_container_79xjy_1",T1={container:A1},Yl=({item:s,adsData:e,onReady:t,onPlay:n,onPause:a,onComplete:o,onUserActive:i,onUserInActive:c,onBeforePlay:l,onFirstFrame:d,onRemove:h,onPlaylistItem:u,onPlaylistItemCallback:g,onNext:_,onBackClick:f,feedId:x,startTime:w=0,autostart:v})=>{const b=p.useRef(null),y=p.useRef(),C=p.useRef(!1),j=p.useRef(!1),[S,E]=p.useState(!!window.jwplayer),P=p.useRef(w),k=I1({item:s,baseUrl:W.APP_API_BASE_URL}),{settings:A}=G(ce=>ce),$=A.playerId,L=A.playerLicenseKey,D=he(l),O=he(n),I=he(a),H=he(o),X=he(i),ee=he(c),Q=he(()=>{var V;const ce=(V=y.current)==null?void 0:V.getContainer(),ve=ce==null?void 0:ce.querySelector('.jw-controlbar [aria-label="Play"], .jw-button-container [aria-label="Pause"]');ve==null||ve.focus(),d==null||d()}),N=he(h),R=he(u),Y=he(g),z=he(_),re=he(()=>{j.current=!0,f==null||f()}),$e=he(()=>t&&t(y.current)),me=p.useCallback(()=>{var ce,ve,V,oe,Ee,se,Ve,Je,xs,Zt,es,rt,ts;(ce=y.current)==null||ce.on("ready",$e),(ve=y.current)==null||ve.on("beforePlay",D),(V=y.current)==null||V.on("complete",H),(oe=y.current)==null||oe.on("play",O),(Ee=y.current)==null||Ee.on("pause",I),(se=y.current)==null||se.on("userActive",X),(Ve=y.current)==null||Ve.on("userInactive",ee),(Je=y.current)==null||Je.on("firstFrame",Q),(xs=y.current)==null||xs.on("remove",N),(Zt=y.current)==null||Zt.on("playlistItem",R),(es=y.current)==null||es.on("nextClick",z),(rt=y.current)==null||rt.on("backClick",re),(ts=y.current)==null||ts.setPlaylistItemCallback(Y)},[$e,D,H,O,I,X,ee,Q,N,R,z,Y,re]),je=p.useCallback(()=>{var ce,ve,V,oe,Ee,se,Ve,Je;(ce=y.current)==null||ce.off("ready"),(ve=y.current)==null||ve.off("beforePlay"),(V=y.current)==null||V.off("complete"),(oe=y.current)==null||oe.off("play"),(Ee=y.current)==null||Ee.off("pause"),(se=y.current)==null||se.off("userActive"),(Ve=y.current)==null||Ve.off("userInactive"),(Je=y.current)==null||Je.off("firstFrame")},[]);return p.useEffect(()=>{if(!window.jwplayer&&!C.current){C.current=!0;const ce=`${W.APP_API_BASE_URL}/libraries/${$}.js`;Gm(ce).then(()=>{E(!0),C.current=!1})}},[$]),p.useEffect(()=>{P.current=w},[w]),p.useEffect(()=>{const ce=()=>{var oe,Ee;if(!s||!y.current)return;const V=(oe=y.current)==null?void 0:oe.getPlaylistItem();if(V&&V.mediaid===s.mediaid){Kc("Player","Calling loadPlaylist with the same item, check the dependencies");return}typeof v<"u"&&((Ee=y.current)==null||Ee.setConfig({autostart:v})),y.current.load([Ai({...s,starttime:P.current,feedid:x})])},ve=()=>{if(!window.jwplayer||!b.current)return;y.current=window.jwplayer(b.current);const V={advertising:{...e,showCountdown:!0},timeSlider:{showAdMarkers:!1},aspectratio:!1,controls:!0,displaytitle:!1,displayHeading:!1,displaydescription:!1,floating:{mode:"never"},height:"100%",mute:!1,playbackRateControls:!0,pipIcon:"disabled",playlist:[Ai({...s,starttime:P.current,feedid:x,sources:k})],repeat:!1,cast:{},stretching:"uniform",width:"100%"};typeof v<"u"&&(V.autostart=v),L&&(V.key=L),y.current.setup(V),me()};if(y.current)return ce();S&&ve()},[S,s,je,me,$,v,e,L,k,x]),p.useEffect(()=>()=>{if(y.current){if(je(),j.current){j.current=!1;return}y.current.remove()}},[je,j]),r.jsx("div",{className:T1.container,"data-testid":void 0,children:r.jsx("div",{ref:b})})},N1="_error_4iaxi_1",L1="_title_4iaxi_11",jc={error:N1,title:L1};var Ql=(s=>(s.GEO_BLOCKED="GEO_BLOCKED",s))(Ql||{});const $1=()=>{const{t:s}=T("video");return r.jsxs("div",{className:jc.error,children:[r.jsx("h2",{className:jc.title,children:s("player_error.geo_blocked_title")}),r.jsx("p",{children:s("player_error.geo_blocked_description")})]})},Xl=({item:s,seriesItem:e,feedId:t,onPlay:n,onPause:a,onComplete:o,onUserActive:i,onUserInActive:c,onNext:l,onBackClick:d,liveEndDateTime:h,liveFromBeginning:u,liveStartDateTime:g,autostart:_})=>{const{data:f,isLoading:x}=b1({mediaId:s==null?void 0:s.mediaid}),{data:w,isLoading:v,isGeoBlocked:b}=j1(s),[y,C]=p.useState(),j=v1(y,s,e),S=p.useCallback(k=>{C(k)},[]),E=p.useCallback(()=>{u&&(y==null||y.seek(0))},[u,y]),P=x1(g,h);return!w||v||x?r.jsx(Se,{inline:!0}):b?r.jsx($1,{error:Ql.GEO_BLOCKED}):r.jsx(Yl,{feedId:t,item:w,adsData:f,onReady:S,onFirstFrame:E,onPlay:n,onPause:a,onComplete:o,onUserActive:i,onUserInActive:c,onNext:l,onBackClick:d,onPlaylistItemCallback:P,startTime:j,autostart:_})},R1="_inlinePlayer_g5xl8_1",O1="_paywall_g5xl8_10",D1="_poster_g5xl8_26",F1="_lock_g5xl8_47",M1="_title_g5xl8_62",B1="_text_g5xl8_88",Ts={inlinePlayer:R1,paywall:O1,poster:D1,lock:F1,title:M1,text:B1},sr=({item:s,seriesItem:e,onPlay:t,onPause:n,onComplete:a,feedId:o,liveStartDateTime:i,liveEndDateTime:c,liveFromBeginning:l,startWatchingButton:d,isLoggedIn:h,isEntitled:u,autostart:g,playable:_=!0,hasMediaOffers:f})=>{const x=G(j=>j.config.siteName),{t:w}=T(),v=ae(),b=ue(),y=()=>{v(J(b,"login"))},C=w(f?"video:buy_to_start_watching":"video:sign_up_to_start_watching");return r.jsxs("div",{className:Ts.inlinePlayer,children:[r.jsx(Vs,{open:!_||!u,children:r.jsxs("div",{className:Ts.paywall,children:[r.jsx(Ws,{className:Ts.poster,image:s.backgroundImage,alt:s.title,width:1280}),!u&&r.jsxs(r.Fragment,{children:[r.jsx(K,{icon:Sa,className:Ts.lock}),r.jsx("h2",{className:Ts.title,children:C}),r.jsx("span",{className:Ts.text,children:w("account:choose_offer.watch_this_on_platform",{siteName:x})}),d,!h&&r.jsx(F,{onClick:y,label:w("common:sign_in")})]})]})}),u&&_&&r.jsx(Xl,{item:s,seriesItem:e,feedId:o,autostart:g,onPlay:t,onPause:n,onComplete:a,liveEndDateTime:c,liveFromBeginning:l,liveStartDateTime:i})]})},U1="_cinemaContainer_b92ry_1",H1="_cinema_b92ry_1",W1="_overlayFade_b92ry_13",V1="_playerOverlay_b92ry_18",q1="_playerContent_b92ry_36",z1="_backButton_b92ry_46",G1="_title_b92ry_58",K1="_metaContainer_b92ry_74",J1="_primaryMetadata_b92ry_79",Y1="_secondaryMetadata_b92ry_93",Ct={cinemaContainer:U1,cinema:H1,overlayFade:W1,playerOverlay:V1,playerContent:q1,backButton:z1,title:G1,metaContainer:K1,primaryMetadata:J1,secondaryMetadata:Y1},yn=({open:s,item:e,seriesItem:t,title:n,primaryMetadata:a,secondaryMetadata:o,onPlay:i,onPause:c,onComplete:l,onClose:d,onNext:h,feedId:u,liveStartDateTime:g,liveEndDateTime:_,liveFromBeginning:f})=>{const{t:x}=T(),[w,v]=p.useState(!1),[b,y]=p.useState(!1),[C,j]=p.useState(!0),S=p.useCallback(()=>{v(!0),i&&i()},[i]),E=p.useCallback(()=>{v(!1),c&&c()},[c]),P=p.useCallback(()=>{l&&l()},[l]),k=p.useCallback(()=>{h&&h()},[h]),A=p.useCallback(()=>j(!0),[]),$=p.useCallback(()=>j(!1),[]);return p.useEffect(()=>{s&&j(!0)},[s]),r.jsx(Jn,{open:s,animationContainerClassName:Ct.cinemaContainer,onClose:d,"aria-label":x("videoplayer"),children:r.jsxs("div",{className:Ct.cinema,children:[r.jsx(Vs,{className:Ct.overlayFade,open:!w||C||b,keepMounted:!0,children:r.jsx("div",{className:Ct.playerOverlay,onFocus:()=>y(!0),onBlur:()=>y(!1),children:r.jsxs("div",{className:Ct.playerContent,children:[r.jsx(Ge,{"aria-label":x("common:back"),onClick:d,className:Ct.backButton,children:r.jsx(K,{icon:wl})}),r.jsxs("div",{children:[r.jsx("h1",{className:Ct.title,children:n}),r.jsxs("div",{className:Ct.metaContainer,children:[o&&r.jsx("div",{className:Ct.secondaryMetadata,children:o}),r.jsx("div",{className:Ct.primaryMetadata,children:a})]})]})]})})}),r.jsx(Xl,{item:e,seriesItem:t,feedId:u,autostart:!0,onPlay:S,onPause:E,onComplete:P,onUserActive:A,onUserInActive:$,onNext:k,onBackClick:d,liveEndDateTime:_,liveFromBeginning:f,liveStartDateTime:g})]})})},Q1="_container_98mgl_1",X1="_playerOverlay_98mgl_14",Z1="_title_98mgl_25",Tr={container:Q1,playerOverlay:X1,title:Z1},nr=({item:s,open:e,title:t,onClose:n})=>{const[a,o]=p.useState(!1),[i,c]=p.useState(!0),l=p.useCallback(()=>o(!0),[]),d=p.useCallback(()=>o(!1),[]),h=p.useCallback(()=>c(!0),[]),u=p.useCallback(()=>c(!1),[]);return s?r.jsx(Jn,{open:e,onClose:n,"aria-labelledby":"trailer-modal-title",centered:!0,children:r.jsxs("div",{className:Tr.container,children:[r.jsx(Yl,{item:s,onPlay:l,onPause:d,onComplete:n,onUserActive:h,onUserInActive:u,autostart:!0}),r.jsxs(Vs,{open:!a||i,keepMounted:!0,children:[r.jsx("div",{className:Tr.playerOverlay,children:r.jsx("h1",{id:"trailer-modal-title",className:Tr.title,children:t})}),r.jsx(pl,{onClick:n})]})]})}):null},eb=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"})),tb=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z"})),sb=s=>{const e=document.activeElement,t=document.createElement("input");t.style.zIndex="-10",t.style.position="absolute",t.style.left="-1000",t.value=s,document.body.appendChild(t),t.select(),document.execCommand("copy"),t.blur(),document.body.removeChild(t),e==null||e.focus()},vn=({title:s,description:e,url:t})=>{const{t:n}=T(),a=Pe(),[o,i]=p.useState(!1),c=async()=>{if(typeof navigator.share=="function"){await navigator.share({title:s,text:e,url:t});return}sb(window.location.href),i(!0),setTimeout(()=>i(!1),2e3)};return r.jsx(F,{label:n(o?"video:copied_url":"video:share"),startIcon:o?r.jsx(K,{icon:eb}):r.jsx(K,{icon:tb}),onClick:c,active:o,fullWidth:a<Z.md})},nb=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M12.1,18.55L12,18.65L11.89,18.55C7.14,14.24 4,11.39 4,8.5C4,6.5 5.5,5 7.5,5C9.04,5 10.54,6 11.07,7.36H12.93C13.46,6 14.96,5 16.5,5C18.5,5 20,6.5 20,8.5C20,11.39 16.86,14.24 12.1,18.55M16.5,3C14.76,3 13.09,3.81 12,5.08C10.91,3.81 9.24,3 7.5,3C4.42,3 2,5.41 2,8.5C2,12.27 5.4,15.36 10.55,20.03L12,21.35L13.45,20.03C18.6,15.36 22,12.27 22,8.5C22,5.41 19.58,3 16.5,3Z"})),rr=({item:s})=>{const{t:e}=T(),t=Pe(),n=q(hs),{isFavorite:a,clearWarning:o,warning:i}=pt(l=>({isFavorite:!!s&&l.hasItem(s),clearWarning:l.clearWarning,warning:l.warning})),c=p.useCallback(async()=>{await n.toggleFavorite(s)},[s,n]);return p.useEffect(()=>()=>o(),[o]),r.jsxs(r.Fragment,{children:[r.jsx(F,{label:e("video:favorite"),"aria-label":e("video:favorite"),startIcon:a?r.jsx(K,{icon:Ea}):r.jsx(K,{icon:nb}),onClick:c,"aria-pressed":a,color:a?"primary":"default",fullWidth:t<Z.md}),r.jsx(ka,{open:i!==null,message:i,onClose:o})]})},rb="_loading_1bc17_1",ab={loading:rb},vs=()=>r.jsx("div",{className:ab.loading,children:r.jsx(_s,{})}),ob="_separator_14n07_1",ib={separator:ob},Os=({attributes:s,separator:e="•"})=>r.jsx("div",{children:s.map((t,n)=>r.jsxs(Te.Fragment,{children:[r.jsx("span",{children:t}),n<s.length-1&&r.jsx("span",{className:ib.separator,"aria-hidden":"true",children:e})]},t))});function Un(s,e=!1){if(!s)return"";const t=new Date(s?s*1e3:0),n=t.getUTCHours(),a=t.getUTCMinutes(),o=t.getUTCSeconds();if(!e)return t.toISOString();let i="PT";return n>0&&(i+=n+"H"),a>0&&(i+=a+"M"),o>0&&(i+=o+"S"),i}const cb=()=>{const s=new Date(Date.UTC(2022,6,20,18,0,0));return/am|pm/.test(s.toLocaleTimeString())},lb=s=>((s==null?void 0:s.playlist)||[]).reduce((e,t)=>e.some(n=>(n==null?void 0:n.value)===(t==null?void 0:t.seasonNumber))?e:e.concat(t.seasonNumber?[{label:we.t("video:season_number_filter_template",{seasonNumber:t.seasonNumber}),value:t.seasonNumber}]:[]),[]).slice().sort(),db=(s,e)=>{if(s)return e===""?s:{...s,playlist:s.playlist.filter(({seasonNumber:t})=>t===e)}},ub=(s,e)=>{var n,a;if(!s||!e)return;const t=(n=e==null?void 0:e.playlist)==null?void 0:n.findIndex(({mediaid:o})=>o===s.mediaid);return(a=e==null?void 0:e.playlist)==null?void 0:a[t+1]},hb=(s,e)=>{var t;if(e)return(t=e.playlist.filter(n=>n.seasonNumber===(s==null?void 0:s.seasonNumber)))==null?void 0:t.length},mb=(s,e)=>({"@type":"TVSeries","@id":`${W.APP_PUBLIC_URL}/s/${e}`,name:s.title,numberOfEpisodes:String(s.playlist.length),numberOfSeasons:String(s.playlist.reduce(function(n,a){return!a.seasonNumber||n.includes(a.seasonNumber)?n:n.concat(a.seasonNumber)},[]).length)}),pb=(s,e,t,n)=>{const a=`${W.APP_PUBLIC_URL}${is({episodeId:e==null?void 0:e.mediaid,seriesId:n})}`,o=mb(s,n);return JSON.stringify(e?{"@context":"http://schema.org/","@type":"TVEpisode","@id":a,episodeNumber:t==null?void 0:t.episodeNumber,seasonNumber:t==null?void 0:t.seasonNumber,name:e.title,uploadDate:Un(e.pubdate),partOfSeries:o}:o)},fb=()=>{var Gs,ws;const s=Pe(),{t:e}=T("video"),[t,n]=p.useState(!1),a=ae(),i=Fs().id||"",c=He("play")==="1",l=He("r"),d=He("e"),{isLoading:h,data:u,isError:g}=gn(i,{},!0,!1),{isLoading:_,data:f}=Qt(d||""),{isLoading:x,data:w}=Qt((f==null?void 0:f.trailerId)||""),v=p.useMemo(()=>({episodeNumber:(f==null?void 0:f.episodeNumber)||"0",seasonNumber:(f==null?void 0:f.seasonNumber)||"0"}),[f]),b=f||u,y=(b==null?void 0:b.image)||"",{config:C,accessModel:j}=G(({config:xe,accessModel:bs})=>({config:xe,accessModel:bs}),de),{features:S,siteName:E,custom:P}=C,k=!!(S!=null&&S.favoritesList),A=!!(P!=null&&P.inlinePlayer),$=p.useMemo(()=>lb(u),[u]),[L,D]=p.useState(void 0),O=p.useMemo(()=>{var xe;return(xe=u==null?void 0:u.playlist)==null?void 0:xe[0]},[u]),I=p.useMemo(()=>db(u,L),[u,L]),H=hb(f,u),X=p.useMemo(()=>ub(f,u),[f,u]),ee=gt(xe=>xe.getDictionaryWithEpisodes()),{user:Q,subscription:N}=U(({user:xe,subscription:bs})=>({user:xe,subscription:bs}),de),{isEntitled:R,mediaOffers:Y}=qs(f||O),z=!!Y.length,re=!!Q,$e=!!N,me=()=>f&&a(is({episodeId:f.mediaid,seriesId:i,play:!1,playlistId:l})),je=xe=>u?is({episodeId:xe.mediaid,seriesId:i,play:!1,playlistId:l}):"",ce=p.useCallback(async()=>{a(is({episodeId:X==null?void 0:X.mediaid,seriesId:i,play:!!X,playlistId:l}))},[a,X,i,l]);p.useEffect(()=>{var xe;(document.scrollingElement||document.body).scroll({top:0}),(xe=document.querySelector("#video-details button"))==null||xe.focus()},[f]),p.useEffect(()=>{var xe;h||_||L===void 0&&D(parseInt(v==null?void 0:v.seasonNumber,10)?v==null?void 0:v.seasonNumber:((xe=$==null?void 0:$[0])==null?void 0:xe.value)||"")},[v,L,h,_,$]);const ve=h||_;if(ve)return r.jsx(vs,{});if(g||!u||!b||!O)return r.jsx(nt,{title:e("series_error")});const V=`${b.title} - ${E}`,oe=(b==null?void 0:b.description)||"",Ee=`${W.APP_PUBLIC_URL}${is({episodeId:f==null?void 0:f.mediaid,seriesId:i})}`,se=b.backgroundImage||void 0,Ve=f?r.jsx(Os,{attributes:Ia(f,{episodesLabel:e("video:total_episodes",{count:(Gs=u==null?void 0:u.playlist)==null?void 0:Gs.length}),hoursAbbreviation:e("common:abbreviation.hours"),minutesAbbreviation:e("common:abbreviation.minutes")})}):r.jsx(Os,{attributes:ow(u,e("video:total_episodes",{count:(ws=u==null?void 0:u.playlist)==null?void 0:ws.length}))}),Je=v&&f&&r.jsxs(r.Fragment,{children:[r.jsx("strong",{children:Kn(v.seasonNumber,v.episodeNumber)})," - ",f.title]}),xs=v&&` ${e("video:season")} ${v.seasonNumber}/${$==null?void 0:$.length} - ${e("video:episode")} ${v.episodeNumber}/${H}`,Zt=r.jsx(vn,{title:b==null?void 0:b.title,description:oe,url:Ee}),es=r.jsx(zs,{item:f||O,playUrl:is({episodeId:(f==null?void 0:f.mediaid)||(O==null?void 0:O.mediaid),seriesId:i,play:!0,playlistId:l})},d),rt=k&&r.jsx(rr,{item:f||O}),ts=(!!w||x)&&r.jsx(F,{label:e("video:trailer"),"aria-label":e("video:watch_trailer"),startIcon:r.jsx(K,{icon:er}),onClick:()=>n(!0),active:t,fullWidth:s<Z.md,disabled:!w});return r.jsxs(Te.Fragment,{children:[r.jsxs(It,{children:[r.jsx("title",{children:V}),r.jsx("link",{rel:"canonical",href:Ee}),r.jsx("meta",{name:"description",content:oe}),r.jsx("meta",{property:"og:description",content:oe}),r.jsx("meta",{property:"og:title",content:V}),r.jsx("meta",{property:"og:type",content:f?"video.episode":"video.series"}),y&&r.jsx("meta",{property:"og:image",content:y==null?void 0:y.replace(/^https:/,"http:")}),y&&r.jsx("meta",{property:"og:image:secure_url",content:y==null?void 0:y.replace(/^http:/,"https:")}),y&&r.jsx("meta",{property:"og:image:width",content:y?"720":""}),y&&r.jsx("meta",{property:"og:image:height",content:y?"406":""}),r.jsx("meta",{name:"twitter:title",content:V}),r.jsx("meta",{name:"twitter:description",content:oe}),y&&r.jsx("meta",{name:"twitter:image",content:y}),r.jsx("meta",{property:"og:video",content:Ee.replace(/^https:/,"http:")}),r.jsx("meta",{property:"og:video:secure_url",content:Ee.replace(/^http:/,"https:")}),r.jsx("meta",{property:"og:video:type",content:"text/html"}),r.jsx("meta",{property:"og:video:width",content:"1280"}),r.jsx("meta",{property:"og:video:height",content:"720"}),b.tags?String(b.tags).split(",").map(xe=>r.jsx("meta",{property:"og:video:tag",content:xe},xe)):null,u&&b?r.jsx("script",{type:"application/ld+json",children:pb(u,f,v,i)}):null]}),r.jsx(tr,{item:f,title:b.title,description:oe,inlineLayout:A,primaryMetadata:Ve,secondaryMetadata:Je,image:se,shareButton:Zt,favoriteButton:rt,trailerButton:ts,startWatchingButton:es,isLoading:ve,accessModel:j,isLoggedIn:re,hasSubscription:$e,playlist:I,relatedTitle:A?b.title:e("episodes"),setFilter:D,currentFilter:L,defaultFilterLabel:e("all_seasons"),activeLabel:e("current_episode"),watchHistory:ee,filterMetadata:xs,filters:$,getURL:je,player:A&&(f||O)?r.jsx(sr,{isLoggedIn:re,item:f||O,onComplete:ce,feedId:l??void 0,startWatchingButton:es,isEntitled:R,hasMediaOffers:z,autostart:c||void 0}):r.jsx(yn,{open:c&&R,onClose:me,item:f||O,title:(f==null?void 0:f.title)||O.title,primaryMetadata:Ve,secondaryMetadata:Je,onComplete:ce,feedId:l??void 0})}),f&&r.jsx(nr,{item:w,title:`${f.title} - Trailer`,open:t,onClose:()=>n(!1)})]})};class Aa{constructor(){m(this,"defaultScreen");m(this,"definitions",[])}register(e,t){this.definitions.push({component:e,predicate:t})}registerByContentType(e,t){this.register(e,n=>!!n&&Yt(n,t))}registerDefault(e){this.defaultScreen=e}getScreen(e){var n;const t=(n=this.definitions.find(({predicate:a})=>a(e)))==null?void 0:n.component;if(t)return t;if(!this.defaultScreen)throw new Error("Default screen not defined");return this.defaultScreen}}const gb="_mediaStaticPage_v6zr1_1",_b={mediaStaticPage:gb},yb=({data:s})=>{const{config:e}=G(({config:o})=>({config:o}),de),{siteName:t}=e,n=`${s.title} - ${t}`,a=s?`${W.APP_PUBLIC_URL}${Ae({id:s.mediaid,title:s.title})}`:window.location.href;return p.useEffect(()=>{(document.scrollingElement||document.body).scroll({top:0})},[s.mediaid]),r.jsxs(r.Fragment,{children:[r.jsxs(It,{children:[r.jsx("title",{children:n}),r.jsx("link",{rel:"canonical",href:a}),r.jsx("meta",{property:"og:title",content:n}),r.jsx("meta",{name:"twitter:title",content:n})]}),r.jsx("div",{className:_b.mediaStaticPage,children:r.jsx(Hs,{markdownString:s.markdown||s.description})})]})},Ta=(s,e)=>{const{mediaid:t,title:n}=s,a=`${e}${Ae({id:t,title:n})}`;return JSON.stringify({"@context":"http://schema.org/","@type":"VideoObject","@id":a,name:s.title,description:s.description,duration:Un(s.duration,!0),thumbnailUrl:s.image,uploadDate:Un(s.pubdate)})},vb=(s,e,t,n)=>({"@type":"TVSeries","@id":`${n}/m/${t}`,name:e.title,numberOfEpisodes:String((s==null?void 0:s.episode_count)||0),numberOfSeasons:String((s==null?void 0:s.season_count)||0)}),xb=(s,e,t,n,a)=>{const o=`${t}/m/${s.series_id}?e=${n==null?void 0:n.mediaid}`,i=vb(s,e,s.series_id,t);return JSON.stringify(n?{"@context":"http://schema.org/","@type":"TVEpisode","@id":o,episodeNumber:(a==null?void 0:a.episodeNumber)||"0",seasonNumber:(a==null?void 0:a.seasonNumber)||"0",name:n.title,uploadDate:Un(n.pubdate),partOfSeries:i}:i)},Zl=({data:s,isLoading:e})=>{var z,re,$e;const{t}=T("video"),[n,a]=p.useState(!1),o=Pe(),i=ae(),l=Fs().id||"",d=He("play")==="1",h=He("r"),{config:u,accessModel:g}=G(({config:me,accessModel:je})=>({config:me,accessModel:je}),de),{siteName:_,features:f,custom:x}=u,w=!!(f!=null&&f.favoritesList),v=!!(x!=null&&x.inlinePlayer),{isLoading:b,data:y}=Qt((s==null?void 0:s.trailerId)||""),{isLoading:C,data:j}=gn((f==null?void 0:f.recommendationsPlaylist)||"",{related_media_id:l}),{user:S,subscription:E}=U(({user:me,subscription:je})=>({user:me,subscription:je}),de),{isEntitled:P,mediaOffers:k}=qs(s),A=!!k.length,$=()=>s&&i(Ae({id:s.mediaid,title:s.title,playlistId:h,play:!1})),L=me=>Ae({id:me.mediaid,title:me.title,playlistId:f==null?void 0:f.recommendationsPlaylist}),D=p.useCallback(()=>{if(!l||!j)return;const me=j.playlist.findIndex(({mediaid:ce})=>ce===l),je=j.playlist[me+1];return je&&i(Ae({id:je.mediaid,title:je.title,playlistId:f==null?void 0:f.recommendationsPlaylist,play:!0}))},[l,j,i,f==null?void 0:f.recommendationsPlaylist]);p.useEffect(()=>{var me;(document.scrollingElement||document.body).scroll({top:0}),(me=document.querySelector("#video-details button"))==null||me.focus()},[l]);const O=`${s.title} - ${_}`,I=s?`${W.APP_PUBLIC_URL}${Ae({id:s.mediaid,title:s.title})}`:window.location.href,H=r.jsx(Os,{attributes:Ia(s,{hoursAbbreviation:t("common:abbreviation.hours"),minutesAbbreviation:t("common:abbreviation.minutes")})}),X=r.jsx(vn,{title:s.title,description:s.description,url:I}),ee=r.jsx(zs,{item:s,playUrl:Ae({id:s.mediaid,title:s.title,playlistId:h,play:!0})},l),Q=w&&r.jsx(rr,{item:s}),N=(!!y||b)&&r.jsx(F,{label:t("video:trailer"),"aria-label":t("video:watch_trailer"),startIcon:r.jsx(K,{icon:er}),onClick:()=>a(!0),active:n,fullWidth:o<Z.md,disabled:!y}),R=!!S,Y=!!E;return r.jsxs(Te.Fragment,{children:[r.jsxs(It,{children:[r.jsx("title",{children:O}),r.jsx("link",{rel:"canonical",href:I}),r.jsx("meta",{name:"description",content:s.description}),r.jsx("meta",{property:"og:description",content:s.description}),r.jsx("meta",{property:"og:title",content:O}),r.jsx("meta",{property:"og:type",content:"video.other"}),s.image&&r.jsx("meta",{property:"og:image",content:(z=s.image)==null?void 0:z.replace(/^https:/,"http:")}),s.image&&r.jsx("meta",{property:"og:image:secure_url",content:(re=s.image)==null?void 0:re.replace(/^http:/,"https:")}),r.jsx("meta",{property:"og:image:width",content:s.image?"720":""}),r.jsx("meta",{property:"og:image:height",content:s.image?"406":""}),r.jsx("meta",{name:"twitter:title",content:O}),r.jsx("meta",{name:"twitter:description",content:s.description}),r.jsx("meta",{name:"twitter:image",content:s.image}),r.jsx("meta",{property:"og:video",content:I.replace(/^https:/,"http:")}),r.jsx("meta",{property:"og:video:secure_url",content:I.replace(/^http:/,"https:")}),r.jsx("meta",{property:"og:video:type",content:"text/html"}),r.jsx("meta",{property:"og:video:width",content:"1280"}),r.jsx("meta",{property:"og:video:height",content:"720"}),($e=s.tags)==null?void 0:$e.split(",").map(me=>r.jsx("meta",{property:"og:video:tag",content:me},me)),s?r.jsx("script",{type:"application/ld+json",children:Ta(s,W.APP_PUBLIC_URL)}):null]}),r.jsx(tr,{item:s,inlineLayout:v,isLoading:e||C,accessModel:g,isLoggedIn:R,hasSubscription:Y,title:s.title,description:s.description,image:s.backgroundImage,primaryMetadata:H,shareButton:X,favoriteButton:Q,trailerButton:N,startWatchingButton:ee,playlist:j,relatedTitle:j==null?void 0:j.title,getURL:L,activeLabel:t("current_video"),player:v?r.jsx(sr,{isLoggedIn:R,item:s,onComplete:D,feedId:h??void 0,startWatchingButton:ee,isEntitled:P,hasMediaOffers:A,autostart:d||void 0}):r.jsx(yn,{open:d&&P,onClose:$,item:s,title:s.title,primaryMetadata:H,onComplete:D,feedId:h??void 0,onNext:D})}),r.jsx(nr,{item:y,title:`${s.title} - Trailer`,open:n,onClose:()=>a(!1)})]})},wb=s=>s&&"seasons"in s?s.seasons.map(e=>({label:e.season_title||String(e.season_number),value:String(e.season_number)})):[],bb=(s,e)=>{var t;return(t=((e==null?void 0:e.seasons)||[]).find(n=>n.season_number===Number(s==null?void 0:s.seasonNumber)))==null?void 0:t.episode_count},Sb=s=>{const e=q(Le),{data:t,isLoading:n,error:a}=We(["series",s],async()=>await e.getSeries(s||""),{enabled:!!s,staleTime:ps,cacheTime:ms,retry:(o,i)=>i.code!==404&&o<2});return{data:t,isLoading:n,error:a}},jb=s=>{const{page:e,page_limit:t,total:n}=s;if(!(t*e>=n))return e},Cb=(s,e,t)=>{const n=q(Le),{i18n:a}=T(),o=a.language;console.log("useEpisodes | seriesId: "+s+" | seasonNo: "+e);const{data:i,fetchNextPage:c,isLoading:l,hasNextPage:d=!1}=Vd([s,e,o],async({pageParam:h=0})=>{if(Number(e)){const u=await n.getSeasonWithEpisodes({seriesId:s,seasonNumber:Number(e),pageOffset:h,language:o});return{pagination:u.pagination,episodes:u.episodes}}else return await n.getEpisodes({seriesId:s,pageOffset:h,language:o})},{getNextPageParam:h=>jb(h==null?void 0:h.pagination),enabled:t.enabled,staleTime:ps,cacheTime:ms});return{data:(i==null?void 0:i.pages)||[],isLoading:l,fetchNextPage:c,hasNextPage:d}},ed=s=>{const e=q(Le),{isLoading:t,data:n}=We(["seriesLookup",s],async()=>{var i;if(!s)return;const a=await e.getSeriesByMediaIds([s]);return(i=a==null?void 0:a[s])==null?void 0:i[0]},{staleTime:ps,cacheTime:ms,enabled:!!s});return{isLoading:t,data:n}},Pb=({series:s,episodeId:e})=>{const t=q(Le),{i18n:n}=T(),a=n.language,{isLoading:o,data:i}=We(["next-episode",s==null?void 0:s.series_id,e,a],async()=>{var l;const c=await t.getEpisodes({seriesId:s==null?void 0:s.series_id,pageLimit:1,afterId:e,language:a});return(l=c==null?void 0:c.episodes)==null?void 0:l[0]},{staleTime:ps,cacheTime:ms,enabled:!!(s!=null&&s.series_id&&e)});return{isLoading:o,data:i}},Eb=({series:s})=>{const e=q(Le),{i18n:t}=T(),{isLoading:n,data:a}=We(["first-episode",s==null?void 0:s.series_id],async()=>{var i;const o=await e.getEpisodes({seriesId:s==null?void 0:s.series_id,pageLimit:1,language:t.language});return(i=o==null?void 0:o.episodes)==null?void 0:i[0]},{staleTime:ps,cacheTime:ms,enabled:!!(s!=null&&s.series_id)});return{isLoading:n,data:a}},td=({data:s})=>{var Ra,Oa,Da;const e=Pe(),{t}=T("video"),[n,a]=p.useState(!1),[o,i]=dn(),c=s.mediaid,l=o.get("play")==="1",d=o.get("r"),h=o.get("e"),{isLoading:u,data:g,error:_}=Sb(c),{isLoading:f,data:x}=Qt(h||""),{isLoading:w,data:v}=Qt((x==null?void 0:x.trailerId)||""),{isLoading:b,data:y}=ed(h||void 0),{isLoading:C,data:j}=Eb({series:g}),S=x||s,{config:E,accessModel:P}=G(({config:le,accessModel:ar})=>({config:le,accessModel:ar}),de),{features:k,siteName:A,custom:$}=E,L=!!(k!=null&&k.favoritesList),D=!!($!=null&&$.inlinePlayer),O=p.useMemo(()=>wb(g),[g]),[I,H]=p.useState(void 0),{data:X,fetchNextPage:ee,hasNextPage:Q}=Cb(c,I,{enabled:I!==void 0&&!!g}),N=p.useMemo(()=>y&&{episodeNumber:y!=null&&y.episode_number?String(y.episode_number):"",seasonNumber:y!=null&&y.season_number?String(y.season_number):""},[y]),R=p.useMemo(()=>({title:s.title,description:s.description,feedid:g==null?void 0:g.series_id,playlist:(X==null?void 0:X.flatMap(le=>le.episodes))||[]}),[s,g,X]),Y=bb(N,g),{data:z}=Pb({series:g,episodeId:(x==null?void 0:x.mediaid)||(j==null?void 0:j.mediaid)}),re=gt(le=>le.watchHistory),$e=gt(le=>le.getDictionaryWithEpisodes()),me=re.find(le=>(le==null?void 0:le.seriesId)===c&&le.progress>Jt.Min&&le.progress<Jt.Max),{user:je,subscription:ce}=U(({user:le,subscription:ar})=>({user:le,subscription:ar}),de),{isEntitled:ve,mediaOffers:V}=qs(x||j),oe=!!V.length,Ee=!!je,se=!!ce,Ve=ue(),Je=le=>ml(Ve,{e:le.mediaid}),xs=p.useCallback(()=>{i({...o,e:x==null?void 0:x.mediaid,r:d||""})},[i,o,x,d]),Zt=p.useCallback(async()=>{var le;i({...o,e:(le=z||x)==null?void 0:le.mediaid,r:d||"",play:z?"1":"0"})},[i,z,x,d,o]),es=p.useCallback(async()=>{x||i({...o,e:j==null?void 0:j.mediaid,r:d||"",play:"1"})},[i,j,d,x,o]);p.useEffect(()=>{var le;(document.scrollingElement||document.body).scroll({top:0}),(le=document.querySelector("#video-details button"))==null||le.focus()},[x]),p.useEffect(()=>{me&&!o.get("e")&&i({...o,e:me.mediaid,r:d||""},{replace:!0})},[me,i,o,d]),p.useEffect(()=>{var le;if(!(u||f||b)){if(!h&&I===void 0){H(((le=O[0])==null?void 0:le.value)||"");return}I===void 0&&N&&H(N.seasonNumber)}},[N,I,u,f,b,O,h]);const rt=x||j,ts=u||b||f||C,Gs=p.useMemo(()=>rt&&r.jsx(zs,{item:rt,onClick:()=>{i({...o,e:rt.mediaid,r:d||"",play:"1"},{replace:!0})}},h),[h,rt,i,o,d]);if(ts)return r.jsx(vs,{});if((_==null?void 0:_.code)===404){const le=tl(s,l,d);return r.jsx(us,{to:le,replace:!0})}if(!s||!g||!rt)return r.jsx(nt,{title:t("series_error")});const ws=`${S.title} - ${A}`,xe=`${W.APP_PUBLIC_URL}${Ae({id:s.mediaid,title:s.title,episodeId:x==null?void 0:x.mediaid})}`,bs=r.jsx(Os,{attributes:Ia(S,{episodesLabel:t("video:total_episodes",{count:g.episode_count}),hoursAbbreviation:t("common:abbreviation.hours"),minutesAbbreviation:t("common:abbreviation.minutes")})}),$a=N&&x&&r.jsxs(r.Fragment,{children:[r.jsx("strong",{children:Kn(N.seasonNumber,N.episodeNumber)})," - ",x.title]}),dd=N&&` ${t("video:season")} ${N.seasonNumber}/${O==null?void 0:O.length} - ${t("video:episode")} ${N.episodeNumber}/${Y}`,ud=r.jsx(vn,{title:S==null?void 0:S.title,description:S.description,url:xe}),hd=L&&r.jsx(rr,{item:s||j}),md=(!!v||w)&&r.jsx(F,{label:t("video:trailer"),"aria-label":t("video:watch_trailer"),startIcon:r.jsx(K,{icon:er}),onClick:()=>a(!0),active:n,fullWidth:e<Z.md,disabled:!v});return r.jsxs(Te.Fragment,{children:[r.jsxs(It,{children:[r.jsx("title",{children:ws}),r.jsx("link",{rel:"canonical",href:xe}),r.jsx("meta",{name:"description",content:S.description}),r.jsx("meta",{property:"og:description",content:S.description}),r.jsx("meta",{property:"og:title",content:ws}),r.jsx("meta",{property:"og:type",content:x?"video.episode":"video.series"}),S.image&&r.jsx("meta",{property:"og:image",content:(Ra=S.image)==null?void 0:Ra.replace(/^https:/,"http:")}),S.image&&r.jsx("meta",{property:"og:image:secure_url",content:(Oa=S.image)==null?void 0:Oa.replace(/^http:/,"https:")}),S.image&&r.jsx("meta",{property:"og:image:width",content:S.image?"720":""}),S.image&&r.jsx("meta",{property:"og:image:height",content:S.image?"406":""}),r.jsx("meta",{name:"twitter:title",content:ws}),r.jsx("meta",{name:"twitter:description",content:S.description}),r.jsx("meta",{name:"twitter:image",content:S.image}),r.jsx("meta",{property:"og:video",content:xe.replace(/^https:/,"http:")}),r.jsx("meta",{property:"og:video:secure_url",content:xe.replace(/^http:/,"https:")}),r.jsx("meta",{property:"og:video:type",content:"text/html"}),r.jsx("meta",{property:"og:video:width",content:"1280"}),r.jsx("meta",{property:"og:video:height",content:"720"}),(Da=S.tags)==null?void 0:Da.split(",").map(le=>r.jsx("meta",{property:"og:video:tag",content:le},le)),S?r.jsx("script",{type:"application/ld+json",children:xb(g,s,W.APP_PUBLIC_URL,x,N)}):null]}),r.jsx(tr,{item:S,title:D?S.title:s.title,description:S.description||s.description,inlineLayout:D,primaryMetadata:bs,secondaryMetadata:$a,image:S.backgroundImage,shareButton:ud,favoriteButton:hd,trailerButton:md,startWatchingButton:Gs,isLoading:ts,accessModel:P,isLoggedIn:Ee,hasSubscription:se,playlist:R,relatedTitle:D?s.title:t("episodes"),getURL:Je,setFilter:H,currentFilter:I,defaultFilterLabel:t("all_seasons"),activeLabel:t("current_episode"),watchHistory:$e,filterMetadata:dd,filters:O,hasMore:Q,loadMore:ee,player:D?r.jsx(sr,{isLoggedIn:Ee,item:rt,seriesItem:s,onComplete:Zt,feedId:d??void 0,onPlay:es,startWatchingButton:Gs,isEntitled:ve,hasMediaOffers:oe,autostart:l||void 0}):r.jsx(yn,{open:l&&ve,onClose:xs,item:rt,seriesItem:s,title:s.title,primaryMetadata:bs,secondaryMetadata:$a,onComplete:Zt,feedId:d??void 0})}),x&&r.jsx(nr,{item:v,title:`${x.title} - Trailer`,open:n,onClose:()=>a(!1)})]})},kb=({data:s,isLoading:e})=>{const t=s.liveChannelsId;return e?r.jsx(vs,{}):t?r.jsx(us,{to:Ls(t,s.mediaid),replace:!0}):r.jsx(Zl,{data:s,isLoading:e})},sd=({data:s,isLoading:e})=>{const t=s.mediaid,[n]=dn(),a=n.get("play")==="1",o=n.get("r"),{data:i,isLoading:c}=ed(s.mediaid),{isLoading:l,data:d}=Qt((i==null?void 0:i.series_id)||"");if(e||c||l)return r.jsx(vs,{});if(!i)return r.jsx(us,{to:tl(s,a,o),replace:!0});const{mediaid:h,title:u}=d;return r.jsx(us,{to:Ae({episodeId:t,id:h,title:u,play:a,playlistId:o}),replace:!0})};function Ib(s){return{isLiveEvent:Vc(s),isPlayable:Su(s)}}const Ab="_tag_gc1jh_1",Tb="_normal_gc1jh_11",Nb="_large_gc1jh_20",Lb="_live_gc1jh_31",Nr={tag:Ab,normal:Tb,large:Nb,live:Lb},Xr=({children:s,className:e,isLive:t=!1,size:n="normal"})=>r.jsx("div",{className:M(e,Nr.tag,Nr[n],{[Nr.live]:t}),children:s}),$b="_icon_1fdnv_1",Cc={icon:$b};function Rb({mediaStatus:s}){const{t:e}=T("video");return s===Mt.SCHEDULED||s===Mt.VOD?r.jsx(K,{icon:ja,className:Cc.icon}):s===Mt.LIVE?r.jsx(Xr,{isLive:!0,className:Cc.icon,children:e("live")}):null}const Ob=({data:s,isLoading:e})=>{var je,ce,ve;const{t,i18n:n}=T(["video","common"]),[a,o]=p.useState(!1),i=Pe(),c=ae(),d=Fs().id||"",h=He("play")==="1",u=He("r"),{config:g,accessModel:_}=G(({config:V,accessModel:oe})=>({config:V,accessModel:oe}),de),{siteName:f,features:x,custom:w}=g,v=!!(x!=null&&x.favoritesList),b=!!(w!=null&&w.inlinePlayer),{isLoading:y,data:C}=Qt((s==null?void 0:s.trailerId)||""),{isLoading:j,data:S}=gn(u||""),E=Ib(s),{user:P,subscription:k}=U(({user:V,subscription:oe})=>({user:V,subscription:oe}),de),{isEntitled:A,mediaOffers:$}=qs(s),L=!!$.length,D=()=>s&&c(Ae({id:s.mediaid,title:s.title,playlistId:u,play:!1})),O=V=>Ae({id:V.mediaid,title:V.title,playlistId:u}),I=p.useCallback(()=>{if(!d||!S)return;const V=S.playlist.findIndex(({mediaid:Ee})=>Ee===d),oe=S.playlist[V+1];if(oe.mediaStatus!==Mt.SCHEDULED)return oe&&c(Ae({id:oe.mediaid,title:oe.title,playlistId:u,play:!0}))},[d,S,c,u]);p.useEffect(()=>{var V;(document.scrollingElement||document.body).scroll({top:0}),(V=document.querySelector("#video-details button"))==null||V.focus()},[d]);const{title:H,mediaid:X}=s,ee=`${H} - ${f}`,Q=s?`${W.APP_PUBLIC_URL}${Ae({id:X,title:H})}`:window.location.href,N=r.jsxs(r.Fragment,{children:[r.jsx(Rb,{mediaStatus:s.mediaStatus}),r.jsx(Os,{attributes:iw(s,n.language,{minutesAbbreviation:t("common:abbreviation.minutes"),hoursAbbreviation:t("common:abbreviation.hours")})})]}),R=r.jsx(vn,{title:s.title,description:s.description,url:Q}),Y=r.jsx(zs,{item:s,playUrl:Ae({id:X,title:H,playlistId:u,play:!0}),disabled:!E.isPlayable},d),z=v&&r.jsx(rr,{item:s}),re=(!!C||y)&&r.jsx(F,{label:t("video:trailer"),"aria-label":t("video:watch_trailer"),startIcon:r.jsx(K,{icon:er}),onClick:()=>o(!0),active:a,fullWidth:i<Z.md,disabled:!C}),$e=!!P,me=!!k;return r.jsxs(Te.Fragment,{children:[r.jsxs(It,{children:[r.jsx("title",{children:ee}),r.jsx("link",{rel:"canonical",href:Q}),r.jsx("meta",{name:"description",content:s.description}),r.jsx("meta",{property:"og:description",content:s.description}),r.jsx("meta",{property:"og:title",content:ee}),r.jsx("meta",{property:"og:type",content:"video.other"}),s.image&&r.jsx("meta",{property:"og:image",content:(je=s.image)==null?void 0:je.replace(/^https:/,"http:")}),s.image&&r.jsx("meta",{property:"og:image:secure_url",content:(ce=s.image)==null?void 0:ce.replace(/^http:/,"https:")}),r.jsx("meta",{property:"og:image:width",content:s.image?"720":""}),r.jsx("meta",{property:"og:image:height",content:s.image?"406":""}),r.jsx("meta",{name:"twitter:title",content:ee}),r.jsx("meta",{name:"twitter:description",content:s.description}),r.jsx("meta",{name:"twitter:image",content:s.image}),r.jsx("meta",{property:"og:video",content:Q.replace(/^https:/,"http:")}),r.jsx("meta",{property:"og:video:secure_url",content:Q.replace(/^http:/,"https:")}),r.jsx("meta",{property:"og:video:type",content:"text/html"}),r.jsx("meta",{property:"og:video:width",content:"1280"}),r.jsx("meta",{property:"og:video:height",content:"720"}),(ve=s.tags)==null?void 0:ve.split(",").map(V=>r.jsx("meta",{property:"og:video:tag",content:V},V)),s?r.jsx("script",{type:"application/ld+json",children:Ta(s,W.APP_PUBLIC_URL)}):null]}),r.jsx(tr,{item:s,inlineLayout:b,isLoading:e||j,accessModel:_,isLoggedIn:$e,hasSubscription:me,title:s.title,description:s.description,image:s.backgroundImage,primaryMetadata:N,shareButton:R,favoriteButton:z,trailerButton:re,startWatchingButton:Y,playlist:S,relatedTitle:S==null?void 0:S.title,getURL:O,activeLabel:t("current_video"),player:b?r.jsx(sr,{isLoggedIn:$e,item:s,onComplete:I,feedId:u??void 0,startWatchingButton:Y,isEntitled:A,hasMediaOffers:L,autostart:E.isPlayable&&(h||void 0),playable:E.isPlayable}):r.jsx(yn,{open:h&&A,onClose:D,item:s,title:s.title,primaryMetadata:N,onComplete:I,feedId:u??void 0,onNext:I})}),r.jsx(nr,{item:C,title:`${s.title} - Trailer`,open:a,onClose:()=>o(!1)})]})},Nt=new Aa;Nt.registerByContentType(td,st.series);Nt.registerByContentType(sd,st.episode);Nt.registerByContentType(kb,st.liveChannel);Nt.registerByContentType(Ob,st.liveEvent);Nt.registerByContentType(yb,st.page);Nt.registerDefault(Zl);Nt.register(sd,s=>!!s&&Xc(s));Nt.register(td,s=>!!s&&Yc(s));const Db=()=>{const e=Fs().id||"",{isLoading:t,isFetching:n,error:a,data:o}=Qt(e),{t:i}=T("error");if(t)return r.jsx(vs,{});if(a||!o)return r.jsx(nt,{title:i("video_not_found")});const c=Nt.getScreen(o);return r.jsx(Vs,{open:!0,children:r.jsx(c,{data:o,isLoading:n})})},Fb="_playlist_1tsu4_1",Mb="_header_1tsu4_17",Pc={playlist:Fb,header:Mb},nd=({data:s,isLoading:e})=>{const t=Xn("title"),{config:n,accessModel:a}=G(({config:x,accessModel:w})=>({config:x,accessModel:w}),de),[o,i]=p.useState(""),c=Ih(n,s.feedid),l=p.useMemo(()=>Ah(s,o),[s,o]),d=!!c.length,{user:h,subscription:u}=U(({user:x,subscription:w})=>({user:x,subscription:w}),de);p.useEffect(()=>{i("")},[s.feedid]);const g=(s==null?void 0:s[t])||s.title,_=`${g} - ${n.siteName}`,f=x=>Ae({id:x.mediaid,title:x.title,playlistId:x.feedid});return r.jsxs("div",{className:Pc.playlist,children:[r.jsxs(It,{children:[r.jsx("title",{children:_}),r.jsx("meta",{property:"og:title",content:_}),r.jsx("meta",{name:"twitter:title",content:_})]}),r.jsxs("header",{className:Pc.header,children:[r.jsx("h1",{children:g}),d&&r.jsx(Vl,{name:"genre",value:o,defaultLabel:"All",options:c,setValue:i})]}),r.jsx(Zn,{getUrl:f,playlist:l,accessModel:a,isLoggedIn:!!h,hasSubscription:!!u,isLoading:e,headingLevel:2})]})},Na=s=>{const e=new Date(s.startTime),t=new Date(s.endTime);return Oc(e)&&qd(t)},Bb=s=>{const e=new Date(s.endTime);return Oc(e)},Ub=(s,e=8)=>{const t=new Date(s.startTime),n=Dc(new Date,e);return zd(t,n)},Nn=s=>s.programs.find(Na),Hb=({playlist:s,initialChannelId:e,enableAutoUpdate:t=!0})=>{const n=q(rl),{data:a=[]}=We(["schedules",...s.map(({mediaid:g})=>g)],()=>n.getSchedules(s),{refetchInterval:du}),[o,i]=p.useState(t),[c,l]=p.useState(),[d,h]=p.useState();p.useEffect(()=>{if(!o||!t)return;const g=window.setInterval(()=>c&&h(Nn(c)),5e3);return()=>clearInterval(g)},[c,o,t]),p.useEffect(()=>{const g=a.find(({id:_})=>_===e)||a[0];if(!c&&g&&(l(g),h(Nn(g))),c){const _=a.find(({id:x})=>x===c.id);let f=d&&(_==null?void 0:_.programs.find(({id:x})=>x===(d==null?void 0:d.id)));!f&&_&&(f=Nn(_)),l(_),h(f)}},[a]);const u=p.useCallback((g,_)=>{const f=a==null?void 0:a.find(w=>w.id===g);if(!f)return;const x=_?f.programs.find(w=>w.id===_):Nn(f);l(f),h(x),i(!x||Na(x))},[a]);return{channel:c,channels:a,program:d,setActiveChannel:u}},Wb=({program:s,catchupHours:e})=>{const[t,n]=p.useState(!1),[a,o]=p.useState(!1),[i,c]=p.useState(!1);return p.useEffect(()=>{const l=()=>{n(!!s&&Na(s)),o(!!s&&Bb(s)),c(!!s&&Ub(s,e))},d=setInterval(l,5e3);return l(),()=>clearInterval(d)},[e,s]),{isLive:t,isVod:a,isWatchableFromBeginning:i}},Vb=cb(),qb=({id:s,channelLogoImage:e,backgroundImage:t})=>({uuid:s,logo:e,channelLogoImage:e,backgroundImage:t}),zb=(s,{id:e,title:t,cardImage:n,backgroundImage:a,description:o,endTime:i,startTime:c})=>({channelUuid:s,id:e,title:t,image:n||"",cardImage:n||"",backgroundImage:a||"",description:o||"",till:i,since:c}),Gb=({channels:s,sidebarWidth:e,itemHeight:t})=>{const[n,a]=p.useMemo(()=>[s.map(qb),s.flatMap(d=>d.programs.map(h=>zb(d.id,h)))],[s]),o=p.useMemo(()=>Kb(),[]),i=Gd().toJSON(),[c,l]=p.useMemo(()=>[Kd(new Date(i)),Jd()],[i]);return Yd({channels:n,epg:a,dayWidth:7200,sidebarWidth:e,itemHeight:t,isSidebar:!0,isTimeline:!0,isLine:!0,isBaseTimeFormat:Vb,startDate:c,endDate:l,theme:o})},Kb=()=>({primary:{600:"var(--epg-background-color, var(--body-background-color))",900:"var(--epg-background-color, var(--body-background-color))"},grey:{300:"#fff"},white:"#fff",green:{300:"#fff"},loader:{teal:"",purple:"",pink:"",bg:""},scrollbar:{border:"",thumb:{bg:""}},gradient:{blue:{300:"",600:"",900:""}},text:{grey:{300:"",500:""}},timeline:{divider:{bg:""}}}),Jb="_epgChannelBox_15tvm_1",Yb="_epgChannel_15tvm_1",Qb="_epgChannelLogo_15tvm_27",Ln={epgChannelBox:Jb,epgChannel:Yb,epgChannelLogo:Qb},Xb=({channel:s,channelItemWidth:e,sidebarWidth:t,onClick:n,isActive:a,title:o})=>{const{position:i,uuid:c,channelLogoImage:l}=s,d={top:i.top,height:i.height,width:t};return r.jsx("div",{className:Ln.epgChannelBox,style:d,children:r.jsx("div",{className:M(Ln.epgChannel,{[Ln.active]:a}),style:{width:e},onClick:()=>n&&n(s),"data-testid":void 0,role:"button",children:r.jsx(Ws,{className:Ln.epgChannelLogo,image:l,alt:o,width:320})})})},Zb="_epgProgramBox_h87h7_1",eS="_epgProgram_h87h7_1",tS="_disabled_h87h7_24",sS="_live_h87h7_28",nS="_selected_h87h7_31",rS="_epgProgramTitle_h87h7_34",aS="_epgProgramText_h87h7_37",oS="_epgLiveTag_h87h7_50",iS="_epgProgramContent_h87h7_77",cS="_epgProgramImage_h87h7_119",ct={epgProgramBox:Zb,epgProgram:eS,disabled:tS,live:sS,selected:nS,epgProgramTitle:rS,epgProgramText:aS,epgLiveTag:oS,epgProgramContent:iS,epgProgramImage:cS},lS=({program:s,onClick:e,isActive:t,compact:n,disabled:a,isBaseTimeFormat:o})=>{const{styles:{position:i},formatTime:c,set12HoursTimeFormat:l,isLive:d,isMinWidth:h}=Qd({program:s,isBaseTimeFormat:o}),{t:u}=T("common"),{data:g}=s,{image:_,title:f,since:x,till:w}=g,v=c(x,l()).toLowerCase(),b=c(w,l()).toLowerCase(),y=!n&&h,C=!n&&h&&d,j="";return r.jsx("div",{className:ct.epgProgramBox,style:i,onClick:()=>e&&e(s),children:r.jsxs("div",{className:M(ct.epgProgram,{[ct.selected]:t,[ct.live]:d,[ct.disabled]:a}),style:{width:ct.width},"data-testid":(s.data.id,void 0),children:[y&&r.jsx("img",{className:ct.epgProgramImage,src:_,alt:j}),C&&r.jsx("div",{className:ct.epgLiveTag,children:u("live")}),r.jsxs("div",{className:ct.epgProgramContent,children:[n&&d&&r.jsx("div",{className:ct.epgLiveTag,children:u("live")}),r.jsx("h2",{className:ct.epgProgramTitle,children:f}),r.jsxs("span",{className:ct.epgProgramText,children:[v," - ",b]})]})]})})},dS="_timelineBox_10xo1_1",uS="_timelineTime_10xo1_5",hS="_timelineContainer_10xo1_16",mS="_timelineDividers_10xo1_23",pS="_timelineDivider_10xo1_23",en={timelineBox:dS,timelineTime:uS,timelineContainer:hS,timelineDividers:mS,timelineDivider:pS},fS=({isBaseTimeFormat:s,dayWidth:e,hourWidth:t,numberOfHoursInDay:n,offsetStartHoursRange:a,isSidebar:o,sidebarWidth:i})=>{const{time:c,dividers:l,formatTime:d}=Xd(n,s),h=()=>l.map((g,_)=>r.jsx("div",{className:en.timelineDivider,style:{marginRight:t/4}},_)),u=g=>r.jsxs("div",{className:en.timelineBox,style:{width:t},children:[r.jsx("time",{className:en.timelineTime,children:d(g+a).toLowerCase()}),r.jsx("div",{className:en.timelineDividers,children:h()})]},g);return r.jsx("div",{className:en.timelineContainer,style:{width:e,left:o?i:0},children:c.map((g,_)=>u(_))})},gS="_epg_j4bmq_1",_S="_firstFrame_j4bmq_8",yS="_epgSpinner_j4bmq_42",vS="_timelineControl_j4bmq_50",xS="_timelineNowButton_j4bmq_65",wS="_leftControl_j4bmq_76",bS="_rightControl_j4bmq_77",as={epg:gS,firstFrame:_S,epgSpinner:yS,timelineControl:vS,timelineNowButton:xS,leftControl:wS,rightControl:bS};function SS({channels:s,selectedChannel:e,onChannelClick:t,onProgramClick:n,program:a}){const o=Ml(),i=Pe(),{t:c}=T("common"),l=i<Z.sm,d=l?70:184,h=l?d-10:d-24,u=l?80:106,{getEpgProps:g,getLayoutProps:_,onScrollToNow:f,onScrollLeft:x,onScrollRight:w}=Gb({channels:s,sidebarWidth:d,itemHeight:u}),v=p.useMemo(()=>Object.fromEntries(s.map(y=>[y.id,y.catchupHours])),[s]),b=p.useMemo(()=>Object.fromEntries(s.map(y=>[y.id,y.title])),[s]);return r.jsxs("div",{className:M(as.epg,o&&as.firstFrame),children:[r.jsxs("div",{className:as.timelineControl,children:[r.jsx(F,{className:as.timelineNowButton,variant:"contained",label:c("now"),color:"primary",onClick:f,size:"small"}),r.jsx(Ge,{className:as.leftControl,"aria-label":c("slide_left"),onClick:()=>x(),children:r.jsx(K,{icon:ba})}),r.jsx(Ge,{className:as.rightControl,"aria-label":c("slide_right"),onClick:()=>w(),children:r.jsx(K,{icon:_n})})]}),r.jsx(Zd,{...g(),loader:r.jsx(_s,{className:as.epgSpinner}),children:r.jsx(eu,{..._(),renderTimeline:y=>r.jsx(fS,{...y}),renderChannel:({channel:y})=>r.jsx(Xb,{channel:y,channelItemWidth:h,sidebarWidth:d,onClick:C=>{t(C.uuid),f()},title:b[y.uuid]||"",isActive:(e==null?void 0:e.id)===y.uuid},y.uuid),renderProgram:({program:y,isBaseTimeFormat:C})=>{const j=v[y.data.channelUuid],S=tu(new Date(y.data.since),Dc(new Date,j));return r.jsx(lS,{program:y,disabled:S,onClick:E=>!S&&n(E.data.id,E.data.channelUuid),isActive:(a==null?void 0:a.id)===y.data.id,compact:l,isBaseTimeFormat:C},y.data.id)}})})]})}const jS="_epgContainer_17asv_1",CS="_catchupButton_17asv_11",PS="_tag_17asv_17",Lr={epgContainer:jS,catchupButton:CS,tag:PS},ES=({data:{feedid:s,playlist:e}})=>{var H,X,ee;const{t}=T("epg"),{config:n}=G(({config:Q})=>({config:Q}),de),{siteName:a}=n,o=ue(),i=ae(),c=p.useMemo(()=>new URLSearchParams(o.search),[o.search]),l=c.get("play")==="1",d=c.get("channel")??void 0,h=c.get("start"),u=c.get("end"),g=c.get("beginning")==="1",_=()=>s&&i(Ls(s,d)),[f]=p.useState(d),{channels:x,channel:w,program:v,setActiveChannel:b}=Hb({playlist:e,initialChannelId:f,enableAutoUpdate:!g}),{isLive:y,isVod:C,isWatchableFromBeginning:j}=Wb({program:v,catchupHours:w==null?void 0:w.catchupHours}),S=p.useMemo(()=>e.find(({mediaid:Q})=>(w==null?void 0:w.id)===Q),[w==null?void 0:w.id,e]),{isEntitled:E}=qs(S),P=p.useMemo(()=>v?{title:v.title,description:v.description||"",image:v.backgroundImage,canWatch:y||C&&j,canWatchFromBeginning:E&&y&&j}:{title:(w==null?void 0:w.title)||"",description:(w==null?void 0:w.description)||"",image:w==null?void 0:w.backgroundImage,canWatch:!0,canWatchFromBeginning:!1},[w==null?void 0:w.backgroundImage,w==null?void 0:w.description,w==null?void 0:w.title,E,y,C,j,v]),k=p.useMemo(()=>{if(!w)return"";if(!v)return r.jsx(Xr,{isLive:!0,children:t("common:live")});const Q=new Date(v.startTime),N=new Date(v.endTime),R=su(N,Q),Y=da(R,{minutesAbbreviation:t("common:abbreviation.minutes")}),z=[t("on_channel",{name:w.title}),Y].filter(Boolean);return r.jsxs(r.Fragment,{children:[r.jsx(Xr,{className:Lr.tag,isLive:y,children:y?t("common:live"):`${Ua(Q,"p")} - ${Ua(N,"p")}`}),r.jsx(Os,{attributes:z})]})},[w,y,v,t]),A=(Q,N)=>{b(N,Q),(document.scrollingElement||document.body).scroll({top:0,behavior:"smooth"})},$=Q=>{b(Q)};if(p.useEffect(()=>{w&&s&&d!==w.id&&i(Ls(s,w.id),{replace:!0})},[i,s,w,d]),!w||!s)return r.jsx(vs,{});const L=`${W.APP_PUBLIC_URL}${Ls(s,w.id)}`,D=`${w.title} - ${a}`,O=S?r.jsx(vn,{title:S.title,description:S.description,url:window.location.href}):null,I=S?r.jsxs(r.Fragment,{children:[r.jsx(zs,{item:S,playUrl:Ie(Ls(s,d,!0),{start:C?v==null?void 0:v.startTime:void 0,end:C?v==null?void 0:v.endTime:void 0}),disabled:!P.canWatch}),P.canWatchFromBeginning&&r.jsx(F,{className:Lr.catchupButton,onClick:()=>i(Ie(Ls(s||"",d,!0),{start:v==null?void 0:v.startTime,beginning:1})),label:t("start_from_beginning"),startIcon:r.jsx(K,{icon:Dl})})]}):null;return r.jsxs(r.Fragment,{children:[r.jsxs(It,{children:[r.jsx("title",{children:D}),r.jsx("link",{rel:"canonical",href:L}),r.jsx("meta",{name:"description",content:S==null?void 0:S.description}),r.jsx("meta",{property:"og:description",content:S==null?void 0:S.description}),r.jsx("meta",{property:"og:title",content:D}),r.jsx("meta",{property:"og:type",content:"video.other"}),(S==null?void 0:S.image)&&r.jsx("meta",{property:"og:image",content:(H=S.image)==null?void 0:H.replace(/^https:/,"http:")}),(S==null?void 0:S.image)&&r.jsx("meta",{property:"og:image:secure_url",content:(X=S.image)==null?void 0:X.replace(/^http:/,"https:")}),r.jsx("meta",{property:"og:image:width",content:S!=null&&S.image?"720":""}),r.jsx("meta",{property:"og:image:height",content:S!=null&&S.image?"406":""}),r.jsx("meta",{name:"twitter:title",content:D}),r.jsx("meta",{name:"twitter:description",content:S==null?void 0:S.description}),r.jsx("meta",{name:"twitter:image",content:S==null?void 0:S.image}),r.jsx("meta",{property:"og:video",content:L.replace(/^https:/,"http:")}),r.jsx("meta",{property:"og:video:secure_url",content:L.replace(/^http:/,"https:")}),r.jsx("meta",{property:"og:video:type",content:"text/html"}),r.jsx("meta",{property:"og:video:width",content:"1280"}),r.jsx("meta",{property:"og:video:height",content:"720"}),(ee=S==null?void 0:S.tags)==null?void 0:ee.split(",").map(Q=>r.jsx("meta",{property:"og:video:tag",content:Q},Q)),S?r.jsx("script",{type:"application/ld+json",children:Ta(S,W.APP_PUBLIC_URL)}):null]}),r.jsxs(Jl,{title:P.title,description:P.description,image:P.image,startWatchingButton:I,shareButton:O,primaryMetadata:k,children:[S&&r.jsx(yn,{open:l&&E,onClose:_,item:S,title:P.title,primaryMetadata:k,feedId:s,liveStartDateTime:h,liveEndDateTime:u,liveFromBeginning:g}),r.jsx("div",{className:Lr.epgContainer,children:r.jsx(SS,{channels:x,onChannelClick:$,onProgramClick:A,selectedChannel:w,program:v})})]})]})},La=new Aa,rd=new Aa;La.registerDefault(nd);La.registerByContentType(ES,uu.live);rd.registerDefault(nd);const Ec=({type:s})=>{const t=Fs().id||"",{isFetching:n,error:a,data:o}=gn(t,{},!0,!0,s),{t:i}=T("error");if(n)return r.jsx(vs,{});if(a||!o)return r.jsx(nt,{title:i("playlist_not_found")});if(o.playlist.length===0)return r.jsx(nt,{title:i("empty_shelves_heading"),message:i("empty_shelves_description")});const c=s===Ft.content_list?rd.getScreen(o):La.getScreen(o);return r.jsx(Vs,{open:!0,children:r.jsx(c,{data:o,isLoading:n})},t)},kS="_header_1ydaw_1",IS="_fixed_1ydaw_7",AS="_container_1ydaw_18",TS="_menu_1ydaw_27",NS="_iconButton_1ydaw_31",LS="_brand_1ydaw_39",$S="_nav_1ydaw_43",RS="_skipToContent_1ydaw_68",OS="_actions_1ydaw_102",DS="_search_1ydaw_113",FS="_brandCentered_1ydaw_117",MS="_navButton_1ydaw_121",BS="_searchActive_1ydaw_147",ut={header:kS,fixed:IS,static:"_static_1ydaw_12",container:AS,menu:TS,iconButton:NS,brand:LS,nav:$S,skipToContent:RS,actions:OS,search:DS,brandCentered:FS,navButton:MS,searchActive:BS},US=Symbol("HEADER"),HS=({children:s,className:e,headerType:t="static",searchActive:n})=>{const a=M(ut.header,ut[t],e,{[ut.searchActive]:n});return r.jsx("header",{className:a,children:r.jsx("div",{className:ut.container,children:s})})},WS=ys(US,HS),VS="_footer_pj6tn_1",qS="_list_pj6tn_10",zS="_testFixMargin_pj6tn_23",$r={footer:VS,list:qS,testFixMargin:zS},GS=({text:s})=>{const e=s.split("|").map(a=>a.trim()),t=e.map((a,o)=>r.jsx(Hs,{markdownString:a,inline:!0,tag:e.length>1?"li":"div"},o)),n=e.length>1?r.jsx("ul",{className:$r.list,children:t}):t;return r.jsx("footer",{className:M($r.footer,{[$r.testFixMargin]:vu}),children:n})},KS=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),p.createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"})),JS=({className:s,sideBarOpen:e,onClick:t})=>{const{t:n}=T("menu");return r.jsx("div",{className:M(ut.menu,s),children:r.jsx(Ge,{className:ut.iconButton,"aria-label":n("open_menu"),"aria-expanded":e,onClick:t,children:r.jsx(K,{icon:KS})})})},YS=100,QS=({className:s,navItems:e})=>{const t=p.useRef(null),n=a=>{if(!t.current)return;const o=t.current.getBoundingClientRect(),c=a.target.getBoundingClientRect().left+t.current.scrollLeft-o.left,l=c<o.width/2?0:c-YS;t.current.scrollTo({left:l,behavior:"smooth"})};return r.jsx("nav",{className:M(ut.nav,s),ref:t,children:r.jsx("ul",{onFocus:n,children:e.map((a,o)=>r.jsx("li",{children:r.jsx(F,{activeClassname:ut.navButton,label:a.label,to:a.to,variant:"text"})},o))})})},XS="_logo_1yd6a_1",ZS={logo:XS},ej=({src:s,alt:e="logo",onLoad:t})=>{const[n,a]=p.useState({height:void 0,width:void 0}),o=i=>{const{height:c,width:l}=i.currentTarget;a({height:c,width:l}),t()};return r.jsx(un,{to:"/",children:r.jsx("img",{className:ZS.logo,alt:e,src:s,height:n.height,width:n.width,onLoad:o,onError:t})})},tj=({className:s,siteName:e,logoSrc:t,setLogoLoaded:n})=>{const{t:a}=T("menu");return t?r.jsx("div",{className:M(ut.brand,s),children:r.jsx(ej,{alt:a("logo_alt",{siteName:e}),src:t,onLoad:()=>n(!0)})}):null},sj=({children:s,className:e})=>r.jsx("div",{className:M(ut.actions,e),children:s}),nj=({className:s})=>{const{t:e}=T("menu");return r.jsx("a",{href:"#content",className:M(ut.skipToContent,s),children:e("skip_to_content")})},rj="_sidebar_1ve1d_1",aj="_heading_1ve1d_20",oj="_group_1ve1d_25",Rr={sidebar:rj,heading:aj,group:oj},ij=Symbol("SIDEBAR"),cj=({children:s,...e})=>r.jsx(ma,{direction:"left",...e,children:s}),lj=({isOpen:s,onClose:e,children:t})=>{const{t:n}=T("menu");return r.jsx(Jn,{open:s,onClose:e,AnimationComponent:cj,children:r.jsxs("div",{className:Rr.sidebar,id:"sidebar",children:[r.jsx("div",{className:Rr.heading,children:r.jsx(Ge,{onClick:e,"aria-label":n("close_menu"),children:r.jsx(K,{icon:Yn})})}),r.jsx("nav",{className:Rr.group,onClick:e,children:t})]})})},dj=ys(ij,lj),uj="_menuButton_5vhgl_1",hj="_small_5vhgl_24",mj="_startIcon_5vhgl_28",pj="_active_5vhgl_41",Ns={menuButton:uj,small:hj,startIcon:mj,active:pj},fj=Symbol("MENU_BUTTON"),gj=({label:s,to:e,onClick:t,onBlur:n,onFocus:a,tabIndex:o=0,active:i=!1,startIcon:c,small:l=!1,...d})=>{const h=c?r.jsx("div",{className:Ns.startIcon,children:c}):null,u=g=>M(Ns.menuButton,{[Ns.small]:l},{[Ns.active]:g});return e?r.jsxs(Lc,{onBlur:n,onFocus:a,onClick:t,className:({isActive:g})=>u(g||i),to:e,tabIndex:o,end:!0,children:[h,r.jsx("span",{className:Ns.label,children:s})]}):r.jsxs("div",{role:"button",onBlur:n,onFocus:a,className:u(i),onClick:t,tabIndex:o,...d,children:[h,r.jsx("span",{className:Ns.label,children:s})]})},$s=ys(fj,gj),_j="_popover_px6io_1",yj="_menuItems_px6io_5",vj="_divider_px6io_16",xj="_small_px6io_29",wj="_sectionHeader_px6io_43",rn={popover:_j,menuItems:yj,divider:vj,small:xj,sectionHeader:wj},ad=({showPaymentItems:s,small:e=!1,onButtonClick:t,favoritesEnabled:n,focusable:a,titleId:o})=>{const{t:i}=T("user"),c=ae(),l=q(ye),d=a?0:-1,h=p.useCallback(async()=>{t&&t(),await l.logout(),c("/",{replace:!0})},[t,c,l]);return r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:rn.sectionHeader,id:o,children:i("nav.settings")}),r.jsxs("ul",{className:rn.menuItems,children:[r.jsx("li",{children:r.jsx($s,{small:e,onClick:t,to:ku,label:i("nav.account"),startIcon:r.jsx(K,{icon:Pa}),tabIndex:d})}),n&&r.jsx("li",{children:r.jsx($s,{small:e,onClick:t,to:Iu,label:i("nav.favorites"),startIcon:r.jsx(K,{icon:Ea}),tabIndex:d})}),s&&r.jsx("li",{children:r.jsx($s,{small:e,onClick:t,to:Au,label:i("nav.payments"),startIcon:r.jsx(K,{icon:Ul}),tabIndex:d})}),r.jsx("li",{className:M(rn.divider,{[rn.small]:e}),children:r.jsx($s,{small:e,onClick:h,label:i("nav.logout"),startIcon:r.jsx(K,{icon:Hl}),tabIndex:d})})]})]})},bj="_buttonContainer_ak6a2_1",Sj="_separator_ak6a2_10",od={buttonContainer:bj,separator:Sj},jj=({sideBarOpen:s,canLogin:e,isLoggedIn:t,favoritesEnabled:n,onLoginClick:a,onSignUpClick:o})=>{const{t:i}=T("menu"),c=ht("usermenu-title");return e?t?r.jsx("section",{"aria-labelledby":c,children:r.jsx(ad,{focusable:s,favoritesEnabled:n,titleId:c,showPaymentItems:!0})}):r.jsxs("div",{className:od.buttonContainer,children:[r.jsx(F,{tabIndex:s?0:-1,onClick:a,label:i("sign_in"),fullWidth:!0}),r.jsx(F,{tabIndex:s?0:-1,variant:"contained",color:"primary",onClick:o,label:i("sign_up"),fullWidth:!0})]}):null},Cj=()=>{const{t:s}=T("common"),e=Xn("title"),t=ae(),n=ue(),a=Me(f=>f.sideBarOpen),{config:{menu:o,features:i},accessModel:c}=G(f=>({config:f.config,accessModel:f.accessModel})),l=U(({user:f})=>!!f),d=!!(i!=null&&i.favoritesList),h=c!==Fe.AVOD,u=()=>Me.setState({sideBarOpen:!1}),g=()=>{t(J(n,"login"))},_=()=>{t(J(n,"create-account"))};return r.jsxs(dj,{isOpen:a,onClose:u,children:[r.jsxs("ul",{children:[r.jsx("li",{children:r.jsx($s,{label:s("home"),to:"/"})}),o.map(({contentId:f,type:x,label:w,custom:v})=>r.jsx("li",{children:r.jsx($s,{label:(v==null?void 0:v[e])||w,to:el({type:x,contentId:f})})},f))]}),r.jsx("hr",{className:od.separator}),r.jsx(jj,{sideBarOpen:a,favoritesEnabled:d,canLogin:h,isLoggedIn:l,onLoginClick:g,onSignUpClick:_})]})},Pj=()=>{const{t:s}=T("common"),{siteName:e,description:t}=G(({config:a})=>a,de),n=t||s("default_description");return r.jsxs(It,{children:[r.jsx("title",{children:e}),r.jsx("meta",{name:"description",content:n}),r.jsx("meta",{property:"og:description",content:n}),r.jsx("meta",{property:"og:title",content:e}),r.jsx("meta",{name:"twitter:title",content:e}),r.jsx("meta",{name:"twitter:description",content:n})]})},id=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})),Ej=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{d:"M9 1C4.58 1 1 4.58 1 9s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm4 10.87L11.87 13 9 10.13 6.13 13 5 11.87 7.87 9 5 6.13 6.13 5 9 7.87 11.87 5 13 6.13 10.13 9 13 11.87z"})),kj="_searchBar_1plps_1",Ij="_searchForm_1plps_6",Aj="_icon_1plps_10",Tj="_input_1plps_18",Nj="_clearButton_1plps_42",tn={searchBar:kj,searchForm:Ij,icon:Aj,input:Tj,clearButton:Nj},Lj=({query:s,onQueryChange:e,onClearButtonClick:t,onClose:n,inputRef:a})=>{const{t:o}=T("search"),i=c=>{var l;c.preventDefault(),a==null||a.current.focus(),(l=document.querySelector("#content"))==null||l.focus()};return r.jsxs("div",{className:tn.searchBar,children:[r.jsx(K,{icon:id,className:tn.icon}),r.jsxs("form",{className:tn.searchForm,role:"search",onSubmit:i,children:[r.jsx("label",{htmlFor:"searchbar-input",className:"hidden",children:o("search_bar.search_label")}),r.jsx("input",{className:tn.input,id:"searchbar-input",type:"search",value:s,onChange:e,onKeyDown:c=>c.key==="Escape"&&(n==null?void 0:n()),placeholder:o("search_bar.search_placeholder"),ref:a}),s?r.jsx(Ge,{className:tn.clearButton,"aria-label":o("search_bar.clear_search_label"),onClick:t,children:r.jsx(K,{icon:Ej})}):null]})]})},Hn=({children:s,className:e,...t})=>r.jsx(Ge,{className:M(ut.iconButton,e),...t,children:s}),$j="_searchContainer_1s5uc_1",Rj={searchContainer:$j},Oj=()=>{const{t:s}=T("menu"),e=ue(),t=p.useRef(null),n=G(({config:x})=>x),{features:a,custom:o}=n,{searchPlaylist:i}=a||{},c=fs(o==null?void 0:o.appContentSearch),l=!!i||c,{searchQuery:d,searchActive:h}=Me(({searchQuery:x,searchActive:w,userMenuOpen:v,languageMenuOpen:b})=>({languageMenuOpen:b,searchQuery:x,searchActive:w,userMenuOpen:v}),de),{updateSearchQuery:u,resetSearchQuery:g}=Bl(),_=()=>{g(),Me.setState({searchActive:!1})},f=()=>{Me.setState({searchActive:!0,preSearchPage:`${e.pathname}${e.search||""}`})};return p.useEffect(()=>{h&&t.current&&t.current.focus()},[h]),l?h?r.jsxs("div",{className:Rj.searchContainer,children:[r.jsx(Lj,{query:d,onQueryChange:x=>u(x.target.value),onClearButtonClick:()=>u(""),inputRef:t,onClose:_}),r.jsx(Hn,{"aria-label":s("search_close"),onClick:_,children:r.jsx(K,{icon:Yn})})]}):r.jsx(Hn,{"aria-label":s("search_open"),onClick:f,children:r.jsx(K,{icon:id})}):null},Dj=s=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},p.createElement("path",{fill:"currentColor",d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z"})),Fj="_panel_jhs6c_1",Mj={panel:Fj},cd=({children:s,...e})=>r.jsx("div",{className:Mj.panel,...e,children:s}),Bj=({callback:s,children:e})=>{const t=p.useRef();return p.useEffect(()=>{const n=a=>{var o;!t.current||!(a.target instanceof Node)||t.current!==a.target&&!((o=t.current)!=null&&o.contains(a.target))&&s()};return setTimeout(()=>document.addEventListener("click",n),1),()=>document.removeEventListener("click",n)},[s]),Te.cloneElement(e,{ref:n=>{t.current=n}})},Uj="_popover_1efkk_1",Hj={popover:Uj},ld=({children:s,className:e,isOpen:t,onClose:n})=>r.jsx(ma,{open:t,duration:250,direction:"right",style:{position:"relative"},children:r.jsx(Bj,{callback:n,children:r.jsx("div",{className:M(Hj.popover,e),children:s})})}),Wj="_popover_1oh0j_1",Vj="_menuItems_1oh0j_5",qj="_header_1oh0j_11",zj="_menuItem_1oh0j_5",Gj="_menuItemActive_1oh0j_28",Or={popover:Wj,menuItems:Vj,header:qj,menuItem:zj,menuItemActive:Gj},Kj=({onClick:s,className:e,languages:t,currentLanguage:n,languageMenuOpen:a,closeLanguageMenu:o,openLanguageMenu:i})=>{const{t:c}=T("menu"),l=(h,u)=>{h.preventDefault(),s&&s(u),o()},d=()=>{a?o():i()};return r.jsxs("div",{children:[r.jsx(Hn,{"data-testid":void 0,"aria-controls":"language-panel","aria-expanded":a,"aria-haspopup":"menu",className:e,"aria-label":c("language_menu"),onClick:d,onBlur:o,children:r.jsx(K,{icon:Dj})}),r.jsx(ld,{isOpen:a,onClose:o,children:r.jsx(cd,{id:"language-panel",children:r.jsx("ul",{className:Or.menuItems,children:t.map(({code:h,displayName:u})=>{const g=(n==null?void 0:n.code)===h,_=M(Or.menuItem,{[Or.menuItemActive]:g});return r.jsx("li",{className:_,onClick:f=>l(f,h),children:r.jsx(ln,{onFocus:i,onBlur:o,href:"#","aria-current":g,children:u})},h)})})})})]})},Jj=()=>{const{i18n:s}=T("menu"),e=G(d=>d.supportedLanguages),t=Me(d=>d.languageMenuOpen),n=q(hs),a=q(Rs),o=p.useCallback(()=>Me.setState({languageMenuOpen:!0}),[]),i=p.useCallback(()=>Me.setState({languageMenuOpen:!1}),[]),c=d=>{s.changeLanguage(d),n.restoreFavorites(d),a.restoreWatchHistory(d)},l=p.useMemo(()=>e.find(({code:d})=>d===s.language),[s.language,e]);return e.length<2?null:r.jsx(Kj,{openLanguageMenu:o,closeLanguageMenu:i,languageMenuOpen:t,onClick:c,languages:e,currentLanguage:l})},Yj=({isLoggedIn:s,favoritesEnabled:e,open:t,onClose:n,onOpen:a,onLoginButtonClick:o,onSignUpButtonClick:i})=>{const{t:c}=T("menu");return s?r.jsxs("div",{children:[r.jsx(Hn,{"aria-label":c("open_user_menu"),"aria-controls":"menu_panel","aria-expanded":t,"aria-haspopup":"menu",onClick:a,onBlur:n,children:r.jsx(K,{icon:Pa})}),r.jsx(ld,{className:rn.popover,isOpen:t,onClose:n,children:r.jsx(cd,{id:"menu_panel",children:r.jsx("div",{onFocus:a,onBlur:n,children:r.jsx(ad,{focusable:t,onButtonClick:n,showPaymentItems:!0,favoritesEnabled:e,small:!0})})})})]}):r.jsxs(r.Fragment,{children:[r.jsx(F,{onClick:o,label:c("sign_in"),"aria-haspopup":"dialog"}),r.jsx(F,{variant:"contained",color:"primary",onClick:i,label:c("sign_up"),"aria-haspopup":"dialog"})]})},Qj=()=>{const s=Pe(),e=ae(),t=ue(),n=Me(_=>_.userMenuOpen),{config:{features:a},accessModel:o}=G(_=>({config:_.config,accessModel:_.accessModel})),i=U(({user:_})=>!!_),c=!!(a!=null&&a.favoritesList),l=o!==Fe.AVOD,d=p.useCallback(()=>Me.setState({userMenuOpen:!0}),[]),h=p.useCallback(()=>Me.setState({userMenuOpen:!1}),[]),u=()=>e(J(t,"login")),g=()=>e(J(t,"create-account"));return!l||s<=Z.sm?null:r.jsx(Yj,{open:n,onOpen:d,onClose:h,isLoggedIn:i,favoritesEnabled:c,onLoginButtonClick:u,onSignUpButtonClick:g})},Xj="_layout_1116c_1",Zj="_main_1116c_6",kc={layout:Xj,main:Zj},eC=()=>{const{t:s}=T("common"),e=Xn("label"),{config:t}=G(({config:x,accessModel:w,supportedLanguages:v})=>({config:x,accessModel:w,supportedLanguages:v}),de),{menu:n,assets:a,siteName:o,styling:i}=t,{footerText:c}=i||{},l=c||_u(W.APP_FOOTER_TEXT),{sideBarOpen:d,searchActive:h}=Me(x=>({sideBarOpen:x.sideBarOpen,searchActive:x.searchActive})),u=a.banner,g=()=>Me.setState({sideBarOpen:!0}),_=[{label:s("home"),to:"/"},...n.map(({label:x,contentId:w,type:v,custom:b})=>({label:(b==null?void 0:b[e])||x,to:el({type:v,contentId:w,label:x})}))],f={inert:d?"":void 0};return r.jsxs("div",{className:kc.layout,children:[r.jsx(Pj,{}),r.jsxs("div",{...f,children:[r.jsxs(WS,{searchActive:h,children:[r.jsx(nj,{}),r.jsx(JS,{sideBarOpen:d,onClick:g}),r.jsx(tj,{siteName:o,logoSrc:u,setLogoLoaded:()=>{}}),r.jsx(QS,{navItems:_}),r.jsxs(sj,{children:[r.jsx(Oj,{}),r.jsx(Jj,{}),r.jsx(Qj,{})]})]}),r.jsx("main",{id:"content",className:kc.main,tabIndex:-1,children:r.jsx(Fc,{})}),!!l&&r.jsx(GS,{text:l})]}),r.jsx(Cj,{})]})};function tC(){const s=ae(),e=ue(),t=U(i=>{var c;return typeof((c=i.user)==null?void 0:c.uuid)=="string"?i.user.uuid:void 0}),n=q(ye),{hasNotifications:a}=(n==null?void 0:n.getFeatures())||{},o=he((i,c)=>{s(J(e,i,c))});p.useEffect(()=>{!t||!a||n==null||n.subscribeToNotifications({uuid:t,onMessage:async i=>{var c,l;if(i){const d=JSON.parse(i);switch(d.type){case".failed":case"payment.card.failed":case"subscribe.failed":o("payment-error",(c=d.resource)==null?void 0:c.message);break;case"payment.card.success":await dl.invalidateQueries(["entitlements"]),o(null);break;case"subscribe.success":await n.reloadSubscriptions();break;case"access.revoked":await n.reloadSubscriptions();break;case"payment.card.requires.action":case"subscribe.requires.action":window.location.href=(l=d.resource)==null?void 0:l.redirect_to_url;break}}}})},[n,a,o,t])}const sC=()=>{const{i18n:s}=T(),e=ue(),t=U(n=>({loading:n.loading,user:n.user}),de);return tC(),p.useEffect(()=>{document.documentElement.setAttribute("lang",s.language)},[s.language]),t.user&&!t.loading&&window.location.href.includes("#token")?r.jsx(us,{to:{...e,hash:""},replace:!0}):r.jsx(Fc,{})};function nC(){const{t:s}=T("error");return r.jsx(Rc,{children:r.jsx(ze,{element:r.jsx(sC,{}),children:r.jsxs(ze,{element:r.jsx(eC,{}),errorElement:r.jsx(Q_,{}),children:[r.jsx(ze,{index:!0,element:r.jsx(Fv,{})}),r.jsx(ze,{path:ia,element:r.jsx(Ec,{type:Ft.playlist})}),r.jsx(ze,{path:Gc,element:r.jsx(Ec,{type:Ft.content_list})}),r.jsx(ze,{path:zc,element:r.jsx(Db,{})}),r.jsx(ze,{path:ju,element:r.jsx(fb,{})}),r.jsx(ze,{path:Cu,element:r.jsx(rx,{})}),r.jsx(ze,{path:Eu,element:r.jsx(aw,{})}),r.jsx(ze,{path:Pu,element:r.jsx(sy,{})}),r.jsx(ze,{path:"/*",element:r.jsx(nt,{title:s("notfound_error_heading","Not found"),message:s("notfound_error_description","This page doesn't exist.")})})]})})})}const rC=s=>(typeof s=="string"?s.replace(/\s+/g,"").split(","):[]).map(t=>({type:"playlist",contentId:t})),aC=({data:s})=>{const e=p.useMemo(()=>rC(s.playlists||s.playlist),[s.playlist,s.playlists]);return p.useEffect(()=>{var t;(document.scrollingElement||document.body).scroll({top:0}),(t=document.querySelector("#video-details button"))==null||t.focus()},[s]),r.jsxs("header",{children:[r.jsxs(ql,{image:s.backgroundImage,children:[r.jsx(zl,{title:s.title}),r.jsx(Kl,{description:s.description})]}),r.jsx(Fl,{rows:e})]})};function oC(){Nt.registerByContentType(aC,st.hub)}function iC(s,e){const[t,n]=dn();return p.useLayoutEffect(()=>{s&&(t.has(sn)&&(!e||e===(s==null?void 0:s.defaultConfigSource))&&n(a=>(a.delete(sn),a),{replace:!0}),e&&e!==(s==null?void 0:s.defaultConfigSource)&&t.get(sn)!==e&&n(a=>(a.set(sn,e),a),{replace:!0}))},[e,t,n,s]),e}const cC=oa,lC=({error:s})=>s instanceof qr?r.jsx(nt,{title:s.payload.title,message:s.payload.description,helpLink:s.payload.helpLink,error:s}):r.jsx(nt,{error:s}),dC=({query:s})=>{const{isLoading:e,error:t,data:n}=s;return e?r.jsx(Se,{}):r.jsxs(r.Fragment,{children:[t&&r.jsx(lC,{error:t}),cC,oa]})},uC=({onReady:s})=>{var t,n;const e=q_(window.location.href,s);return iC((t=e.data)==null?void 0:t.settings,(n=e.data)==null?void 0:n.configSource),r.jsx(dC,{query:e})},hC=()=>{const[s,e]=p.useState(!1);p.useEffect(()=>{oC()},[]);const t=p.useCallback(async n=>{n&&(z_(n),e(!0))},[]);return r.jsxs(r.Fragment,{children:[s&&r.jsx(nC,{}),s&&r.jsx(U_,{}),r.jsx(uC,{onReady:t})]})};function mC(){const[s,e]=p.useState({isLoading:!0});return p.useEffect(()=>{wm().then(()=>e({isLoading:!1})).catch(t=>e({isLoading:!1,error:t}))},[]),s.isLoading?r.jsx(Se,{}):s.error?(Ue("App","Failed to load translations",{error:s.error}),r.jsx(ul,{title:"Unable to load translations",message:"Check your language settings and try again later. If the problem persists contact technical support.",error:s.error})):r.jsx(Kh,{children:r.jsx(nu,{children:r.jsx(_m,{children:r.jsx(hC,{})})})})}const pC=()=>{let s=!1;document.addEventListener("keydown",e=>{e.key==="Tab"&&!s&&(s=!0,document.body.classList.add("is-tabbing"))}),document.addEventListener("mousedown",()=>{s&&(s=!1,document.body.classList.remove("is-tabbing"))})};var Dr={APP_API_BASE_URL:"https://cdn.jwplayer.com",APP_PLAYER_ID:"M4qoGvUk",APP_VERSION:"4.30.0",APP_FOOTER_TEXT:"\\u00a9 JW Player | [jwplayer.com](https://www.jwplayer.com/) | v4.30.0",APP_DEFAULT_LANGUAGE:"en",APP_ENABLED_LANGUAGES:"en,es",BASE_URL:"/",MODE:"${MODE:=prod}",DEV:!1,PROD:!0,SSR:!1,APP_BODY_FONT:"",APP_BODY_ALT_FONT:""};iu({APP_VERSION:"4.30.0",APP_API_BASE_URL:"https://cdn.jwplayer.com",APP_PLAYER_ID:"M4qoGvUk",APP_DEFAULT_CONFIG_SOURCE:Dr.APP_DEFAULT_CONFIG_SOURCE,APP_PLAYER_LICENSE_KEY:Dr.APP_PLAYER_LICENSE_KEY,APP_FOOTER_TEXT:"\\u00a9 JW Player | [jwplayer.com](https://www.jwplayer.com/) | v4.30.0",APP_BODY_FONT:"",APP_BODY_ALT_FONT:"",APP_PUBLIC_URL:Dr.APP_PUBLIC_URL||window.location.origin});pC();const Ic=document.getElementById("root");Ic?yd(Ic).render(r.jsx(mC,{})):console.info("Application - rootElement not found");const fC=ou({immediate:!0,onNeedRefresh:()=>fC(!0)});export{Mc as _,YC as a,bC as c,SC as g};
//# sourceMappingURL=index-CxLR9GeF.js.map
